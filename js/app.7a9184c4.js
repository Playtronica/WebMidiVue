(function(){"use strict";var e={4987:function(e,t,a){var n=a(9963),o=a(2201),s=a(6252);const i=(0,s._)("img",{src:"//shop.playtronica.com/cdn/shop/files/622830795_031e8bd9-cf9e-4bb9-8230-6b9565aef17d.png?v=1630593066&width=280",alt:"",srcset:"//shop.playtronica.com/cdn/shop/files/622830795_031e8bd9-cf9e-4bb9-8230-6b9565aef17d.png?v=1630593066&width=140 140w, //shop.playtronica.com/cdn/shop/files/622830795_031e8bd9-cf9e-4bb9-8230-6b9565aef17d.png?v=1630593066&width=280 280w",width:"140",height:"72.5925925925926",loading:"eager",class:"small--hide image-element",sizes:"140px",itemprop:"logo",fetchpriority:""},null,-1),d={class:"d-flex justify-content-center"},c={class:"nav nav-pills"},l={class:"nav-item"},r={class:"nav-item"},m={class:"nav-item"},h=(0,s._)("li",{class:"nav-item"},[(0,s._)("a",{href:"https://playtronica.github.io/WebMidiOrbita/?nomidi=true",class:"nav-link","aria-current":"page"},"Orbita")],-1),u={class:"wrapper"},p={class:"m-2 content"},_={class:"bottom-panel"};function g(e,t,a,n,o,g){const b=(0,s.up)("router-link"),v=(0,s.up)("router-view"),f=(0,s.up)("SocialLinks");return(0,s.wg)(),(0,s.iD)(s.HY,null,[i,(0,s._)("header",d,[(0,s._)("ul",c,[(0,s._)("li",l,[(0,s.Wm)(b,{to:"/biotron",onClick:this.update,class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Biotron")])),_:1},8,["onClick"])]),(0,s._)("li",r,[(0,s.Wm)(b,{to:"/touchme",onClick:this.update,class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("TouchMe")])),_:1},8,["onClick"])]),(0,s._)("li",m,[(0,s.Wm)(b,{to:"/playtron",onClick:this.update,class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Playtron")])),_:1},8,["onClick"])]),h])]),(0,s._)("div",u,[(0,s._)("div",p,[(0,s.Wm)(v)]),(0,s._)("footer",_,[(0,s.Wm)(f)])])],64)}var b=a(3577);const v={class:"social-links"},f=["href","title"],y={class:"sr-only"};function w(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.socialNetworks,(e=>((0,s.wg)(),(0,s.iD)("a",{key:e.name,href:e.url,title:e.name,target:"_blank",rel:"noopener noreferrer",class:"social-link"},[(0,s._)("i",{class:(0,b.C_)(e.iconClass)},null,2),(0,s._)("span",y,(0,b.zw)(e.name),1)],8,f)))),128))])}var C={name:"SocialLinks",data(){return{socialNetworks:[{name:"Facebook",url:"https://www.facebook.com/groups/492176784601023",iconClass:"fab fa-facebook-f"},{name:"Reddit",url:"https://www.reddit.com/r/playtronica/",iconClass:"fab fa-reddit"},{name:"Instagram",url:"https://www.instagram.com/playtronica/",iconClass:"fab fa-instagram"},{name:"YouTube",url:"https://www.youtube.com/channel/UCQbPfbsfg1Qn0rYUodylyZg",iconClass:"fab fa-youtube"},{name:"X",url:"https://x.com/playtronica",iconClass:"fab fa-square-x-twitter"},{name:"TikTok",url:"https://www.tiktok.com/@playtronica",iconClass:"fab fa-tiktok"}]}}},D=a(3744);const x=(0,D.Z)(C,[["render",w],["__scopeId","data-v-1687d1ca"]]);var j=x,I={name:"App",components:{SocialLinks:j},data(){return{url:String,forceRerender:0}},async mounted(){if(console.log("Hello! You`re curious, aren`t you?"),navigator.requestMIDIAccess)try{await navigator.requestMIDIAccess(),console.log("MIDI is supported!")}catch(e){console.error("Could not access MIDI devices:",e),window.alert("You have denied access to MIDI devices.")}else console.error("MIDI is not supported. Sending notification..."),window.alert("Only works on Chrome on desktop computer.")},methods:{update(){this.forceRerender++}}};const S=(0,D.Z)(I,[["render",g]]);var P=S,k=a(8877);const R=(0,s._)("h1",{class:"text-center"},"Scala Loader",-1),M=(0,s._)("h1",{class:"text-center",style:{color:"red"}}," This page is being developed ",-1),O=(0,s._)("h2",null,[(0,s.Uk)("Create your own scala file or choose from list on "),(0,s._)("a",{href:"https://isartum.net/leimma"},"Leimma")],-1),V={class:"row"},E={class:"col-9"},N={class:"col-3"};function B(e,t,a,o,i,d){const c=(0,s.up)("DeviceSelector"),l=(0,s.up)("FileDropArea");return(0,s.wg)(),(0,s.iD)(s.HY,null,[R,M,O,(0,s.Wm)(c,{"regex-name":"",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),(0,s._)("div",V,[(0,s._)("div",E,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.url=e),type:"text",id:"url_input",class:"form-control",placeholder:"Leimma link"},null,512),[[n.nr,this.url]])]),(0,s._)("div",N,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.loadUrl&&this.loadUrl(...e)),class:"btn btn-primary mb-1",style:{width:"70%"}},"Send")])]),(0,s.Wm)(l,{name:"Drop Scala File Here",onGet_drop:t[3]||(t[3]=e=>this.loadFile(e))})],64)}a(7658);const F={class:"form-floating mb-3"},A=["value"],L={for:"device"};function T(e,t,a,o,i,d){return(0,s.wg)(),(0,s.iD)("div",F,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.currentMidiNum=e),class:"form-control",onChange:t[1]||(t[1]=(...e)=>this.deviceChanged&&this.deviceChanged(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.midiOut,((e,t)=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,b.zw)(e.name)+" "+(0,b.zw)(this.versions[t]),9,A)))),128))],544),[[n.bM,i.currentMidiNum]]),(0,s._)("label",L,(0,b.zw)(this.text_label),1)])}var U=a(7327);class W{set_value(e){this.value=e}constructor({name:e=null,number_command:t=0,min_value:a=0,max_value:n=126,step:o=1,sendable:s=!0,custom_fold:i=null}){if((0,U.Z)(this,"flag_device",[20,13]),(0,U.Z)(this,"name",void 0),(0,U.Z)(this,"number_command",void 0),(0,U.Z)(this,"value",void 0),(0,U.Z)(this,"min_value",void 0),(0,U.Z)(this,"max_value",void 0),(0,U.Z)(this,"step",void 0),(0,U.Z)(this,"sendable",void 0),(0,U.Z)(this,"fold_function",void 0),null===t)throw"Number Command is null";this.name=null===e?`Command number ${t}`:e,this.number_command=t,this.value=a,this.min_value=a,this.max_value=n,this.step=o,this.sendable=s,this.fold_function=null===i?(e,t)=>{e.push(t%127)}:i}toString(){return`{"name": "${this.name}", "value": ${this.value}, "params": {\n            "number_command": ${this.number_command},\n            "min_value": ${this.min_value},\n            "max_value": ${this.max_value},\n            "step": ${this.step},\n            "default_value": ${this.default_value}\n        }}`}toShortDict(){return{name:this.name,value:this.value}}check_params(){return!(this.min_value>this.max_value)&&(!(this.value<this.min_value)&&this.value<=this.max_value)}sendToMidi(e,t=this.flag_device){if(!this.sendable)return;let a=[240];this.check_params()&&(a=a.concat(t).concat(this.number_command),this.fold_function(a,this.value),a.push(247),console.log(a),e.send(a))}}function q(e){e&&(e.send([240,11,127,247]),H(100),e.send([240,11,20,13,127,247]))}function H(e){const t=Date.now();let a=null;do{a=Date.now()}while(a-t<e)}var Z={props:{regexName:{default:".*",type:String},checkVersionsFlag:{default:!1,type:Boolean},text_label:{default:"Select device",type:String}},emits:["device_changed"],name:"DeviceSelector",data(){return{midiIn:{},midiOut:{},versions:{},currentMidiNum:0,updateTimeout:null}},methods:{midiReady(e){e.onstatechange=e=>{this.initDevices(e.target)},this.initDevices(e)},initDevices(e){this.midiIn={},this.midiOut={},this.versions={};const t=e.inputs.values();for(let o=t.next();o&&!o.done;o=t.next())o.value.name.match(this.regexName)&&(this.midiIn[o.id]=o.value),o.value.onmidimessage=e=>this.handleMidiMessage(e);let a=0;const n=e.outputs.values();for(let o=n.next();o&&!o.done;o=n.next())o.value.name.match(this.regexName)&&(this.midiOut[a]=o.value,o.value.send([]),H(100),a++);if(this.deviceChanged(),this.checkVersionsFlag)for(const[o,s]of Object.entries(this.midiOut))setTimeout((()=>{s.send([240,20,13,126,o,247]),H(100)}),3e3)},handleMidiMessage(e){const[t,a,n,o,s,i,d,c]=e.data;240===t&&247===c&&11===a&&126===n&&8===e.data.length&&(this.versions[o]=`v${s}.${i}.${d}`)},deviceChanged(){console.log(this.currentMidiNum),this.$emit("device_changed",this.midiOut[this.currentMidiNum])}},mounted(){navigator.requestMIDIAccess({sysex:!0}).then((e=>this.midiReady(e)),(e=>console.log("Something went wrong",e)))}};const z=(0,D.Z)(Z,[["render",T]]);var $=z;function G(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",{class:"fileDropArea",onClick:t[1]||(t[1]=(...e)=>this.dropAreaClick&&this.dropAreaClick(...e)),onDragover:t[2]||(t[2]=e=>e.preventDefault()),onDrop:t[3]||(t[3]=e=>i.dropAreaDrop(e))},[(0,s._)("input",{type:"file",id:"load_preset",style:{display:"none"},onChange:t[0]||(t[0]=e=>i.loadPresetChanged(e))},null,32),(0,s._)("p",null,(0,b.zw)(this.name),1)],32)}var Y={methods:{dropAreaClick(){document.getElementById("load_preset").click()},dropAreaDrop(e){e.preventDefault();let t=e.dataTransfer.files[0],a=new FileReader,n=this;a.onload=function(e){n.$emit("get_drop",e.target.result)},"text/plain"!==t.type&&".scl"!==t.name.substring(t.name.lastIndexOf("."))||a.readAsText(t)},loadPresetChanged(e){let t=e.srcElement.files[0],a=new FileReader,n=this;a.onload=function(e){n.$emit("get_drop",e.target.result)},"text/plain"===t.type&&(a.readAsText(t),document.getElementById("load_preset").value="")}},props:{name:{type:String,default:"Drop preset here"}}};const K=(0,D.Z)(Y,[["render",G],["__scopeId","data-v-b6299ce2"]]);var J=K,Q={components:{FileDropArea:J,DeviceSelector:$},props:{},methods:{loadFile(e){let t=e.split("\n");if(!t[0].includes(".scl"))return;let a=t.lastIndexOf("!"),n=parseInt(t[a-1]),o=t.slice(a+1,a+n+1);this.convertCentsString(o,n)},loadUrl(){if(!this.url.includes("/tuningsystem"))return;let e=this.url.substring(this.url.lastIndexOf("/tuningsystem/")+14),t=e.substring(7,8);if("~"!==t&&"s"!==t)return void console.log("Strange Delimiter");let a=e.split(t);if("s"===t)for(let n=0;n<a.length;n++)a[n]=a[n].substring(4);a=a.slice(1),a.push("2r1"),this.convertCentsString(a,a.length,"r")},convertCentsString(e,t,a="/"){for(let n=0;n<t;n++)if(e[n].includes(a)){let t=e[n].split(a);e[n]=parseInt(1200*Math.log2(parseInt(t[0])/parseInt(t[1])))}else e[n]=parseInt(e[n]);this.sendCents(e)},sendCents(e){if(!this.device)return;let t=[240,11,20,13,1,247];this.device.send(t),console.log(t);let a=[];for(const o of e){a=[240,11,20,13,1];for(let e=0;e<Math.floor(o/127);e++)a.push(127);o%127!==0&&a.push(o%127),a.push(247),this.device.send(a),console.log(a),H(1e3)}let n=[240,11,20,13,127,247];this.device.send(n),console.log(n)}},data(){return{url:"",device:null}}};const X=(0,D.Z)(Q,[["render",B]]);var ee=X;const te=(0,s._)("h1",{class:"text-center"},"Biotron Update Page",-1);function ae(e,t,a,n,o,i){const d=(0,s.up)("DeviceSelector"),c=(0,s.up)("UpdateFirmwareComponent");return(0,s.wg)(),(0,s.iD)(s.HY,null,[te,(0,s.Wm)(d,{style:{display:"none"},"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),(0,s.Wm)(c,{repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])],64)}function ne(e,t){fetch(`https://api.github.com/repos/${e}/releases/latest`,{headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}}).then((e=>e.json())).then((e=>{console.log(e),window.location.replace(e.assets[0]["browser_download_url"])})),q(t)}const oe={class:"modal fade",id:"UpdateConf",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},se={class:"modal-dialog modal-dialog-centered"},ie={class:"modal-content"},de=(0,s.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Update Firmware</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><p> After clicking on &quot;Update&quot;, you will get a file with the .uf2 extension and the device will switch to boot mode. The device will be displayed as removable media (like a USB flash drive). You should transfer the resulting .uf2 file to the removable media that appeared. </p><h6 style="color:red;">ATTENTION</h6><p>The device won&#39;t work until you move the file.</p></div>',2),ce={class:"modal-footer"},le=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function re(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("button",{"data-bs-toggle":"modal","data-bs-target":"#UpdateConf",class:(0,b.C_)(["btn btn-primary",e.$attrs.class])},(0,b.zw)(a.text),3),(0,s._)("div",oe,[(0,s._)("div",se,[(0,s._)("div",ie,[de,(0,s._)("div",ce,[le,(0,s._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=e=>i.LoadFirmware(this.repo,this.device))}," Update")])])])])],64)}var me={methods:{LoadFirmware:ne},props:{repo:{type:String},text:{type:String,default:"Update Firmware"},device:Object}};const he=(0,D.Z)(me,[["render",re]]);var ue=he,pe={components:{UpdateFirmwareComponent:ue,DeviceSelector:$},data(){return{device:null}},methods:{LoadFirmware:ne}};const _e=(0,D.Z)(pe,[["render",ae]]);var ge=_e;const be=(0,s._)("h1",{class:"text-center"},"Scales change settings",-1),ve={class:"row gx-1 mb-5"},fe={class:"col"},ye=["disabled"],we={class:"col"},Ce={class:"col"},De={class:"col"};function xe(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("SelectCommand"),p=(0,s.up)("GroupOfCommands"),_=(0,s.up)("BootstrapCollapse"),g=(0,s.up)("ColorPicker");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),be,(0,s.Wm)(c,{"regex-name":"Scales",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),class:"m-2"}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,class:"m-2"},null,8,["patches","page_id"])),(0,s._)("div",ve,[(0,s._)("div",fe,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"SEND",40,ye)]),(0,s._)("div",we,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"SAVE")]),(0,s._)("div",Ce,[(0,s.Wm)(r,{class:"w-100 h-100",text:"FIRMWARE UPDATE",repo:"Playtronica/scales-firmware",device:this.device,disabled:""},null,8,["device"])]),(0,s._)("div",De,[(0,s.Wm)(m,{name:"UPLOAD",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s._)("div",null,[(0,s.Wm)(_,{name_of_collapse:"Scales settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(p,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{"command-label":"BPM",key:this.forceRerender,"command-object":this.commands_data.bpm,onInputChanged:this.sys_ex_changed,class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üéº Sensitivity",key:this.forceRerender,"list-of-variants":this.sensitivity_modes,"command-object":o.commands_data.sensitivity,onInputChanged:this.sys_ex_changed,class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üéº Scale",key:this.forceRerender,"list-of-variants":this.scales,"command-object":o.commands_data.scale,onInputChanged:this.sys_ex_changed,class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"]))])),_:1})])),_:1}),(0,s.Wm)(_,{name_of_collapse:"Color Settings"},{objects:(0,s.w5)((()=>[(0,s.Wm)(p,{"name-of-group":""},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(g,{"command-label":"Undercover color",key:this.forceRerender,"command-color-object":this.commands_data.color,"command-bright-object":this.commands_data.brightness,"command-color-and-brightness-object":this.commands_data.undercover_color,onInputChanged:this.sys_ex_changed,class:"m-3"},null,8,["command-color-object","command-bright-object","command-color-and-brightness-object","onInputChanged"]))])),_:1})])),_:1})])],64)}var je=a(5702);const Ie={class:"settings_elem"},Se={key:0},Pe={key:1,class:"description_elem"};function ke(e,t,a,n,o,i){const d=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Ie,[a.nameOfGroup?((0,s.wg)(),(0,s.iD)("h2",Se,[(0,s._)("label",null,[(0,s.Uk)((0,b.zw)(this.nameOfGroup)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(d,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),(0,s.WI)(e.$slots,"objects",{},void 0,!0),this.$slots.description?((0,s.wg)(),(0,s.iD)("div",Pe,[(0,s.WI)(e.$slots,"description",{},void 0,!0)])):(0,s.kq)("",!0)])}const Re=["title"];function Me(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",{class:"fas fa-info-circle",style:{color:"#0d6efd"},"data-bs-toggle":"tooltip","data-bs-placement":"right","data-bs-html":"true",title:a.text,disabled:""},null,8,Re)}var Oe={props:{text:{type:String,default:"IS NOT IMPLEMENTED"}},mounted(){new k.u(document.body,{selector:"[data-bs-toggle='tooltip']"})}};const Ve=(0,D.Z)(Oe,[["render",Me]]);var Ee=Ve,Ne={name:"GroupOfCommands",components:{HintComponent:Ee},props:{nameOfGroup:{default:"",type:String},description:{require:!1,type:String}},data(){return{}}};const Be=(0,D.Z)(Ne,[["render",ke],["__scopeId","data-v-3355f7cc"]]);var Fe=Be;const Ae={class:"m-0 w-100"},Le={class:"d-flex"},Te={class:"form-floating flex-grow-1 me-2"},Ue=["value"],We={for:"device"},qe=["data-bs-target"],He={class:"modal fade",id:"saveModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ze={class:"modal-dialog"},ze={class:"modal-content"},$e=(0,s._)("div",{class:"modal-header"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},"Save Patch"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1),Ge={class:"modal-body"},Ye={class:"mb-3"},Ke=(0,s._)("label",{for:"recipient-name",class:"col-form-label"},"Patch Name",-1),Je={class:"modal-footer"},Qe=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1),Xe={class:"modal fade",id:"deleteModel",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},et={class:"modal-dialog"},tt={class:"modal-content"},at=(0,s.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Delete Patch</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancel"></button></div><div class="modal-body"><div class="mb-3"> Do you really want to delete this patch? </div></div>',2),nt={class:"modal-footer"},ot=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1);function st(e,t,a,o,i,d){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",Ae,[(0,s._)("div",Le,[(0,s._)("div",Te,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.id=e),class:"form-control",onChange:t[1]||(t[1]=(...e)=>this.patchChanged&&this.patchChanged(...e))},[(0,s.Uk)("--\x3e "),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.patches,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id},(0,b.zw)(e.name),9,Ue)))),128))],544),[[n.bM,this.id]]),(0,s._)("label",We,(0,b.zw)(this.text_label),1)]),(0,s._)("button",{class:(0,b.C_)(["btn",{"btn-outline-primary":"Save"===this.button_state,"btn-outline-danger":"Delete"===this.button_state}]),type:"button","data-bs-toggle":"modal",onClick:t[2]||(t[2]=(...e)=>this.modelOpen&&this.modelOpen(...e)),"data-bs-target":"Save"===this.button_state?"#saveModal":"#deleteModel",style:(0,b.j5)({display:i.active_button_enabled?"block":"none"})},(0,b.zw)(this.button_state),15,qe)])]),(0,s._)("div",He,[(0,s._)("div",Ze,[(0,s._)("div",ze,[$e,(0,s._)("div",Ge,[(0,s._)("div",Ye,[Ke,(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{type:"text",class:"form-control",id:"patchName","onUpdate:modelValue":t[3]||(t[3]=e=>this.patchName=e),key:this.forceRerender,autocomplete:"off","data-autofocus":""})),[[n.nr,this.patchName]])])]),(0,s._)("div",Je,[Qe,(0,s._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[4]||(t[4]=(...e)=>this.savePatch&&this.savePatch(...e))},"Save")])])])]),(0,s._)("div",Xe,[(0,s._)("div",et,[(0,s._)("div",tt,[at,(0,s._)("div",nt,[ot,(0,s._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...e)=>this.deletePatch&&this.deletePatch(...e))},"Delete")])])])])])}var it={props:{patches:{type:Array},page_id:{type:String,required:!0},text_label:{default:"Presets",type:String}},name:"PatchSelector",data(){return{id:0,active_button_enabled:!0,button_state:"Save",patchName:"",forceRerender:0}},watch:{},methods:{patchChanged(){if(console.log(),localStorage.setItem(this.page_id,this.id),!this.patches)return;let e;for(let t of this.patches)if(this.id===t.id){e=t;break}e&&(this.active_button_enabled=e.editable,this.button_state=e.saved?"Delete":"Save",document.dispatchEvent(new CustomEvent("PatchChanged")))},savePatch(){document.dispatchEvent(new CustomEvent("PatchSave",{detail:this.patchName}))},deletePatch(){document.dispatchEvent(new CustomEvent("PatchDelete"))},modelOpen(){this.patchName=""}},mounted(){if(this.id=parseInt(localStorage.getItem(this.page_id)),!this.patches)return;let e;for(let t of this.patches)if(this.id===t.id){e=t;break}e&&(this.active_button_enabled=e.editable,this.button_state=e.saved?"Delete":"Save",document.addEventListener("shown.bs.modal",(()=>{"Save"===this.button_state&&document.getElementById("patchName").focus()})))}};const dt=(0,D.Z)(it,[["render",st]]);var ct=dt;const lt=e=>((0,s.dD)("data-v-ce1ea73a"),e=e(),(0,s.Cn)(),e),rt={id:"loader_div",style:{position:"fixed","z-index":"10",width:"100%",height:"100%","background-color":"rgba(59,54,54,0.4)",top:"0",left:"0"}},mt={class:"container text-center",style:{transform:"translate(0, 50vh)"}},ht={class:"row justify-content-center"},ut=lt((()=>(0,s._)("h1",{style:{color:"#0d6efd","font-weight":"bold","text-shadow":"0px 0px 6px #fff"}}," Loading ",-1)));function pt(e,t,a,o,i,d){return(0,s.wg)(),(0,s.iD)("div",rt,[(0,s._)("div",mt,[(0,s._)("div",ht,[ut,(0,s.wy)((0,s._)("div",{class:"lds-ring",style:(0,b.j5)({width:`${a.size}px`,height:`${a.size}px`,padding:"0px"})},[(0,s._)("div",{style:(0,b.j5)([i.spinnerStyle,d.animDiv1])},null,4),(0,s._)("div",{style:(0,b.j5)([i.spinnerStyle,d.animDiv2])},null,4),(0,s._)("div",{style:(0,b.j5)([i.spinnerStyle,d.animDiv3])},null,4),(0,s._)("div",{style:(0,b.j5)([i.spinnerStyle])},null,4)],4),[[n.F8,a.loading]])])])])}function _t(e){const t=new RegExp(/^\d*\.?\d+(s|ms)$/);return t.test(e)}function gt(e,t,a){const n={},o=t.match(/^\d*\.?\d+/)[0],s=t.match(/s|(ms)$/)[0],i=Math.round(1e3*o*a)/1e3;return n[e]=i+s,n}var bt={name:"RingLoader",props:{loading:{type:Boolean,default:!0},size:{type:Number,default:55},color:{type:String,default:"#3083fa"},duration:{type:String,default:"1.2s",validator:_t}},data(){return{spinnerStyle:{borderWidth:.1*this.size+"px",borderColor:`${this.color} transparent transparent transparent`,animationDuration:this.duration}}},computed:{animDiv1(){return gt("animationDelay",this.duration,-.375)},animDiv2(){return gt("animationDelay",this.duration,-.25)},animDiv3(){return gt("animationDelay",this.duration,-.125)}}};const vt=(0,D.Z)(bt,[["render",pt],["__scopeId","data-v-ce1ea73a"]]);var ft=vt;const yt=["href","aria-controls"],wt=(0,s._)("hr",null,null,-1),Ct=["id"],Dt=["id"];function xt(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{class:"toggle-label","data-bs-toggle":"collapse",href:"#"+o.collapseId,role:"button","aria-expanded":"false","aria-controls":this.collapseId,ref:"collapse_header"},[(0,s._)("h1",null,[(0,s.Uk)((0,b.zw)(a.name_of_collapse)+" ",1),(0,s._)("span",null,[(0,s._)("i",{class:(0,b.C_)(["fa-solid",{"fa-chevron-up":o.is_open,"fa-chevron-down":!o.is_open}])},null,2)])]),wt],8,yt),a.open_by_default?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"collapse mt-2 show",id:this.collapseId,ref:"collapse_object"},[(0,s.WI)(e.$slots,"objects")],8,Dt)):((0,s.wg)(),(0,s.iD)("div",{key:0,class:"collapse mt-2",id:this.collapseId,ref:"collapse_object"},[(0,s.WI)(e.$slots,"objects")],8,Ct))],64)}var jt={name:"BootstrapCollapse",props:{name_of_collapse:{type:String,required:!0},open_by_default:{type:Boolean,default:!1}},data(){return{is_open:this.open_by_default,collapseId:"collapse-"+Math.random().toString(36).substring(2,10)}},mounted(){this.$refs.collapse_object.addEventListener("show.bs.collapse",(()=>{this.is_open=!0})),this.$refs.collapse_object.addEventListener("hide.bs.collapse",(()=>{this.is_open=!1}))}};const It=(0,D.Z)(jt,[["render",xt]]);var St=It,Pt=a(2262);class kt{constructor(e){(0,U.Z)(this,"DB_NAME","Playtronica_WebMIDI_db"),(0,U.Z)(this,"STORE_NAME","Biotron_Patches"),(0,U.Z)(this,"VERSION",7);const t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB;t||console.log("IndexedDB could not be found in this browser."),this.commands=e}async openDB(){return new Promise((e=>{const t=indexedDB.open(this.DB_NAME,this.VERSION);let a=this;t.onerror=function(t){console.error("An error occurred with IndexedDB"),console.error(t),e(!1)},t.onupgradeneeded=function(){const n=t.result;n.objectStoreNames.contains(a.STORE_NAME)&&n.deleteObjectStore(a.STORE_NAME),n.createObjectStore(a.STORE_NAME,{keyPath:"id",autoIncrement:!0}),e(!0)},t.onsuccess=function(){console.log("Database opened successfully"),t.result.close(),e(!1)}}))}createPatch(e,t){const a=indexedDB.open(this.DB_NAME,this.VERSION);let n=this;a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const o=a.result,s=o.transaction(n.STORE_NAME,"readwrite"),i=s.objectStore(n.STORE_NAME);t?i.put({name:t,editable:!0,saved:!0,data:e}):i.put({name:"Unsaved Patch",editable:!0,saved:!1,data:e}),s.oncomplete=function(){o.close()}}}createNoEditablePatch(e,t){const a=indexedDB.open(this.DB_NAME,this.VERSION);let n=this;a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const o=a.result,s=o.transaction(n.STORE_NAME,"readwrite"),i=s.objectStore(n.STORE_NAME);i.put({name:t,editable:!1,saved:!0,data:e}),s.oncomplete=function(){o.close()}}}async getPatch(e){let t=this;return new Promise((a=>{const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,s=o.transaction(t.STORE_NAME,"readonly"),i=s.objectStore(t.STORE_NAME);let d;d=e?i.get(parseInt(e)):i.getAll(),d.onsuccess=function(){a(d.result)},s.oncomplete=function(){o.close()}}}))}async getUnsavedPatch(){let e=await this.getPatch();return e.at(-1).saved?(this.createPatch((0,Pt.IU)(this.DEFAULT)),e=await this.getPatch(),e.at(-1).id):e.at(-1).id}deletePatch(e){if(!e)return;let t=this;const a=indexedDB.open(this.DB_NAME,this.VERSION);a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const n=a.result,o=n.transaction(t.STORE_NAME,"readwrite"),s=o.objectStore(t.STORE_NAME);let i=s.delete(e);i.onsuccess=function(){console.log("Patch deleted")},o.oncomplete=function(){n.close()}}}updatePatch(e,t){if(!e||!t)return;let a=this;const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,s=o.transaction(a.STORE_NAME,"readwrite"),i=s.objectStore(a.STORE_NAME);let d;d=e?i.get(parseInt(e)):i.getAll(),d.onsuccess=function(){d.result.data=t,i.put(d.result)},s.oncomplete=function(){o.close()}}}savePatch(e,t){if(!e||!t)return;let a=this;const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,s=o.transaction(a.STORE_NAME,"readwrite"),i=s.objectStore(a.STORE_NAME);let d;d=e?i.get(parseInt(e)):i.getAll(),d.onsuccess=function(){d.result.name=t,d.result.saved=!0,i.put(d.result)},s.oncomplete=function(){o.close()}}}}function Rt(e,t){return(e-e%t)/t}let Mt=new Map(Object.entries({bpm:new W({name:"bpm",number_command:0,max_value:1e3,min_value:1,custom_fold:(e,t)=>{while(t>127)e.push(t%127),t=Rt(t,127);e.push(t)}}),sensitivity:new W({name:"sensitivity",number_command:1}),undercover_color:new W({name:"undercover_color",number_command:2,max_value:16777215,min_value:0,custom_fold:(e,t)=>{e.push(parseInt((t>>16&255)/2)),e.push(parseInt((t>>8&255)/2)),e.push(parseInt((255&t)/2))}}),scale:new W({name:"scale",number_command:4}),color:new W({name:"color",sendable:!1,max_value:16777215,min_value:0}),brightness:new W({name:"brightness",sendable:!1,min_value:0,max_value:100})}));const Ot={bpm:120,sensitivity:0,undercover_color:7667967,scale:0,brightness:100};class Vt extends kt{constructor(){super(Mt),(0,U.Z)(this,"DB_NAME","ScaleDB"),(0,U.Z)(this,"STORE_NAME","Scale_Patches"),(0,U.Z)(this,"VERSION",5),this.openDB().then((e=>{e&&this.createNoEditablePatch(Ot,"Default")}))}}const Et={class:"row"},Nt={key:0},Bt=["value"],Ft={key:1},At=["min","max"],Lt=["min","max","step"];function Tt(e,t,a,o,i,d){const c=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Et,[(0,s._)("label",null,[(0,s.Uk)((0,b.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),this.tableValues?((0,s.wg)(),(0,s.iD)("div",Nt,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.rawValue=e),id:"scale",class:"form-control",onChange:t[1]||(t[1]=(...e)=>this.changed&&this.changed(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.tableTranslate,((e,t)=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,b.zw)(this.tableValues[parseInt(e)]),9,Bt)))),128))],544),[[n.bM,this.rawValue]])])):((0,s.wg)(),(0,s.iD)("div",Ft,[(0,s.wy)((0,s._)("input",{type:"number",id:"value_input",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>this.rawValue=e),min:this.minValue,max:this.maxValue,onChange:t[3]||(t[3]=e=>this.changed(e))},null,40,At),[[n.nr,this.rawValue]])])),this.slider_active?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:2,type:"range",id:"range_input",class:"settings_input","onUpdate:modelValue":t[4]||(t[4]=e=>this.rawValue=e),min:this.minValue,max:this.maxValue,step:this.commandObject.step,onChange:t[5]||(t[5]=e=>this.changed(e))},null,40,Lt)),[[n.nr,this.rawValue]]):(0,s.kq)("",!0)])}var Ut={components:{HintComponent:Ee},props:{commandLabel:{default:"",type:String},commandObject:{required:!0,type:W},tableValues:{required:!1,type:Object},tableValuesReversed:{type:Boolean},slider_active:{type:Boolean,default:!0},description:{type:String,required:!1}},emits:["InputChanged"],data(){return{rawValue:-1,maxValue:0,minValue:0,tableTranslate:null}},methods:{checkLimit(){this.rawValue>this.maxValue&&(this.rawValue=this.maxValue),this.rawValue<this.minValue&&(this.rawValue=this.minValue)},changed(e){this.checkLimit(),void 0!==this.tableValues?this.commandObject.set_value(parseInt(this.tableTranslate[parseInt(e.target.value)])):this.commandObject.set_value(parseInt(e.target.value)),this.$emit("InputChanged",this.commandObject)}},created(){if(void 0!==this.tableValues){this.minValue=0;let e=(0,Pt.IU)(this.tableValues);this.maxValue=Object.keys(e).length-1,this.tableTranslate=Object.keys(e),this.tableValuesReversed&&(this.tableTranslate=this.tableTranslate.reverse());for(let t=0;t<this.tableTranslate.length;t++)parseInt(this.tableTranslate[t])===this.commandObject.value&&(this.rawValue=t);-1===this.rawValue&&(this.rawValue=0)}else this.rawValue=this.commandObject.value,this.maxValue=this.commandObject.max_value,this.minValue=this.commandObject.min_value}};const Wt=(0,D.Z)(Ut,[["render",Tt],["__scopeId","data-v-7a801ad6"]]);var qt=Wt;const Ht={class:"row"},Zt=["value"];function zt(e,t,a,o,i,d){const c=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Ht,[(0,s._)("label",null,[(0,s.Uk)((0,b.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.Value=e),id:"scale",class:"form-control",onChange:t[1]||(t[1]=(...e)=>d.changed&&d.changed(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.listOfVariants,((e,t)=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,b.zw)(e),9,Zt)))),128))],544),[[n.bM,this.Value]])])}var $t={components:{HintComponent:Ee},emits:["InputChanged"],props:{commandLabel:{default:"",type:String},listOfVariants:{default:{}},commandObject:{required:!0,type:W},description:{type:String,required:!1}},data(){return{Value:0}},methods:{changed(){this.$emit("InputChanged",this.commandObject)}},watch:{Value(){this.commandObject.set_value(this.Value)}},mounted(){this.Value=this.commandObject.value}};const Gt=(0,D.Z)($t,[["render",zt]]);var Yt=Gt;const Kt=e=>((0,s.dD)("data-v-392c944b"),e=e(),(0,s.Cn)(),e),Jt={class:"d-flex flex-wrap justify-content-around"},Qt=["onClick"],Xt=Kt((()=>(0,s._)("label",null," Brightness ",-1)));function ea(e,t,a,o,i,d){const c=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("label",null,[(0,s.Uk)((0,b.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),(0,s._)("div",Jt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.colors,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{class:"rounded-circle color-square m-2",key:e,style:(0,b.j5)({backgroundColor:t,border:this.selectedColor===t?"2px solid black":""}),onClick:e=>d.selectColor(t)},null,12,Qt)))),128))]),Xt,(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{type:"range",id:"range_input",class:"settings_input","onUpdate:modelValue":t[0]||(t[0]=e=>this.brightness=e),min:0,max:100,step:1,onChange:t[1]||(t[1]=e=>this.changed(e))},null,544),[[n.nr,this.brightness]])])])}var ta={components:{HintComponent:Ee},props:{commandLabel:{default:"",type:String},commandColorObject:{required:!0,type:W},commandBrightObject:{required:!0,type:W},commandColorAndBrightnessObject:{required:!0,type:W},description:{type:String,required:!1}},emits:["InputChanged"],methods:{selectColor(e){this.selectedColor=e,console.log(this.selectedColor),this.changed()},getBrightnessColor(){let e=this.colors[this.selectedColor].substring(1),t=parseInt(e,16),a=t>>16&255,n=t>>8&255,o=t>>0&255,s=Math.round(a*this.brightness/100);s=s<255?s:255;let i=Math.round(n*this.brightness/100);i=i<255?i:255;let d=Math.round(o*this.brightness/100);d=d<255?d:255;let c=(s<<16|i<<8|d).toString(16);while(c.length<6)c="0"+c;return c="#"+c,c},changed(){this.commandColorAndBrightnessObject.set_value(parseInt(this.getBrightnessColor().substring(1),16)),this.commandColorObject.set_value(parseInt(this.selectedColor.substring(1),16)),this.commandBrightObject.set_value(this.brightness),this.$emit("InputChanged",this.commandColorAndBrightnessObject)}},mounted(){this.selectedColor="#"+this.commandColorObject.value.toString(16).toUpperCase().padStart(6,"0"),this.brightness=this.commandBrightObject.value},data(){return{colors:{"#E6E6E6":"#FFE9AD","#FF0000":"#FF0000","#FFA500":"#FF4000","#FFFF00":"#FF6E00","#90FF00":"#90FF00","#00FFFF":"#00FFFF","#0040FF":"#0080FF","#AE00FF":"#AE00FF"},selectedColor:"",brightness:100}}};const aa=(0,D.Z)(ta,[["render",ea],["__scopeId","data-v-392c944b"]]);var na=aa,oa={components:{ColorPicker:na,SelectCommand:Yt,SliderCommand:qt,BootstrapCollapse:St,LoaderComponent:ft,UpdateFirmwareComponent:ue,DeviceSelector:$,PatchSelector:ct,GroupOfCommands:Fe,FileDropArea:J},props:{id:{type:String,required:!0},test:{type:Boolean,default:!1}},computed:{},methods:{async change_data_loader(){this.device&&(H(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData(),H(100),this.sendDataDeprecated()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),H(100);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),H(100));H(100),this.device.send([240,11,20,13,126,247]),H(100),this.commands_data.plantBpm.sendToMidi(this.device)}},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"scales-preset.txt",{type:"text/plain;charset=utf-8"});(0,je.p)(a,"scales-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{page_is_inited:!1,device:null,forceRerender:0,patchRerender:0,db:{type:Vt},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Mt),scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],sensitivity_modes:["250g","500g","1000g","1500g","2000g"]}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Vt,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++,this.page_is_inited=!0},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const sa=(0,D.Z)(oa,[["render",xe]]);var ia=sa;const da=(0,s._)("h1",{class:"text-center"},"Biotron Settings ‚öôÔ∏è",-1),ca={class:"row gx-1 mb-5"},la={class:"col"},ra=["disabled"],ma={class:"col"},ha={class:"col"},ua={class:"col"},pa={class:"row m-2"},_a={class:"row m-2"},ga={class:"col"},ba={key:0},va={key:0},fa={key:1},ya={class:"row m-2"},wa={class:"col"},Ca={class:"col"},Da={class:"row m-2"},xa={class:"col"},ja={class:"col"},Ia={class:"col"},Sa={key:0,class:"row"},Pa={key:0},ka={key:1};function Ra(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SwitchComponent"),u=(0,s.up)("SliderCommand"),p=(0,s.up)("SelectCommand"),_=(0,s.up)("GroupOfCommands"),g=(0,s.up)("BootstrapCollapse"),b=(0,s.up)("SliderRangeCommand");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),da,(0,s.Wm)(c,{"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:"üîå Select Device","check-versions-flag":"",class:"m-2"}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:"üìÇ Preset",class:"m-2"},null,8,["patches","page_id"])),(0,s._)("div",ca,[(0,s._)("div",la,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"‚ùáÔ∏è Send to Device",40,ra)]),(0,s._)("div",ma,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"üíæ Save Preset")]),(0,s._)("div",ha,[(0,s.Wm)(r,{class:"w-100 h-100",text:"üîÑ Update Firmware",repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])]),(0,s._)("div",ua,[(0,s.Wm)(m,{name:"üìÇ Load Preset",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s._)("div",null,[(0,s.Wm)(g,{name_of_collapse:"PLANT SENSOR",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(_,null,{objects:(0,s.w5)((()=>[(0,s._)("div",pa,[(0,s.Wm)(h,{id:"plantVelDis","command-label":"üîá MUTE",description:"Turns off notes coming off plant sensor.","command-object":o.commands_data.plant_no_velocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])]),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üå± The Beat",key:this.forceRerender,"command-object":this.commands_data.plantBpm,description:"Set tempo of plant notes, plant‚Äôs BPM.",onInputChanged:this.sys_ex_changed,class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üéµ Note Hold",key:this.forceRerender,"command-object":this.commands_data.noteOffPercent,"table-values":this.fractions_note_off,description:"How long a note plays before stopping (100 = full length, 50 = half, 0 = very short).",onInputChanged:this.sys_ex_changed,"table-values-reversed":"",class:"m-2"},null,8,["command-object","table-values","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üè†Ô∏é Home Note",key:this.forceRerender,"command-object":this.commands_data.middle_plant_note,"table-values":this.root_note_id,description:"The main note everything starts from and returns to.",onInputChanged:this.sys_ex_changed,class:"m-2"},null,8,["command-object","table-values","onInputChanged"])),((0,s.wg)(),(0,s.j4)(p,{"command-label":"üéº Scale",key:this.forceRerender,"list-of-variants":this.scales,"command-object":o.commands_data.scale,onInputChanged:this.sys_ex_changed,description:"A set of notes that shape the melody and feel of the music. Choose a scale to define the sound of your composition.",class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"]))])),_:1})])),_:1})]),(0,s._)("div",null,[(0,s.Wm)(g,{name_of_collapse:"MORE FUN"},{objects:(0,s.w5)((()=>[(0,s.Wm)(_,{"name-of-group":"Plant Midi Channel"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(u,{"command-label":"üéõÔ∏è MIDI channel",description:"Pick a midi channel that the plant would be on",key:this.forceRerender,"command-object":this.commands_data.plant_midi_channel,onInputChanged:this.sys_ex_changed,class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1}),(0,s.Wm)(_,{"name-of-group":"Buttons Mode"},{objects:(0,s.w5)((()=>[(0,s.Wm)(h,{id:"randomPlantVelSwitch","command-label":"Mute button state",description:"Enables and disables mute button","command-object":this.commands_data.button_mode_state,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])),_:1}),(0,s.Wm)(_,{"name-of-group":"Swing note"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(u,{"command-label":"Swing note",description:"Duration of the first note compare to BPM",key:this.forceRerender,"command-object":this.commands_data.swing_first_note_percent,onInputChanged:this.sys_ex_changed,class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1}),(0,s.Wm)(_,{"name-of-group":"NOTE VELOCITY"},{objects:(0,s.w5)((()=>[(0,s._)("div",_a,[(0,s._)("div",ga,[(0,s.Wm)(h,{id:"randomPlantVelSwitch","command-label":"üßçHumanize",description:"Adds natural variations to note velocity, making the music sound less robotic and more like a real person playing an instrument.","command-object":this.commands_data.randomPlantVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),o.commands_data.plant_no_velocity.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",ba,[this.commands_data.randomPlantVelocity.value?((0,s.wg)(),(0,s.iD)("div",fa,[((0,s.wg)(),(0,s.j4)(b,{key:this.forceRerender,"max-command-object":o.commands_data.maxPlantVelocity,"min-command-object":o.commands_data.minPlantVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üí™ Note velocity",description:"Intensity range of of notes (volume, expression)",class:"m-2"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",va,[((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.maxPlantVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üí™ Note velocity",description:"Intensity range of of notes (volume, expression).",class:"m-2"},null,8,["command-object","onInputChanged"]))]))]))])),_:1}),(0,s.Wm)(_,{"name-of-group":"SENSITIVITY"},{objects:(0,s.w5)((()=>[(0,s._)("div",ya,[(0,s._)("div",wa,[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-label":"üì° Ultra sensitivity","command-object":o.commands_data.randomness,onInputChanged:this.sys_ex_changed,description:"Makes the plant more responsive."},null,8,["command-object","onInputChanged"]))]),(0,s._)("div",Ca,[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-label":"‚úã Manual control","command-object":o.commands_data.performance,onInputChanged:this.sys_ex_changed,description:"Plant only reacts to human interaction, doesn‚Äôt play by itself."},null,8,["command-object","onInputChanged"]))])]),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.same_note_plant,"command-label":"üîÇ Note Repeat",onInputChanged:this.sys_ex_changed,description:"Move near the plant to change notes (1 = small moves change notes, 10 = big moves needed). üé∂",class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üåû Wake-Up",key:this.forceRerender,"command-object":this.commands_data.firstValue,onInputChanged:this.sys_ex_changed,description:"A little change that wakes up the first note.",class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üë£ Step Size",key:this.forceRerender,"command-object":this.commands_data.noteDistance,onInputChanged:this.sys_ex_changed,description:"How big a change is needed to go to the next note.",class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"‚è≥ Delay",key:this.forceRerender,"command-object":this.commands_data.smoothness,onInputChanged:this.sys_ex_changed,description:"How quickly device reacts to change",class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})]),(0,s._)("div",null,[(0,s.Wm)(g,{name_of_collapse:"LIGHT SENSOR"},{objects:(0,s.w5)((()=>[(0,s.Wm)(_,null,{objects:(0,s.w5)((()=>[(0,s._)("div",Da,[(0,s._)("div",xa,[(0,s.Wm)(h,{id:"lightVelDis","command-label":"üîáMute","command-object":o.commands_data.light_no_velocity,onInputChanged:this.sys_ex_changed,description:"Turns off notes coming off light sensor"},null,8,["command-object","onInputChanged"])]),(0,s._)("div",ja,[(0,s.Wm)(h,{id:"randomLightVelSwitch","command-label":"üßçHumanize","command-object":this.commands_data.randomLightVelocity,onInputChanged:this.sys_ex_changed,description:"Adds natural variations to note velocity, making the music sound less robotic and more like a real person playing an instrument."},null,8,["command-object","onInputChanged"])]),(0,s._)("div",Ia,[(0,s.Wm)(h,{id:"light_pitch_mode","command-label":"„Äú Pitch Bend","command-object":this.commands_data.light_pitch_mode,onInputChanged:this.sys_ex_changed,description:"Same as pitch bend wheel on your keyboard ‚Äì makes sound wobbly"},null,8,["command-object","onInputChanged"])])]),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üéõÔ∏è MIDI channel",description:"Pick a midi channel that the light would be on",key:this.forceRerender,"command-object":this.commands_data.light_midi_channel,onInputChanged:this.sys_ex_changed,class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"üåû The Beat",key:this.forceRerender,"command-object":this.commands_data.lightBpm,onInputChanged:this.sys_ex_changed,description:"Set tempo of light sensor notes BPM",class:"m-2"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.same_note_light,"command-label":"üîÇNote Repeat",onInputChanged:this.sys_ex_changed,description:"Change the light to change notes (1 = small moves change notes, 10 = big moves needed). üé∂",class:"m-2"},null,8,["command-object","onInputChanged"])),o.commands_data.light_no_velocity.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Sa,[this.commands_data.randomLightVelocity.value?((0,s.wg)(),(0,s.iD)("div",ka,[((0,s.wg)(),(0,s.j4)(b,{key:this.forceRerender,"max-command-object":o.commands_data.maxLightVelocity,"min-command-object":o.commands_data.minLightVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üî® Note velocity",description:"Intensity range of of notes (volume, expression)",class:"m-2"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",Pa,[((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.maxLightVelocity,onInputChanged:this.sys_ex_changed,name:o.commands_data.maxLightVelocity.value,"command-label":"üî® Note velocity",description:"Intensity range of of notes (volume, expression)",class:"m-2"},null,8,["command-object","onInputChanged","name"]))]))])),this.commands_data.light_pitch_mode.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":this.commands_data.range_light_note,onInputChanged:this.sys_ex_changed,"command-label":"üìè Range",description:"How many notes are played relative to root note",class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})])],64)}let Ma=new Map(Object.entries({plantBpm:new W({name:"plantBpm",number_command:0,max_value:1e3,sendable:!0,custom_fold:(e,t)=>{for(let a=0;a<Math.floor(t/127);a++)e.push(127);e.push(t%127)}}),lightBpm:new W({name:"lightBpm",number_command:9,max_value:30}),noteOffPercent:new W({name:"noteOffPercent",number_command:12,max_value:100}),noteDistance:new W({name:"noteDistance",number_command:1,max_value:100}),firstValue:new W({name:"firstValue",number_command:2,max_value:100}),smoothness:new W({name:"smoothness",number_command:3,max_value:99}),scale:new W({name:"scale",number_command:4}),minPlantVelocity:new W({name:"minPlantVelocity",number_command:15}),maxPlantVelocity:new W({name:"maxPlantVelocity",number_command:5}),minLightVelocity:new W({name:"minLightVelocity",number_command:17}),maxLightVelocity:new W({name:"maxLightVelocity",number_command:6}),randomness:new W({name:"randomness",number_command:10}),same_note_plant:new W({name:"same_note_plant",number_command:11,max_value:10}),same_note_light:new W({name:"same_note_light",number_command:24,max_value:10}),range_light_note:new W({name:"range_light_note",number_command:13,max_value:36}),light_pitch_mode:new W({name:"light_pitch_mode",number_command:19,sendable:!0}),plant_no_velocity:new W({name:"plant_no_velocity",number_command:22}),light_no_velocity:new W({name:"light_no_velocity",number_command:23}),randomPlantVelocity:new W({name:"randomPlantVelocity",number_command:16}),randomLightVelocity:new W({name:"randomLightVelocity",number_command:18}),performance:new W({name:"performance",number_command:21}),middle_plant_note:new W({name:"middle_plant_note",number_command:25,min_value:60,max_value:72}),plant_midi_channel:new W({name:"plant_midi_channel",number_command:[127,0],max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}}),light_midi_channel:new W({name:"light_midi_channel",number_command:[127,1],max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}}),swing_first_note_percent:new W({name:"swing_first_note_percent",number_command:26,max_value:100,min_value:1}),button_mode_state:new W({name:"button_mode_state",number_command:27})}));const Oa={plantBpm:404,lightBpm:8,noteOffPercent:1,noteDistance:50,firstValue:10,smoothness:0,scale:3,minPlantVelocity:0,maxPlantVelocity:97,minLightVelocity:0,maxLightVelocity:68,randomness:!0,same_note_plant:0,same_note_light:0,range_light_note:12,light_pitch_mode:0,plant_no_velocity:0,light_no_velocity:0,randomPlantVelocity:!0,randomLightVelocity:!0,performance:0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2,swing_first_note_percent:100,button_mode_state:!1},Va={plantBpm:404,lightBpm:2,noteOffPercent:2,noteDistance:50,firstValue:10,smoothness:0,scale:6,minPlantVelocity:8,maxPlantVelocity:97,minLightVelocity:0,maxLightVelocity:54,randomness:!1,same_note_plant:1,same_note_light:0,range_light_note:18,light_pitch_mode:!1,plant_no_velocity:0,light_no_velocity:!0,randomPlantVelocity:!0,randomLightVelocity:!0,performance:!0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2,swing_first_note_percent:100,button_mode_state:!1},Ea={plantBpm:404,lightBpm:2,noteOffPercent:1,noteDistance:50,firstValue:10,smoothness:0,scale:5,minPlantVelocity:44,maxPlantVelocity:97,minLightVelocity:0,maxLightVelocity:54,randomness:!1,same_note_plant:0,same_note_light:0,range_light_note:18,light_pitch_mode:!1,plant_no_velocity:0,light_no_velocity:0,randomPlantVelocity:!0,randomLightVelocity:!0,performance:!0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2,swing_first_note_percent:100,button_mode_state:!1},Na={plantBpm:462,lightBpm:4,noteOffPercent:4,noteDistance:50,firstValue:10,smoothness:0,scale:4,minPlantVelocity:8,maxPlantVelocity:98,minLightVelocity:74,maxLightVelocity:75,randomness:0,same_note_plant:1,same_note_light:0,range_light_note:12,light_pitch_mode:0,plant_no_velocity:0,light_no_velocity:!0,randomPlantVelocity:!0,randomLightVelocity:0,performance:!0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2,swing_first_note_percent:100,button_mode_state:!1};class Ba extends kt{constructor(){super(Ma),(0,U.Z)(this,"DB_NAME","BiotronDB"),(0,U.Z)(this,"STORE_NAME","Biotron_Patches"),(0,U.Z)(this,"VERSION",10),this.openDB().then((e=>{e&&(this.createNoEditablePatch(Na,"Mixolyd (Default)"),this.createNoEditablePatch(Oa,"Fast role"),this.createNoEditablePatch(Va,"The Performer mode"),this.createNoEditablePatch(Ea,"In Discussion"))}))}}const Fa=e=>((0,s.dD)("data-v-270abf48"),e=e(),(0,s.Cn)(),e),Aa={class:"flex-row"},La={class:"switch"},Ta=["checked"],Ua=Fa((()=>(0,s._)("span",{class:"slider round"},null,-1)));function Wa(e,t,a,n,o,i){const d=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Aa,[(0,s._)("div",null,[(0,s._)("label",null,[(0,s.Uk)((0,b.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(d,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)])]),(0,s._)("div",null,[(0,s._)("label",La,[(0,s._)("input",{id:"checkbox_input",type:"checkbox",checked:a.commandObject.value,onClick:t[0]||(t[0]=e=>a.commandObject.set_value(e.target.checked)),onChange:t[1]||(t[1]=(...e)=>this.changed&&this.changed(...e))},null,40,Ta),Ua])])])}var qa={name:"SwitchComponent",components:{HintComponent:Ee},props:{commandObject:{type:W},commandLabel:{type:String},description:{type:String,required:!1}},emits:["InputChanged"],methods:{changed(){this.$emit("InputChanged",this.commandObject)}}};const Ha=(0,D.Z)(qa,[["render",Wa],["__scopeId","data-v-270abf48"]]);var Za=Ha;const za={class:"row"},$a={class:"row",style:{"margin-bottom":"10px"}},Ga={class:"col"},Ya=["min","max"],Ka={class:"col"},Ja=["min","max"],Qa={class:"row"};function Xa(e,t,a,o,i,d){const c=(0,s.up)("HintComponent"),l=(0,s.up)("Slider");return(0,s.wg)(),(0,s.iD)("div",za,[(0,s._)("label",null,[(0,s.Uk)((0,b.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),(0,s._)("div",$a,[(0,s._)("div",Ga,[(0,s.wy)((0,s._)("input",{type:"number",id:"value_input_min",class:"form-control",onChange:t[0]||(t[0]=(...e)=>this.changed_min_val&&this.changed_min_val(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>this.values[0]=e),min:this.minCommandObject.min_value,max:this.minCommandObject.max_value},null,40,Ya),[[n.nr,this.values[0]]])]),(0,s.Uk)(" - "),(0,s._)("div",Ka,[(0,s.wy)((0,s._)("input",{type:"number",id:"value_input_max",class:"form-control",onChange:t[2]||(t[2]=(...e)=>this.changed_max_val&&this.changed_max_val(...e)),"onUpdate:modelValue":t[3]||(t[3]=e=>this.values[1]=e),min:this.minCommandObject.min_value,max:this.maxCommandObject.max_value},null,40,Ja),[[n.nr,this.values[1]]])])]),(0,s._)("div",Qa,[(0,s.Wm)(l,{modelValue:i.values,"onUpdate:modelValue":t[4]||(t[4]=e=>i.values=e),class:"slider-blue",tooltips:!1,max:this.maxCommandObject.max_value,min:this.minCommandObject.min_value,step:this.minCommandObject.step,lazy:!1,onChange:this.changed},null,8,["modelValue","max","min","step","onChange"])])])}var en=a(1297),tn={components:{HintComponent:Ee,Slider:en.Z},emits:["input-changed"],props:{commandLabel:{default:"",type:String},minCommandObject:{required:!0,type:W},maxCommandObject:{required:!0,type:W},description:{type:String,required:!1}},data(){return{minValue:0,maxValue:0,values:[0,0]}},methods:{changed_min_val(){this.minCommandObject.set_value(this.values[0]),this.$emit("input-changed",this.minCommandObject)},changed_max_val(){this.maxCommandObject.set_value(this.values[1]),this.$emit("input-changed",this.maxCommandObject)},changed(){this.minCommandObject.value!==this.values[0]&&this.changed_min_val(),this.maxCommandObject.value!==this.values[1]&&this.changed_max_val()}},created(){this.minValue=this.minCommandObject.value,this.maxValue=this.maxCommandObject.value,this.values=[this.minCommandObject.value,this.maxCommandObject.value],this.minValue>this.maxValue&&(this.minValue=this.maxValue)}};const an=(0,D.Z)(tn,[["render",Xa],["__scopeId","data-v-4269375d"]]);var nn=an,on={components:{BootstrapCollapse:St,LoaderComponent:ft,UpdateFirmwareComponent:ue,DeviceSelector:$,PatchSelector:ct,SelectCommand:Yt,SliderRangeCommand:nn,SliderCommand:qt,SwitchComponent:Za,GroupOfCommands:Fe,FileDropArea:J},props:{id:{type:String,required:!0},test:{type:Boolean,default:!1}},computed:{},methods:{async change_data_loader(){this.device&&(H(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData(),H(100),this.sendDataDeprecated()}.bind(this),10))},async sendDataDeprecated(){if(this.device){this.device.send([240,11,16,127,247]);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device,[11]),H(100));this.device.send([240,11,126,247]),H(100),this.commands_data.plantBpm.sendToMidi(this.device,[11])}},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),H(100);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),H(100));H(100),this.device.send([240,11,20,13,126,247]),H(100),this.commands_data.plantBpm.sendToMidi(this.device)}},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"biotron-preset.txt",{type:"text/plain;charset=utf-8"});(0,je.p)(a,"biotron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{page_is_inited:!1,scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished","Hiraj≈çshi"],root_note_id:{60:"C4",61:"C#4",62:"D4",63:"D#4",64:"E4",65:"F4",66:"F#4",67:"G4",68:"G#4",69:"A4",70:"A#4",71:"B4",72:"C5"},fractions_note_off:{64:"1/64",48:"1/48",32:"1/32",24:"1/24",16:"1/16",12:"1/12",8:"1/8",6:"1/6",4:"1/4",2:"1/2",1:"1"},device:null,forceRerender:0,patchRerender:0,db:{type:Ba},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Ma)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Ba,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++,this.page_is_inited=!0},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const sn=(0,D.Z)(on,[["render",Ra]]);var dn=sn;const cn=e=>((0,s.dD)("data-v-d7da8c76"),e=e(),(0,s.Cn)(),e),ln=cn((()=>(0,s._)("h1",{class:"text-center"},"TouchMe Settings ‚öôÔ∏è",-1))),rn={class:"row gx-1 mb-5"},mn={class:"col"},hn=["disabled"],un={class:"col"},pn={class:"col"},_n={class:"col"},gn={class:"row m-2"},bn={class:"col"},vn={class:"col"},fn={class:"col"},yn={key:0},wn={key:0},Cn={key:1},Dn={key:1};function xn(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SwitchComponent"),u=(0,s.up)("SelectCommand"),p=(0,s.up)("SliderCommand"),_=(0,s.up)("SliderRangeCommand"),g=(0,s.up)("GroupOfCommands"),b=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),ln,(0,s.Wm)(c,{"regex-name":"TouchMe",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:"üîå Select Device","check-versions-flag":"",class:"m-2"}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:"üìÇ Preset",class:"m-2"},null,8,["patches","page_id"])),(0,s._)("div",rn,[(0,s._)("div",mn,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"‚ùáÔ∏è Send to Device",40,hn)]),(0,s._)("div",un,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"üíæ Save Preset")]),(0,s._)("div",pn,[(0,s.Wm)(r,{class:"w-100 h-100",text:"üîÑ Update Firmware",repo:"Playtronica/touchme-releases",device:this.device},null,8,["device"])]),(0,s._)("div",_n,[(0,s.Wm)(m,{name:"üìÇ Load Preset",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(b,{name_of_collapse:"TouchMe settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[(0,s._)("div",gn,[(0,s._)("div",bn,[(0,s.Wm)(h,{id:"humanizeSwitch","command-label":"üßçHumanize","command-object":this.commands_data.humanize,"onUpdate:modelValue":t[4]||(t[4]=e=>{this.isHumanize=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed,description:"Adds natural variations to note velocity, making the music sound less robotic and more like a real person playing an instrument."},null,8,["command-object","onInputChanged"])]),(0,s._)("div",vn,[(0,s.Wm)(h,{id:"velocityDisableSwitch","command-label":"üîá Mute","command-object":this.commands_data.mute,"onUpdate:modelValue":t[5]||(t[5]=e=>{this.isMute=e}),onInputChanged:this.sys_ex_changed,description:"Disable note generation from the channel"},null,8,["command-object","onInputChanged"])]),(0,s._)("div",fn,[(0,s.Wm)(h,{id:"notesRangeSwitch","command-label":"üé∂ Custom Range","command-object":this.commands_data.customRange,"onUpdate:modelValue":t[6]||(t[6]=e=>{this.customRange=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed,description:"Adds note range customization."},null,8,["command-object","onInputChanged"])])]),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":this.commands_data.PlayMode,onInputChanged:this.sys_ex_changed,"command-label":"üéº Scale",description:"A set of notes that shape the melody and feel of the music. Choose a scale to define the sound of your composition.",class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(p,{"command-label":"üéπ Root Note",key:this.forceRerender,"command-object":this.commands_data.Key,"table-values":this.dig_to_nums,onInputChanged:this.sys_ex_changed,description:"This is your starting note‚Äîlike picking the key on a piano. All other notes follow from here based on the scale you chose.",class:"m-2"},null,8,["command-object","table-values","onInputChanged"])),this.commands_data.mute.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",yn,[this.commands_data.humanize.value?((0,s.wg)(),(0,s.iD)("div",Cn,[((0,s.wg)(),(0,s.j4)(_,{key:this.forceRerender,"max-command-object":this.commands_data.maxVelocity,"min-command-object":this.commands_data.minVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üí™ Note velocity",description:"Intensity range of of notes (volume, expression).",class:"m-2"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",wn,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"command-object":this.commands_data.maxVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üí™ Note velocity",description:"Intensity range of of notes (volume, expression).",class:"m-2"},null,8,["command-object","onInputChanged"]))]))])),this.commands_data.customRange.value?((0,s.wg)(),(0,s.iD)("div",Dn,[((0,s.wg)(),(0,s.j4)(_,{key:this.forceRerender,"max-command-object":this.commands_data.highestNote,"min-command-object":this.commands_data.lowestNote,onInputChanged:this.sys_ex_changed,"command-label":"üé∂ Notes Range",description:"Adjust your note range.",class:"m-2"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):(0,s.kq)("",!0),((0,s.wg)(),(0,s.j4)(p,{"command-label":"üéõÔ∏è MIDI channel",key:this.forceRerender,"command-object":this.commands_data.channel,onInputChanged:this.sys_ex_changed,description:"Pick a midi channel that the plant would be on",class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1}),(0,s.Wm)(b,{name_of_collapse:"Extra"},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"command-object":this.commands_data.sens_mode,onInputChanged:this.sys_ex_changed,"command-label":"Sensitivity of device",class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})],64)}let jn=new Map(Object.entries({PlayMode:new W({name:"PlayMode",number_command:0}),Key:new W({name:"Key",number_command:1,min_value:1,max_value:12}),maxVelocity:new W({name:"maxVelocity",number_command:2,max_value:127}),minVelocity:new W({name:"minVelocity",number_command:3,max_value:127}),highestNote:new W({name:"highestNote",number_command:8,max_value:127}),lowestNote:new W({name:"lowestNote",number_command:7,max_value:127}),customRange:new W({name:"customRange",number_command:6}),humanize:new W({name:"humanize",number_command:4}),mute:new W({name:"mute",number_command:5,default_value:0,value:0}),channel:new W({name:"channel",number_command:127,max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}}),sens_mode:new W({name:"sens_mode",number_command:9,min_value:-10,max_value:10,custom_fold:(e,t)=>{e.push(t+10)}}),play_mode_page:new W({name:"play_mode_page",number_command:10})}));const In={PlayMode:0,play_mode_page:0,Key:8,maxVelocity:70,minVelocity:50,highestNote:84,lowestNote:48,customRange:0,humanize:0,mute:0,channel:1,sens_mode:0};class Sn extends kt{constructor(){super(jn),(0,U.Z)(this,"DB_NAME","TouchMeDB"),(0,U.Z)(this,"STORE_NAME","TouchMe_Patches"),(0,U.Z)(this,"VERSION",7),this.openDB().then((e=>{e&&this.createNoEditablePatch(In,"Default")}))}}var Pn={name:"TouchMePageRelease",components:{BootstrapCollapse:St,LoaderComponent:ft,UpdateFirmwareComponent:ue,PatchSelector:ct,SliderRangeCommand:nn,SwitchComponent:Za,FileDropArea:J,SliderCommand:qt,DeviceSelector:$,GroupOfCommands:Fe,SelectCommand:Yt},props:{id:{type:String,required:!0}},methods:{change_data_loader(){this.device&&(H(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),2e3),setTimeout(function(){this.device.send([240,11,20,13,0,247]),this.sendData(),this.device.send([240,11,20,13,1,247])}.bind(this),10))},async sendData(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device),H(100);await this.saveData()},async saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))console.log(t),console.log(this.commands_data),console.log(this.commands_data[t]),this.commands_data[t].set_value(a);this.forceRerender++},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"touchme-preset.txt",{type:"text/plain;charset=utf-8"});(0,je.p)(a,"touchme-preset.txt")},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],dig_to_nums:{1:"C3",2:"C#3",3:"D3",4:"D#3",5:"E3",6:"F3",7:"F#3",8:"G3",9:"G#3",10:"A3",11:"A#3",12:"B3"},device:null,forceRerender:0,patchRerender:0,isHumanize:!1,isMute:!1,customRange:!1,db:{type:Sn},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(jn)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Sn,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},async mounted(){document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const kn=(0,D.Z)(Pn,[["render",xn],["__scopeId","data-v-d7da8c76"]]);var Rn=kn;const Mn=e=>((0,s.dD)("data-v-0e161cec"),e=e(),(0,s.Cn)(),e),On=Mn((()=>(0,s._)("h1",{class:"text-center"},"Playtron Settings ‚öôÔ∏è",-1))),Vn={class:"row gx-1 mb-5"},En={class:"col"},Nn=["disabled"],Bn={class:"col"},Fn={class:"col"},An={class:"col"};function Ln(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("GroupOfCommands"),p=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),On,(0,s.Wm)(c,{"regex-name":"Playtron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:"üîå Select Device","check-versions-flag":"",class:"m-2"}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:"üìÇ Preset",class:"m-2"},null,8,["patches","page_id"])),(0,s._)("div",Vn,[(0,s._)("div",En,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"‚ùáÔ∏è Send to Device",40,Nn)]),(0,s._)("div",Bn,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"üíæ Save Preset")]),(0,s._)("div",Fn,[(0,s.Wm)(r,{class:"w-100 h-100",text:"üîÑ Update Firmware",repo:"Playtronica/playtron-releases",device:this.device},null,8,["device"])]),(0,s._)("div",An,[(0,s.Wm)(m,{name:"üìÇ Load Preset",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(p,{name_of_collapse:"üéπ Playtron Settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(u,{"name-of-group":"üéµ Notes for Pad",class:"row justify-content-center m-1",description:"Click any box in the grid to assign a new MIDI note to that pad. Mix and match high and low notes to build your perfect layout!"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)("div",{class:"grid-container",key:this.forceRerender},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.num_to_pad,((e,t)=>((0,s.wg)(),(0,s.j4)(h,{"command-label":e,key:t,"command-object":this.find_sys_ex("Note",this.num_to_pad[t]),slider_active:!1,onInputChanged:this.sys_ex_changed},null,8,["command-label","command-object","onInputChanged"])))),128))]))])),_:1}),(0,s.Wm)(u,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-object":this.commands_data.channel,"command-label":"üéõÔ∏è MIDI channel",description:"Pick a midi channel that the plant would be on",class:"m-2",onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})],64)}const Tn=[{id:0,name:"C3",note:60},{id:1,name:"C#3",note:61},{id:2,name:"D3",note:62},{id:3,name:"D#3",note:63},{id:4,name:"E3",note:64},{id:5,name:"F3",note:65},{id:6,name:"F#3",note:66},{id:7,name:"G3",note:67},{id:8,name:"G#3",note:68},{id:9,name:"A3",note:69},{id:10,name:"A#3",note:70},{id:11,name:"B3",note:71},{id:12,name:"C4",note:72},{id:13,name:"C#4",note:73},{id:14,name:"D4",note:74},{id:15,name:"D#4",note:75}];let Un=new Map([...Object.entries({channel:new W({name:"channel",number_command:127,max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}}),chord_mode:new W({name:"chord_mode",number_command:1})}),...new Map(Tn.map((e=>[`Note_${e.name}`,new W({name:`Note_${e.name}`,number_command:[0,e.id]})])))]);const Wn={...Object.fromEntries(Tn.map((e=>[`Note_${e.name}`,e.note]))),channel:1,chord_mode:0};class qn extends kt{constructor(){super(Un),(0,U.Z)(this,"DB_NAME","PlaytronDB"),(0,U.Z)(this,"STORE_NAME","Playtron_Patches"),(0,U.Z)(this,"VERSION",6),this.openDB().then((e=>{e&&this.createNoEditablePatch(Wn,"Default")}))}}var Hn={components:{BootstrapCollapse:St,UpdateFirmwareComponent:ue,FileDropArea:J,SliderCommand:qt,GroupOfCommands:Fe,LoaderComponent:ft,PatchSelector:ct,DeviceSelector:$},computed:{},props:{id:{type:String,required:!0}},data(){return{device:null,patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Un),forceRerender:0,patchRerender:0,num_to_pad:{36:"C3",37:"C#3",38:"D3",39:"D#3",40:"E3",41:"F3",42:"F#3",43:"G3",44:"G#3",45:"A3",46:"A#3",47:"B3",48:"C4",49:"C#4",50:"D4",51:"D#4"},chosen_pad:36}},methods:{find_sys_ex(e,t){return this.commands_data[`${e}_${t}`]},async change_data_loader(){this.device&&(H(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),H(100);let e=[];for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),H(100));H(100),this.device.send([240,11,20,13,126,247])}},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"playtron-preset.txt",{type:"text/plain;charset=utf-8"});(0,je.p)(a,"playtron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new qn,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const Zn=(0,D.Z)(Hn,[["render",Ln],["__scopeId","data-v-0e161cec"]]);var zn=Zn;function $n(e,t){return(0,s.wg)(),(0,s.iD)("h1",null," Select Device First By Links Above ")}const Gn={},Yn=(0,D.Z)(Gn,[["render",$n]]);var Kn=Yn;const Jn=e=>((0,s.dD)("data-v-3b5fbef2"),e=e(),(0,s.Cn)(),e),Qn=Jn((()=>(0,s._)("h1",{class:"text-center"},"Playtron Settings ‚öôÔ∏è",-1))),Xn={class:"row gx-1 mb-5"},eo={class:"col"},to=["disabled"],ao={class:"col"},no={class:"col"},oo={class:"col"};function so(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("GroupOfCommands"),p=(0,s.up)("SelectCommand"),_=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),Qn,(0,s.Wm)(c,{"regex-name":"Playtron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:"üîå Select Device","check-versions-flag":"",class:"m-2"}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:"üìÇ Preset",class:"m-2"},null,8,["patches","page_id"])),(0,s._)("div",Xn,[(0,s._)("div",eo,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"‚ùáÔ∏è Send to Device",40,to)]),(0,s._)("div",ao,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"üíæ Save Preset")]),(0,s._)("div",no,[(0,s.Wm)(r,{class:"w-100 h-100",text:"üîÑ Update Firmware",repo:"Playtronica/playtron-releases",device:this.device},null,8,["device"])]),(0,s._)("div",oo,[(0,s.Wm)(m,{name:"üìÇ Load Preset",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(_,{name_of_collapse:"üéπ Playtron Settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(u,{"name-of-group":"üéµ Notes for Pad",class:"row justify-content-center m-1",description:"Click any box in the grid to assign a new MIDI note to that pad. Mix and match high and low notes to build your perfect layout!"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)("div",{class:"grid-container",key:this.forceRerender},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.num_to_pad,((e,t)=>((0,s.wg)(),(0,s.j4)(h,{"command-label":e,key:t,"command-object":this.find_sys_ex("Note",this.num_to_pad[t]),slider_active:!1,onInputChanged:this.sys_ex_changed},null,8,["command-label","command-object","onInputChanged"])))),128))]))])),_:1}),(0,s.Wm)(u,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-object":this.commands_data.channel,"command-label":"üéõÔ∏è MIDI channel",description:"Pick a midi channel that the plant would be on",class:"m-2",onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),_:1}),(0,s.Wm)(u,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(p,{"command-label":"üéº Chords Mode",key:this.forceRerender,"list-of-variants":this.chords_modes,"command-object":o.commands_data.chord_mode,onInputChanged:this.sys_ex_changed,class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"]))])),_:1})])),_:1})],64)}var io={components:{SelectCommand:Yt,BootstrapCollapse:St,UpdateFirmwareComponent:ue,FileDropArea:J,SliderCommand:qt,GroupOfCommands:Fe,LoaderComponent:ft,PatchSelector:ct,DeviceSelector:$},computed:{},props:{id:{type:String,required:!0}},data(){return{device:null,patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Un),forceRerender:0,patchRerender:0,num_to_pad:{36:"C3",37:"C#3",38:"D3",39:"D#3",40:"E3",41:"F3",42:"F#3",43:"G3",44:"G#3",45:"A3",46:"A#3",47:"B3",48:"C4",49:"C#4",50:"D4",51:"D#4"},chords_modes:["None","Major","Minor","Seventh","Cmaj","Cmin"],chosen_pad:36}},methods:{find_sys_ex(e,t){return this.commands_data[`${e}_${t}`]},async change_data_loader(){this.device&&(H(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),H(100);let e=[];for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),H(100));H(100),this.device.send([240,11,20,13,126,247])}},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"playtron-preset.txt",{type:"text/plain;charset=utf-8"});(0,je.p)(a,"playtron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new qn,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const co=(0,D.Z)(io,[["render",so],["__scopeId","data-v-3b5fbef2"]]);var lo=co;const ro=e=>((0,s.dD)("data-v-0724bc72"),e=e(),(0,s.Cn)(),e),mo=ro((()=>(0,s._)("h1",{class:"text-center"},"TouchMe Settings ‚öôÔ∏è",-1))),ho={class:"row gx-1 mb-5"},uo={class:"col"},po=["disabled"],_o={class:"col"},go={class:"col"},bo={class:"col"},vo={class:"row m-2"},fo={class:"col"},yo={class:"col"},wo={class:"col"},Co={key:0},Do={key:0},xo={key:1},jo={key:1};function Io(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SwitchComponent"),u=(0,s.up)("SelectCommand"),p=(0,s.up)("SliderCommand"),_=(0,s.up)("SliderRangeCommand"),g=(0,s.up)("GroupOfCommands"),b=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),mo,(0,s.Wm)(c,{"regex-name":"TouchMe",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:"üîå Select Device","check-versions-flag":"",class:"m-2"}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:"üìÇ Preset",class:"m-2"},null,8,["patches","page_id"])),(0,s._)("div",ho,[(0,s._)("div",uo,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"‚ùáÔ∏è Send to Device",40,po)]),(0,s._)("div",_o,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"üíæ Save Preset")]),(0,s._)("div",go,[(0,s.Wm)(r,{class:"w-100 h-100",text:"üîÑ Update Firmware",repo:"Playtronica/touchme-releases",device:this.device},null,8,["device"])]),(0,s._)("div",bo,[(0,s.Wm)(m,{name:"üìÇ Load Preset",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(b,{name_of_collapse:"TouchMe settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[(0,s._)("div",vo,[(0,s._)("div",fo,[(0,s.Wm)(h,{id:"humanizeSwitch","command-label":"üßçHumanize","command-object":this.commands_data.humanize,"onUpdate:modelValue":t[4]||(t[4]=e=>{this.isHumanize=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed,description:"Adds natural variations to note velocity, making the music sound less robotic and more like a real person playing an instrument."},null,8,["command-object","onInputChanged"])]),(0,s._)("div",yo,[(0,s.Wm)(h,{id:"velocityDisableSwitch","command-label":"üîá Mute","command-object":this.commands_data.mute,"onUpdate:modelValue":t[5]||(t[5]=e=>{this.isMute=e}),onInputChanged:this.sys_ex_changed,description:"Disable note generation from the channel"},null,8,["command-object","onInputChanged"])]),(0,s._)("div",wo,[(0,s.Wm)(h,{id:"notesRangeSwitch","command-label":"üé∂ Custom Range","command-object":this.commands_data.customRange,"onUpdate:modelValue":t[6]||(t[6]=e=>{this.customRange=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed,description:"Adds note range customization."},null,8,["command-object","onInputChanged"])])]),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"list-of-variants":this.play_mode_pages,"command-object":this.commands_data.play_mode_page,onInputChanged:this.play_mode_page_changed,"command-label":"üéº Modes Page",class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"list-of-variants":this.modes_on_page,slider_active:!1,"command-object":this.commands_data.PlayMode,onInputChanged:this.sys_ex_changed,"command-label":"üéº Mode",description:"A set of notes that shape the melody and feel of the music. Choose a scale to define the sound of your composition.",class:"m-3"},null,8,["list-of-variants","command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(p,{"command-label":"üéπ Root Note",key:this.forceRerender,"command-object":this.commands_data.Key,"table-values":this.dig_to_nums,onInputChanged:this.sys_ex_changed,description:"This is your starting note‚Äîlike picking the key on a piano. All other notes follow from here based on the scale you chose.",class:"m-2"},null,8,["command-object","table-values","onInputChanged"])),this.commands_data.mute.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Co,[this.commands_data.humanize.value?((0,s.wg)(),(0,s.iD)("div",xo,[((0,s.wg)(),(0,s.j4)(_,{key:this.forceRerender,"max-command-object":this.commands_data.maxVelocity,"min-command-object":this.commands_data.minVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üí™ Note velocity",description:"Intensity range of of notes (volume, expression).",class:"m-2"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",Do,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"command-object":this.commands_data.maxVelocity,onInputChanged:this.sys_ex_changed,"command-label":"üí™ Note velocity",description:"Intensity range of of notes (volume, expression).",class:"m-2"},null,8,["command-object","onInputChanged"]))]))])),this.commands_data.customRange.value?((0,s.wg)(),(0,s.iD)("div",jo,[((0,s.wg)(),(0,s.j4)(_,{key:this.forceRerender,"max-command-object":this.commands_data.highestNote,"min-command-object":this.commands_data.lowestNote,onInputChanged:this.sys_ex_changed,"command-label":"üé∂ Notes Range",description:"Adjust your note range.",class:"m-2"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):(0,s.kq)("",!0),((0,s.wg)(),(0,s.j4)(p,{"command-label":"üéõÔ∏è MIDI channel",key:this.forceRerender,"command-object":this.commands_data.channel,onInputChanged:this.sys_ex_changed,description:"Pick a midi channel that the plant would be on",class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1}),(0,s.Wm)(b,{name_of_collapse:"Extra"},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"command-object":this.commands_data.sens_mode,onInputChanged:this.sys_ex_changed,"command-label":"Sensitivity of device",class:"m-2"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})],64)}var So={name:"TouchMePageTest",components:{BootstrapCollapse:St,LoaderComponent:ft,UpdateFirmwareComponent:ue,PatchSelector:ct,SliderRangeCommand:nn,SwitchComponent:Za,FileDropArea:J,SliderCommand:qt,DeviceSelector:$,GroupOfCommands:Fe,SelectCommand:Yt},props:{id:{type:String,required:!0}},methods:{change_data_loader(){this.device&&(H(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),2e3),setTimeout(function(){this.device.send([240,11,20,13,0,247]),this.sendData(),this.device.send([240,11,20,13,1,247])}.bind(this),10))},async sendData(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device),H(100);await this.saveData()},async saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"touchme-preset.txt",{type:"text/plain;charset=utf-8"});(0,je.p)(a,"touchme-preset.txt")},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++},async play_mode_page_changed(e){const t=Math.min(...Object.keys(this.modes_on_page).map(Number));console.log(t),this.commands_data.PlayMode.value=t,await this.sys_ex_changed(e)}},computed:{modes_on_page(){const e=12*this.commands_data.play_mode_page.value,t=12*(this.commands_data.play_mode_page.value+1)-1;return Object.fromEntries(Object.entries(this.play_modes).filter((a=>parseInt(a)>=e&&parseInt(a)<=t)))}},data(){return{play_modes:{0:"Major",1:"Minor",2:"Chrom",3:"Dorian",4:"Mixolydian",5:"Lydian",6:"Wholetone",7:"Minblues",8:"Majblues",9:"Minpen",10:"Majpen",11:"Diminished",12:"Major Chord",13:"Minor Chord",14:"Seventh Chord"},play_mode_pages:["1 Page (Scales)","2 Page (Chords)"],dig_to_nums:{1:"C3",2:"C#3",3:"D3",4:"D#3",5:"E3",6:"F3",7:"F#3",8:"G3",9:"G#3",10:"A3",11:"A#3",12:"B3"},device:null,forceRerender:0,patchRerender:0,isHumanize:!1,isMute:!1,customRange:!1,db:{type:Sn},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(jn)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Sn,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},async mounted(){document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const Po=(0,D.Z)(So,[["render",Io],["__scopeId","data-v-0724bc72"]]);var ko=Po;const Ro=[{path:"/",component:Kn},{path:"/biotron",component:dn,props:{id:"BiotronWebMidiId_2"}},{path:"/touchme",component:Rn,props:{id:"TouchmeWebMidiId_2"}},{path:"/touchme/test",component:ko,props:{id:"TouchmeWebMidiId_2"}},{path:"/playtron",component:zn,props:{id:"PlaytronWebMidiId"}},{path:"/playtron/test",component:lo,props:{id:"PlaytronWebMidiId"}},{path:"/biotron/update",component:ge},{path:"/scales",component:ia,props:{id:"ScalesWebMidiId_1"}},{path:"/scala",component:ee}],Mo=(0,o.p7)({history:(0,o.r5)(),linkActiveClass:"active",routes:Ro});var Oo=a(7846);(0,n.ri)(P).use(Mo).use(Oo).mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,s){if(!n){var i=1/0;for(r=0;r<e.length;r++){n=e[r][0],o=e[r][1],s=e[r][2];for(var d=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(d=!1,s<i&&(i=s));if(d){e.splice(r--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var r=e.length;r>0&&e[r-1][2]>s;r--)e[r]=e[r-1];e[r]=[n,o,s]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,i=n[0],d=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(o in d)a.o(d,o)&&(a.m[o]=d[o]);if(c)var r=c(a)}for(t&&t(n);l<i.length;l++)s=i[l],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(r)},n=self["webpackChunkweb_midi_playtronica"]=self["webpackChunkweb_midi_playtronica"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(4987)}));n=a.O(n)})();
//# sourceMappingURL=app.7a9184c4.js.map