(function(){"use strict";var e={9273:function(e,t,a){var n=a(9963),o=a(2201),i=a(6252);const s={class:"d-flex justify-content-center"},l={class:"nav nav-pills"},d={class:"nav-item"},c={class:"nav-item"},r={class:"m-2"};function m(e,t,a,n,o,m){const u=(0,i.up)("router-link"),h=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("header",s,[(0,i._)("ul",l,[(0,i._)("li",d,["/biotron"===this.url?((0,i.wg)(),(0,i.j4)(u,{key:0,to:"/biotron",onClick:this.update,class:"nav-link active"},{default:(0,i.w5)((()=>[(0,i.Uk)("Biotron")])),_:1},8,["onClick"])):((0,i.wg)(),(0,i.j4)(u,{key:1,to:"/biotron",onClick:this.update,class:"nav-link"},{default:(0,i.w5)((()=>[(0,i.Uk)("Biotron")])),_:1},8,["onClick"]))]),(0,i._)("li",c,["/touchme"===this.url?((0,i.wg)(),(0,i.j4)(u,{key:0,onClick:this.update,to:"/touchme",class:"nav-link active"},{default:(0,i.w5)((()=>[(0,i.Uk)("TouchMe")])),_:1},8,["onClick"])):((0,i.wg)(),(0,i.j4)(u,{key:1,to:"/touchme",onClick:this.update,class:"nav-link"},{default:(0,i.w5)((()=>[(0,i.Uk)("TouchMe")])),_:1},8,["onClick"]))])])]),(0,i._)("div",r,[(0,i.Wm)(h)])],64)}var u={name:"App",data(){return{url:String,forceRerender:0}},async mounted(){if(console.log("Hello! You`re curious, aren`t you?"),navigator.requestMIDIAccess){console.log("MIDI is supported!");try{await navigator.requestMIDIAccess();console.log("MIDI is supported!")}catch(e){console.error("Could not access MIDI devices:",e),window.alert("You have denied access to MIDI devices.")}}else console.error("MIDI is not supported. Sending notification..."),window.alert("This browser does not support MIDI.")},methods:{update(){this.forceRerender++}}},h=a(3744);const p=(0,h.Z)(u,[["render",m]]);var _=p;a(8877);const v=(0,i._)("h1",{class:"text-center"},"Biotron change settings",-1),g=(0,i._)("p",null,"BPM - how many notes from the plant will be generated per minute",-1),b=(0,i._)("p",null,"Note Off Percent - how many percent of the time the note will sound, where 100 is the full sound before the note changes, 50 is half the time the note is played",-1),f=(0,i._)("p",null,"Light Bpm - once every number of notes from the plant the note from the photoresistor will sound",-1),w=(0,i._)("p",null,"Plant Middle Note - center of notes",-1),y=(0,i._)("p",null,"Sensitivity (fib) - Fibonacci parameter responsible for the note distribution curve",-1),D=(0,i._)("p",null,"Smoothness - the smoothness of the notes played, where 0 is an instant change in notes, 99 is a smooth change (notes change over time)",-1),S=(0,i._)("p",null,"Scale - scale played from the device",-1),x={class:"row"},j={class:"col"},C=(0,i._)("label",{for:"randomPlantVelSwitch"},"Humanize",-1),V={class:"col"},P=(0,i._)("label",{for:"plantVelDis"},"Mute",-1),I={key:0},R={key:0},k={key:1},O=(0,i._)("p",null,"Plant - responsible for the notes generated by the plant",-1),M={class:"row"},E={class:"col"},N=(0,i._)("label",{for:"randomLightVelSwitch"},"Humanize",-1),L={class:"col"},B=(0,i._)("label",{for:"lightVelDis"},"Mute",-1),A={key:0,class:"row"},T={key:0},U={key:1},F=(0,i._)("p",null,"Light - responsible for notes generated from the photoresistor",-1),W=(0,i._)("p",null,"Velocity - pressing force",-1),Z=(0,i._)("p",null,"Humanize - Velocity randomization at a controlled interval",-1),z=(0,i._)("p",null,"Mute - disable note generation from the channel",-1),H=(0,i._)("p",null,"Same Note - notes that are played only when changing notes with a customizable step, where 1 - produces a note if the notes have changed by 1 note, 10 if there has been a shift by 10 notes",-1),q=(0,i._)("label",{for:"light_pitch_mode"},"Pitch Bend",-1),$=(0,i._)("p",null,"Light Notes Range - setting the range of notes played from the photoresistor (lower and upper limits are set)",-1),G={class:"row"},Y={class:"col"},K=(0,i._)("label",null,"Ultra sensitivity",-1),J={class:"col"},Q=(0,i._)("label",null,"Performance mode",-1),X=(0,i._)("p",null,"Ultra sensitivity - Increases the sensitivity of generation from a plant",-1),ee=(0,i._)("p",null,"Performance mode - Mode for better manual control of the device",-1),te=["disabled"],ae=(0,i._)("p",null,"Send - sending settings to the device",-1),ne=(0,i._)("p",null,"Create Preset - saves settings to a file",-1),oe=(0,i._)("p",null,"Drop Preset Here - you need to transfer the file there by drag drop, or by clicking on the button, select the settings file.",-1);function ie(e,t,a,n,o,s){const l=(0,i.up)("LoaderComponent"),d=(0,i.up)("DeviceSelector"),c=(0,i.up)("PatchSelector"),r=(0,i.up)("SliderCommand"),m=(0,i.up)("GroupOfCommands"),u=(0,i.up)("SelectCommand"),h=(0,i.up)("SwitchComponent"),p=(0,i.up)("SliderRangeCommand"),_=(0,i.up)("UpdateFirmwareComponent"),ie=(0,i.up)("FileDropArea");return(0,i.wg)(),(0,i.iD)(i.HY,null,[this.is_loading?((0,i.wg)(),(0,i.j4)(l,{key:o.forceRerender})):(0,i.kq)("",!0),(0,i._)("div",null,[v,(0,i.Wm)(d,{"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),((0,i.wg)(),(0,i.j4)(c,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,i.Wm)(m,{"name-of-group":"BPM"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{"command-label":"Plant Bpm",key:this.forceRerender,"command-object":this.commands_data.plantBpm},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{"command-label":"Note Off Percent",key:this.forceRerender,"command-object":this.commands_data.noteOffPercent},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{"command-label":"Light Bpm",key:this.forceRerender,"command-object":this.commands_data.lightBpm},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{"command-label":"Root Note",key:this.forceRerender,"command-object":this.commands_data.middle_plant_note,"table-values":this.dig_to_nums},null,8,["command-object","table-values"]))])),description:(0,i.w5)((()=>[g,b,f,w])),_:1}),(0,i.Wm)(m,{"name-of-group":"Sensitivity (fib)"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{"command-label":"Note Distance",key:this.forceRerender,"command-object":this.commands_data.noteDistance},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{"command-label":"First Value",key:this.forceRerender,"command-object":this.commands_data.firstValue},null,8,["command-object"]))])),description:(0,i.w5)((()=>[y])),_:1}),(0,i.Wm)(m,{"name-of-group":"Smoothness"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"command-object":this.commands_data.smoothness},null,8,["command-object"]))])),description:(0,i.w5)((()=>[D])),_:1}),(0,i.Wm)(m,{"name-of-group":"Scale"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(u,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":o.commands_data.scale},null,8,["list-of-variants","command-object"]))])),description:(0,i.w5)((()=>[S])),_:1}),(0,i.Wm)(m,{"name-of-group":"Velocity"},{objects:(0,i.w5)((()=>[(0,i.Wm)(m,{"name-of-group":"Plant"},{objects:(0,i.w5)((()=>[(0,i._)("div",x,[(0,i._)("div",j,[C,(0,i.Wm)(h,{id:"randomPlantVelSwitch","model-value":this.commands_data.randomPlantVelocity},null,8,["model-value"])]),(0,i._)("div",V,[P,(0,i.Wm)(h,{id:"plantVelDis","model-value":o.commands_data.plant_no_velocity},null,8,["model-value"])])]),o.commands_data.plant_no_velocity.value?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",I,[this.commands_data.randomPlantVelocity.value?((0,i.wg)(),(0,i.iD)("div",k,[((0,i.wg)(),(0,i.j4)(p,{key:this.forceRerender,"max-command-object":o.commands_data.maxPlantVelocity,"min-command-object":o.commands_data.minPlantVelocity},null,8,["max-command-object","min-command-object"]))])):((0,i.wg)(),(0,i.iD)("div",R,[((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.maxPlantVelocity},null,8,["command-object"]))]))]))])),description:(0,i.w5)((()=>[O])),_:1}),(0,i.Wm)(m,{"name-of-group":"Light"},{objects:(0,i.w5)((()=>[(0,i._)("div",M,[(0,i._)("div",E,[N,(0,i.Wm)(h,{id:"randomLightVelSwitch","model-value":this.commands_data.randomLightVelocity},null,8,["model-value"])]),(0,i._)("div",L,[B,(0,i.Wm)(h,{id:"lightVelDis","model-value":o.commands_data.light_no_velocity},null,8,["model-value"])])]),o.commands_data.light_no_velocity.value?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",A,[this.commands_data.randomLightVelocity.value?((0,i.wg)(),(0,i.iD)("div",U,[((0,i.wg)(),(0,i.j4)(p,{key:this.forceRerender,"max-command-object":o.commands_data.maxLightVelocity,"min-command-object":o.commands_data.minLightVelocity},null,8,["max-command-object","min-command-object"]))])):((0,i.wg)(),(0,i.iD)("div",T,[((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.maxLightVelocity},null,8,["command-object"]))]))]))])),description:(0,i.w5)((()=>[F])),_:1})])),description:(0,i.w5)((()=>[W,Z,z])),_:1}),(0,i.Wm)(m,{"name-of-group":"Same Note"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.same_note_plant,"command-label":"Plant"},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.same_note_light,"command-label":"Light"},null,8,["command-object"]))])),description:(0,i.w5)((()=>[H])),_:1}),(0,i.Wm)(m,{"name-of-group":"Light Notes Range"},{objects:(0,i.w5)((()=>[q,(0,i.Wm)(h,{id:"light_pitch_mode","model-value":this.commands_data.light_pitch_mode},null,8,["model-value"]),this.commands_data.light_pitch_mode.value?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"command-object":this.commands_data.range_light_note},null,8,["command-object"]))])),description:(0,i.w5)((()=>[$])),_:1}),(0,i.Wm)(m,{"name-of-group":"Extra"},{objects:(0,i.w5)((()=>[(0,i._)("div",G,[(0,i._)("div",Y,[K,((0,i.wg)(),(0,i.j4)(h,{key:this.forceRerender,"model-value":o.commands_data.randomness},null,8,["model-value"]))]),(0,i._)("div",J,[Q,((0,i.wg)(),(0,i.j4)(h,{key:this.forceRerender,"model-value":o.commands_data.performance},null,8,["model-value"]))])])])),description:(0,i.w5)((()=>[X,ee])),_:1}),(0,i._)("button",{onMouseup:t[1]||(t[1]=(...e)=>s.change_data_loader&&s.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1",style:{width:"70%"}},"Send",40,te),(0,i._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary mb-1",style:{width:"70%"}},"Create Preset"),(0,i.Wm)(_,{repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])]),(0,i.Wm)(ie,{name:"Drop Preset Here",onGet_drop:t[3]||(t[3]=e=>s.loadDataFromPreset(e))}),(0,i.Wm)(m,null,{description:(0,i.w5)((()=>[ae,ne,oe])),_:1})],64)}a(7658);var se=a(7327);class le{set_value(e){this.value=e}set_default(){this.value=this.default_value}constructor({name:e=null,number_command:t=0,value:a=null,min_value:n=0,max_value:o=127,step:i=1,default_value:s=0,sendable:l=!0,custom_fold:d=null}){if((0,se.Z)(this,"flag_device",[11]),(0,se.Z)(this,"name",void 0),(0,se.Z)(this,"number_command",void 0),(0,se.Z)(this,"value",void 0),(0,se.Z)(this,"default_value",void 0),(0,se.Z)(this,"min_value",void 0),(0,se.Z)(this,"max_value",void 0),(0,se.Z)(this,"step",void 0),(0,se.Z)(this,"sendable",void 0),(0,se.Z)(this,"custom_fold",void 0),null===t)throw"Number Command is null";this.name=null===e?`Command number ${t}`:e,this.number_command=t,this.value=null===a?s:a,this.min_value=n,this.max_value=o,this.step=i,this.default_value=s,this.sendable=l,this.custom_fold=d}toString(){return`{"name": "${this.name}", "value": ${this.value}, "params": {\n            "number_command": ${this.number_command},\n            "min_value": ${this.min_value},\n            "max_value": ${this.max_value},\n            "step": ${this.step},\n            "default_value": ${this.default_value}\n        }}`}toShortDict(){return{name:this.name,value:this.value}}check_params(){return!(this.min_value>this.max_value)&&(!(this.value<this.min_value)&&this.value<=this.max_value)}sendToMidi(e,t){if(!this.sendable)return;if(!this.check_params())return;let a=[240];if(t)for(let n of t)a.push(n);else for(let n of this.flag_device)a.push(n);a.push(this.number_command),this.custom_fold?this.custom_fold(a,this.value):a.push(this.value%127),a.push(247),console.log(a),e.send(a)}}function de(e){e&&(e.send([240,11,127,247]),ce(100),e.send([240,11,20,13,127,247]))}function ce(e){const t=Date.now();let a=null;do{a=Date.now()}while(a-t<e)}var re=a(5702),me=a(2262);class ue{constructor(e){(0,se.Z)(this,"DB_NAME","Playtronica_WebMIDI_db"),(0,se.Z)(this,"STORE_NAME","Biotron_Patches"),(0,se.Z)(this,"VERSION",7),(0,se.Z)(this,"DEFAULT",{name:"Default",saved:!0,editable:!1,data:{}});const t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB;t||console.log("IndexedDB could not be found in this browser."),this.commands=e}async openDB(){const e=indexedDB.open(this.DB_NAME,this.VERSION);let t=this;e.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},e.onupgradeneeded=function(){const a=e.result;a.objectStoreNames.contains(t.STORE_NAME)&&a.deleteObjectStore(t.STORE_NAME);let n=a.createObjectStore(t.STORE_NAME,{keyPath:"id",autoIncrement:!0});for(let e of(0,me.IU)(t.commands))t.DEFAULT.data[e[1].name]=e[1].default_value;n.put((0,me.IU)(t.DEFAULT))},e.onsuccess=function(){console.log("Database opened successfully"),e.result.close()}}createPatch(e,t){const a=indexedDB.open(this.DB_NAME,this.VERSION);let n=this;a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const o=a.result,i=o.transaction(n.STORE_NAME,"readwrite"),s=i.objectStore(n.STORE_NAME);t?s.put({name:t,editable:!0,saved:!0,data:e}):s.put({name:"Unsaved Patch",editable:!0,saved:!1,data:e}),i.oncomplete=function(){o.close()}}}async getPatch(e){let t=this;return new Promise((a=>{const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,i=o.transaction(t.STORE_NAME,"readonly"),s=i.objectStore(t.STORE_NAME);let l;l=e?s.get(parseInt(e)):s.getAll(),l.onsuccess=function(){a(l.result)},i.oncomplete=function(){o.close()}}}))}async getUnsavedPatch(){let e=await this.getPatch();return e.at(-1).saved?(this.createPatch((0,me.IU)(this.DEFAULT)),e=await this.getPatch(),e.at(-1).id):e.at(-1).id}deletePatch(e){if(!e)return;let t=this;const a=indexedDB.open(this.DB_NAME,this.VERSION);a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const n=a.result,o=n.transaction(t.STORE_NAME,"readwrite"),i=o.objectStore(t.STORE_NAME);let s=i.delete(e);s.onsuccess=function(){console.log("Patch deleted")},o.oncomplete=function(){n.close()}}}updatePatch(e,t){if(!e||!t)return;let a=this;const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,i=o.transaction(a.STORE_NAME,"readwrite"),s=i.objectStore(a.STORE_NAME);let l;l=e?s.get(parseInt(e)):s.getAll(),l.onsuccess=function(){l.result.data=t,s.put(l.result)},i.oncomplete=function(){o.close()}}}savePatch(e,t){if(!e||!t)return;let a=this;const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,i=o.transaction(a.STORE_NAME,"readwrite"),s=i.objectStore(a.STORE_NAME);let l;l=e?s.get(parseInt(e)):s.getAll(),l.onsuccess=function(){l.result.name=t,l.result.saved=!0,s.put(l.result)},i.oncomplete=function(){o.close()}}}}let he=new Map(Object.entries({plantBpm:new le({name:"plantBpm",number_command:0,default_value:60,max_value:1e3,sendable:!0,custom_fold:(e,t)=>{for(let a=0;a<Math.floor(t/127);a++)e.push(127);e.push(t%127)}}),lightBpm:new le({name:"lightBpm",number_command:9,default_value:4,max_value:30}),noteOffPercent:new le({name:"noteOffPercent",number_command:12,default_value:100,max_value:100}),noteDistance:new le({name:"noteDistance",number_command:1,default_value:50,max_value:100}),firstValue:new le({name:"firstValue",number_command:2,default_value:10,max_value:100}),smoothness:new le({name:"smoothness",number_command:3,max_value:99}),scale:new le({name:"scale",number_command:4,default_value:0}),minPlantVelocity:new le({name:"minPlantVelocity",number_command:15,default_value:74,max_value:127}),maxPlantVelocity:new le({name:"maxPlantVelocity",number_command:5,default_value:75,max_value:127}),minLightVelocity:new le({name:"minLightVelocity",number_command:17,default_value:74,max_value:127}),maxLightVelocity:new le({name:"maxLightVelocity",number_command:6,default_value:75,max_value:127}),randomness:new le({name:"randomness",number_command:10,default_value:0}),same_note_plant:new le({name:"same_note_plant",number_command:11,default_value:0,max_value:10}),same_note_light:new le({name:"same_note_light",number_command:24,default_value:0,max_value:10}),range_light_note:new le({name:"range_light_note",number_command:13,default_value:12,max_value:36}),light_pitch_mode:new le({name:"light_pitch_mode",number_command:19,default_value:0,sendable:!0}),plant_no_velocity:new le({name:"plant_no_velocity",default_value:0,number_command:22}),light_no_velocity:new le({name:"light_no_velocity",default_value:0,number_command:23}),randomPlantVelocity:new le({name:"randomPlantVelocity",default_value:0,number_command:16}),randomLightVelocity:new le({name:"randomLightVelocity",default_value:0,number_command:18}),performance:new le({name:"performance",number_command:21,default_value:0}),middle_plant_note:new le({name:"middle_plant_note",number_command:25,default_value:60,min_value:60,max_value:72})}));class pe extends ue{constructor(){super(he),(0,se.Z)(this,"DB_NAME","BiotronDB"),(0,se.Z)(this,"STORE_NAME","Biotron_Patches"),(0,se.Z)(this,"VERSION",3)}}var _e=a(3577);const ve={id:"dropZone",class:"text-center"};function ge(e,t,a,n,o,s){return(0,i.wg)(),(0,i.iD)("div",{class:"droparea",onClick:t[1]||(t[1]=(...e)=>this.dropAreaClick&&this.dropAreaClick(...e)),onDragover:t[2]||(t[2]=e=>e.preventDefault()),onDrop:t[3]||(t[3]=e=>s.dropAreaDrop(e))},[(0,i._)("div",ve,[(0,i._)("input",{type:"file",id:"load_preset",style:{display:"none"},onChange:t[0]||(t[0]=e=>s.loadPresetChanged(e))},null,32),(0,i._)("p",null,(0,_e.zw)(this.name),1)])],32)}var be={methods:{dropAreaClick(){document.getElementById("load_preset").click()},dropAreaDrop(e){e.preventDefault();let t=e.dataTransfer.files[0],a=new FileReader,n=this;a.onload=function(e){n.$emit("get_drop",e.target.result)},"text/plain"!==t.type&&".scl"!==t.name.substring(t.name.lastIndexOf("."))||a.readAsText(t)},loadPresetChanged(e){let t=e.srcElement.files[0],a=new FileReader,n=this;a.onload=function(e){n.$emit("get_drop",e.target.result)},"text/plain"===t.type&&(a.readAsText(t),document.getElementById("load_preset").value="")}},props:{name:{type:String,default:"Drop preset here"}}};const fe=(0,h.Z)(be,[["render",ge],["__scopeId","data-v-5b3c5632"]]);var we=fe;const ye={class:"settings_elem"},De={key:0,class:"description_elem"};function Se(e,t,a,n,o,s){return(0,i.wg)(),(0,i.iD)("div",ye,[(0,i._)("h2",null,(0,_e.zw)(this.nameOfGroup),1),(0,i.WI)(e.$slots,"objects",{},void 0,!0),this.$slots.description?((0,i.wg)(),(0,i.iD)("div",De,[(0,i.WI)(e.$slots,"description",{},void 0,!0)])):(0,i.kq)("",!0)])}var xe={name:"GroupOfCommands",methods:{getTransitionRawChildren:i.Q6},props:{nameOfGroup:{default:"",type:String}},data(){return{}}};const je=(0,h.Z)(xe,[["render",Se],["__scopeId","data-v-5162b065"]]);var Ce=je;const Ve=e=>((0,i.dD)("data-v-5fb193de"),e=e(),(0,i.Cn)(),e),Pe={class:"container"},Ie={class:"col w-100 mb-4"},Re={class:"switch"},ke=["checked"],Oe=Ve((()=>(0,i._)("span",{class:"slider round"},null,-1)));function Me(e,t,a,n,o,s){return(0,i.wg)(),(0,i.iD)("div",Pe,[(0,i._)("div",Ie,[(0,i._)("label",Re,[(0,i._)("input",{id:"checkbox_input",type:"checkbox",checked:a.modelValue.value,onClick:t[0]||(t[0]=e=>a.modelValue.set_value(e.target.checked)),onInput:t[1]||(t[1]=(...e)=>this.changed&&this.changed(...e))},null,40,ke),Oe])])])}var Ee={name:"SwitchComponent",props:{modelValue:{type:le}},emits:["update:modelValue"],methods:{changed(){document.dispatchEvent(new CustomEvent("InputChanged"))}}};const Ne=(0,h.Z)(Ee,[["render",Me],["__scopeId","data-v-5fb193de"]]);var Le=Ne;const Be={class:"row m-2"},Ae={for:"value_input"},Te={key:0},Ue=["value"],Fe={key:1},We=["min","max"],Ze=["min","max","step"];function ze(e,t,a,o,s,l){return(0,i.wg)(),(0,i.iD)("div",Be,[(0,i._)("label",Ae,(0,_e.zw)(this.commandLabel),1),this.tableValues?((0,i.wg)(),(0,i.iD)("div",Te,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.Value=e),id:"scale",class:"form-control",onInput:t[1]||(t[1]=(...e)=>l.changed&&l.changed(...e))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.tableValues,((e,t)=>((0,i.wg)(),(0,i.iD)("option",{key:t,value:t},(0,_e.zw)(e),9,Ue)))),128))],544),[[n.bM,this.Value]])])):((0,i.wg)(),(0,i.iD)("div",Fe,[(0,i.wy)((0,i._)("input",{type:"number",id:"value_input",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>this.Value=e),min:this.commandObject.min_value,max:this.commandObject.max_value,onInput:t[3]||(t[3]=(...e)=>this.changed&&this.changed(...e))},null,40,We),[[n.nr,this.Value]])])),(0,i.wy)((0,i._)("input",{type:"range",id:"range_input",class:"settings_input","onUpdate:modelValue":t[4]||(t[4]=e=>this.Value=e),min:this.commandObject.min_value,max:this.commandObject.max_value,step:this.commandObject.step,onInput:t[5]||(t[5]=(...e)=>this.changed&&this.changed(...e))},null,40,Ze),[[n.nr,this.Value]])])}var He={props:{commandLabel:{default:"",type:String},commandObject:{required:!0,type:le},tableValues:{required:!1,type:Map}},emits:["changedValue"],data(){return{Value:0}},watch:{Value(){this.checkLimit(),this.commandObject.set_value(this.Value)}},methods:{checkLimit(){this.Value>this.commandObject.max_value&&(this.Value=this.commandObject.max_value),this.Value<this.commandObject.min_value&&(this.Value=this.commandObject.min_value)},changed(){document.dispatchEvent(new CustomEvent("InputChanged"))}},created(){this.Value=this.commandObject.value}};const qe=(0,h.Z)(He,[["render",ze],["__scopeId","data-v-128a02d8"]]);var $e=qe;const Ge={class:"row m-2"},Ye={for:"value_input"},Ke={class:"row"},Je={class:"col"},Qe=["min","max"],Xe={class:"col"},et=["min","max"],tt={class:"row"};function at(e,t,a,o,s,l){const d=(0,i.up)("MultiRangeSlider");return(0,i.wg)(),(0,i.iD)("div",Ge,[(0,i._)("label",Ye,(0,_e.zw)(this.commandLabel),1),(0,i._)("div",Ke,[(0,i._)("div",Je,[(0,i.wy)((0,i._)("input",{type:"number",id:"value_input_min",class:"form-control",onInput:t[0]||(t[0]=(...e)=>this.changed&&this.changed(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>this.minValue=e),min:this.minCommandObject.min_value,max:this.minCommandObject.max_value},null,40,Qe),[[n.nr,this.minValue]])]),(0,i.Uk)(" - "),(0,i._)("div",Xe,[(0,i.wy)((0,i._)("input",{type:"number",id:"value_input_max",class:"form-control",onInput:t[2]||(t[2]=(...e)=>this.changed&&this.changed(...e)),"onUpdate:modelValue":t[3]||(t[3]=e=>this.maxValue=e),min:this.minCommandObject.min_value,max:this.maxCommandObject.max_value},null,40,et),[[n.nr,this.maxValue]])])]),(0,i._)("div",tt,[(0,i.Wm)(d,{baseClassName:"multi-range-slider-bar-only",minValue:this.minValue,maxValue:this.maxValue,max:this.maxCommandObject.max_value,min:this.minCommandObject.min_value,step:this.minCommandObject.step,onInput:l.update_oBarValues},null,8,["minValue","maxValue","max","min","step","onInput"])])])}var nt=a(9098),ot={components:{MultiRangeSlider:nt.Z},props:{commandLabel:{default:"",type:String},minCommandObject:{required:!0,type:le},maxCommandObject:{required:!0,type:le}},data(){return{minValue:0,maxValue:0}},watch:{},methods:{update_oBarValues(e){this.minValue=e.minValue,this.maxValue=e.maxValue,this.updateValue(),document.dispatchEvent(new CustomEvent("InputChanged"))},changed(){},updateValue(){this.minValue<this.minCommandObject.min_value&&(this.minValue=this.minCommandObject),this.minValue>this.maxValue&&(this.minValue=this.maxValue),this.minCommandObject.set_value(this.minValue),this.maxValue<this.minValue&&(this.maxValue=this.minValue),this.maxValue>this.maxCommandObject.max_value&&(this.minValue=this.maxCommandObject.max_value),this.maxCommandObject.set_value(this.maxValue)}},created(){this.minValue=this.minCommandObject.value,this.maxValue=this.maxCommandObject.value,this.minValue>this.maxValue&&(this.minValue=this.maxValue)}};const it=(0,h.Z)(ot,[["render",at]]);var st=it;const lt={class:"row m-2"},dt={for:"value_input"},ct=["value"];function rt(e,t,a,o,s,l){return(0,i.wg)(),(0,i.iD)("div",lt,[(0,i._)("label",dt,(0,_e.zw)(this.commandLabel),1),(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.Value=e),id:"scale",class:"form-control",onInput:t[1]||(t[1]=(...e)=>l.changed&&l.changed(...e))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.listOfVariants,((e,t)=>((0,i.wg)(),(0,i.iD)("option",{key:t,value:t},(0,_e.zw)(e),9,ct)))),128))],544),[[n.bM,this.Value]])])}var mt={props:{commandLabel:{default:"",type:String},listOfVariants:{default:{}},commandObject:{required:!0,type:le}},data(){return{Value:0}},methods:{changed(){document.dispatchEvent(new CustomEvent("InputChanged"))}},watch:{Value(){this.commandObject.set_value(this.Value)}},mounted(){this.Value=this.commandObject.value}};const ut=(0,h.Z)(mt,[["render",rt],["__scopeId","data-v-ad38186a"]]);var ht=ut;const pt={class:"input-group mb-3"},_t=["value"],vt=["data-bs-target"],gt={class:"modal fade",id:"saveModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},bt={class:"modal-dialog"},ft={class:"modal-content"},wt=(0,i._)("div",{class:"modal-header"},[(0,i._)("h5",{class:"modal-title",id:"exampleModalLabel"},"Save Patch"),(0,i._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1),yt={class:"modal-body"},Dt={class:"mb-3"},St=(0,i._)("label",{for:"recipient-name",class:"col-form-label"},"Patch Name",-1),xt={class:"modal-footer"},jt=(0,i._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1),Ct={class:"modal fade",id:"deleteModel",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Vt={class:"modal-dialog"},Pt={class:"modal-content"},It=(0,i.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Delete Patch</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancel"></button></div><div class="modal-body"><div class="mb-3"> Do you really want to delete this patch? </div></div>',2),Rt={class:"modal-footer"},kt=(0,i._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1);function Ot(e,t,a,o,s,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",pt,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.id=e),class:"form-control",onChange:t[1]||(t[1]=(...e)=>this.patchChanged&&this.patchChanged(...e))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.patches,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e.id,value:e.id},(0,_e.zw)(e.name),9,_t)))),128))],544),[[n.bM,this.id]]),(0,i._)("div",{class:"input-group-prepend",style:(0,_e.j5)({display:s.active_button_enabled?"block":"none"})},[(0,i._)("button",{class:(0,_e.C_)(["btn",{"btn-outline-primary":"Save"===this.button_state,"btn-outline-danger":"Delete"===this.button_state}]),type:"button","data-bs-toggle":"modal",onClick:t[2]||(t[2]=(...e)=>this.modelOpen&&this.modelOpen(...e)),"data-bs-target":"Save"===this.button_state?"#saveModal":"#deleteModel"},(0,_e.zw)(this.button_state),11,vt)],4)]),(0,i._)("div",gt,[(0,i._)("div",bt,[(0,i._)("div",ft,[wt,(0,i._)("div",yt,[(0,i._)("div",Dt,[St,(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{type:"text",class:"form-control",id:"patchName","onUpdate:modelValue":t[3]||(t[3]=e=>this.patchName=e),key:this.forceRerender,autocomplete:"off","data-autofocus":""})),[[n.nr,this.patchName]])])]),(0,i._)("div",xt,[jt,(0,i._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[4]||(t[4]=(...e)=>this.savePatch&&this.savePatch(...e))},"Save")])])])]),(0,i._)("div",Ct,[(0,i._)("div",Vt,[(0,i._)("div",Pt,[It,(0,i._)("div",Rt,[kt,(0,i._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...e)=>this.deletePatch&&this.deletePatch(...e))},"Delete")])])])])],64)}var Mt={props:{patches:{type:Array},page_id:{type:String,required:!0}},name:"PatchSelector",data(){return{id:0,active_button_enabled:!0,button_state:"Save",patchName:"",forceRerender:0}},watch:{},methods:{patchChanged(){if(console.log(),localStorage.setItem(this.page_id,this.id),!this.patches)return;let e;for(let t of this.patches)if(this.id===t.id){e=t;break}e&&(this.active_button_enabled=e.editable,this.button_state=e.saved?"Delete":"Save",document.dispatchEvent(new CustomEvent("PatchChanged")))},savePatch(){document.dispatchEvent(new CustomEvent("PatchSave",{detail:this.patchName}))},deletePatch(){document.dispatchEvent(new CustomEvent("PatchDelete"))},modelOpen(){this.patchName=""}},mounted(){if(this.id=parseInt(localStorage.getItem(this.page_id)),!this.patches)return;let e;for(let t of this.patches)if(this.id===t.id){e=t;break}e&&(this.active_button_enabled=e.editable,this.button_state=e.saved?"Delete":"Save",document.addEventListener("shown.bs.modal",(()=>{"Save"===this.button_state&&document.getElementById("patchName").focus()})))}};const Et=(0,h.Z)(Mt,[["render",Ot]]);var Nt=Et;const Lt={class:"form-floating mb-3"},Bt=["value"],At=(0,i._)("label",{for:"device"},"Select device",-1);function Tt(e,t,a,o,s,l){return(0,i.wg)(),(0,i.iD)("div",Lt,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.currentMidiNum=e),class:"form-control"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.midiOut,((e,t)=>((0,i.wg)(),(0,i.iD)("option",{key:e.id,value:t},(0,_e.zw)(e.name),9,Bt)))),128))],512),[[n.bM,s.currentMidiNum]]),At])}var Ut={props:{regexName:{default:".*",type:String}},name:"DeviceSelector",data(){return{midiIn:[],midiOut:[],currentMidiNum:0}},watch:{currentMidiNum(){this.deviceChanged()}},methods:{midiReady(e){e.addEventListener("statechange",(e=>this.initDevices(e.target))),this.initDevices(e)},initDevices(e){this.midiIn=[],this.midiOut=[];const t=e.inputs.values();for(let n=t.next();n&&!n.done;n=t.next())n.value.name.match(this.regexName)&&this.midiIn.push(n.value);const a=e.outputs.values();for(let n=a.next();n&&!n.done;n=a.next())n.value.name.match(this.regexName)&&(this.midiOut.push(n.value),console.log(n.value),n.value.send([]));0!==a.length&&this.$emit("device_changed",this.midiOut[this.currentMidiNum])},deviceChanged(){this.$emit("device_changed",this.midiOut[this.currentMidiNum])}},mounted(){navigator.requestMIDIAccess({sysex:!0}).then((e=>this.midiReady(e)),(e=>console.log("Something went wrong",e)))}};const Ft=(0,h.Z)(Ut,[["render",Tt]]);var Wt=Ft;const Zt=(0,i._)("button",{"data-bs-toggle":"modal","data-bs-target":"#UpdateConf",class:"btn btn-primary mb-1",style:{width:"70%"}},"Update Firmware",-1),zt={class:"modal fade",id:"UpdateConf",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ht={class:"modal-dialog modal-dialog-centered"},qt={class:"modal-content"},$t=(0,i.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Update Firmware</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><p> After clicking on &quot;Update&quot;, you will get a file with the .uf2 extension and the device will switch to boot mode. The device will be displayed as removable media (like a USB flash drive). You should transfer the resulting .uf2 file to the removable media that appeared. </p><h6 style="color:red;">ATTENTION</h6><p>The device won&#39;t work until you move the file.</p></div>',2),Gt={class:"modal-footer"},Yt=(0,i._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function Kt(e,t,a,n,o,s){return(0,i.wg)(),(0,i.iD)(i.HY,null,[Zt,(0,i._)("div",zt,[(0,i._)("div",Ht,[(0,i._)("div",qt,[$t,(0,i._)("div",Gt,[Yt,(0,i._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=e=>s.LoadFirmware(this.repo,this.device))}," Update")])])])])],64)}function Jt(e,t){fetch(`https://api.github.com/repos/${e}/releases/latest`,{headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}}).then((e=>e.json())).then((e=>{console.log(e),window.location.replace(e.assets[0]["browser_download_url"])})),de(t)}var Qt={methods:{LoadFirmware:Jt},props:{repo:{type:String},device:Object}};const Xt=(0,h.Z)(Qt,[["render",Kt]]);var ea=Xt;const ta=e=>((0,i.dD)("data-v-ce1ea73a"),e=e(),(0,i.Cn)(),e),aa={id:"loader_div",style:{position:"fixed","z-index":"10",width:"100%",height:"100%","background-color":"rgba(59,54,54,0.4)",top:"0",left:"0"}},na={class:"container text-center",style:{transform:"translate(0, 50vh)"}},oa={class:"row justify-content-center"},ia=ta((()=>(0,i._)("h1",{style:{color:"#0d6efd","font-weight":"bold","text-shadow":"0px 0px 6px #fff"}}," Loading ",-1)));function sa(e,t,a,o,s,l){return(0,i.wg)(),(0,i.iD)("div",aa,[(0,i._)("div",na,[(0,i._)("div",oa,[ia,(0,i.wy)((0,i._)("div",{class:"lds-ring",style:(0,_e.j5)({width:`${a.size}px`,height:`${a.size}px`,padding:"0px"})},[(0,i._)("div",{style:(0,_e.j5)([s.spinnerStyle,l.animDiv1])},null,4),(0,i._)("div",{style:(0,_e.j5)([s.spinnerStyle,l.animDiv2])},null,4),(0,i._)("div",{style:(0,_e.j5)([s.spinnerStyle,l.animDiv3])},null,4),(0,i._)("div",{style:(0,_e.j5)([s.spinnerStyle])},null,4)],4),[[n.F8,a.loading]])])])])}function la(e){const t=new RegExp(/^\d*\.?\d+(s|ms)$/);return t.test(e)}function da(e,t,a){const n={},o=t.match(/^\d*\.?\d+/)[0],i=t.match(/s|(ms)$/)[0],s=Math.round(1e3*o*a)/1e3;return n[e]=s+i,n}var ca={name:"RingLoader",props:{loading:{type:Boolean,default:!0},size:{type:Number,default:55},color:{type:String,default:"#3083fa"},duration:{type:String,default:"1.2s",validator:la}},data(){return{spinnerStyle:{borderWidth:.1*this.size+"px",borderColor:`${this.color} transparent transparent transparent`,animationDuration:this.duration}}},computed:{animDiv1(){return da("animationDelay",this.duration,-.375)},animDiv2(){return da("animationDelay",this.duration,-.25)},animDiv3(){return da("animationDelay",this.duration,-.125)}}};const ra=(0,h.Z)(ca,[["render",sa],["__scopeId","data-v-ce1ea73a"]]);var ma=ra,ua={components:{LoaderComponent:ma,UpdateFirmwareComponent:ea,DeviceSelector:Wt,PatchSelector:Nt,SelectCommand:ht,SliderRangeCommand:st,SliderCommand:$e,SwitchComponent:Le,GroupOfCommands:Ce,FileDropArea:we},props:{id:{type:String,required:!0},test:{type:Boolean,default:!1}},methods:{async change_data_loader(){this.device&&(ce(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData(),ce(100),this.sendDataTest()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,16,127,247]);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),ce(100));this.device.send([240,11,126,247]),ce(100),this.commands_data.plantBpm.sendToMidi(this.device)}},async sendDataTest(){if(this.device){this.device.send([240,11,20,13,126,247]),ce(100);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device,[20,13]),ce(100));ce(100),this.device.send([240,11,20,13,126,247]),ce(100),this.commands_data.plantBpm.sendToMidi(this.device,[20,13])}},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"biotron-preset.txt",{type:"text/plain;charset=utf-8"});(0,re.p)(a,"biotron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],dig_to_nums:{60:"C4",61:"C#4",62:"D4",63:"D#4",64:"E4",65:"F4",66:"F#4",67:"G4",68:"G#4",69:"A4",70:"A#4",71:"B4",72:"C5"},device:null,forceRerender:0,patchRerender:0,db:{type:pe},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(he)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new pe,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const ha=(0,h.Z)(ua,[["render",ie]]);var pa=ha;const _a=(0,i._)("h1",{class:"text-center"},"TouchMe change settings",-1),va=(0,i._)("p",null,"Scale - scale played from the device",-1),ga=(0,i._)("p",null,"Key - Start Note in default range (Disabled when custom range is active)",-1),ba={class:"row"},fa={class:"col"},wa=(0,i._)("label",{for:"humanizeSwitch"},"Humanize",-1),ya={class:"col"},Da=(0,i._)("label",{for:"velocityDisableSwitch"},"Mute",-1),Sa={key:0},xa={key:0},ja={key:1},Ca=(0,i._)("p",null,"Velocity - pressing force",-1),Va=(0,i._)("p",null,"Humanize - Velocity randomization at a controlled interval",-1),Pa=(0,i._)("p",null,"Mute - disable note generation from the channel",-1),Ia={class:"row"},Ra={class:"col"},ka=(0,i._)("label",{for:"notesRangeSwitch"},"Custom Range",-1),Oa={key:0},Ma=(0,i._)("p",null,"Notes Range - Range of playable notes",-1),Ea=["disabled"],Na=(0,i._)("p",null,"Send - sending settings to the device",-1),La=(0,i._)("p",null,"Create Preset - saves settings to a file",-1),Ba=(0,i._)("p",null,"Drop Preset Here - you need to transfer the file there by drag drop, or by clicking on the button, select the settings file.",-1);function Aa(e,t,a,n,o,s){const l=(0,i.up)("LoaderComponent"),d=(0,i.up)("DeviceSelector"),c=(0,i.up)("PatchSelector"),r=(0,i.up)("SelectCommand"),m=(0,i.up)("GroupOfCommands"),u=(0,i.up)("SliderCommand"),h=(0,i.up)("SwitchComponent"),p=(0,i.up)("SliderRangeCommand"),_=(0,i.up)("UpdateFirmwareComponent"),v=(0,i.up)("FileDropArea");return(0,i.wg)(),(0,i.iD)(i.HY,null,[this.is_loading?((0,i.wg)(),(0,i.j4)(l,{key:o.forceRerender})):(0,i.kq)("",!0),_a,(0,i.Wm)(d,{"regex-name":"TouchMe",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),((0,i.wg)(),(0,i.j4)(c,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,i.Wm)(m,{"name-of-group":"Scale"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":this.commands_data.Scale},null,8,["list-of-variants","command-object"]))])),description:(0,i.w5)((()=>[va])),_:1}),(0,i.Wm)(m,{"name-of-group":"Key"},(0,i.Nv)({description:(0,i.w5)((()=>[ga])),_:2},[this.commands_data.customRange.value?void 0:{name:"objects",fn:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(u,{"command-label":"",key:this.forceRerender,"command-object":this.commands_data.Key,"table-values":this.dig_to_nums},null,8,["command-object","table-values"]))])),key:"0"}]),1024),(0,i.Wm)(m,{"name-of-group":"Velocity"},{objects:(0,i.w5)((()=>[(0,i._)("div",ba,[(0,i._)("div",fa,[wa,(0,i.Wm)(h,{id:"humanizeSwitch","model-value":this.commands_data.humanize,"onUpdate:modelValue":t[1]||(t[1]=e=>{this.isHumanize=e,o.forceRerender++})},null,8,["model-value"])]),(0,i._)("div",ya,[Da,(0,i.Wm)(h,{id:"velocityDisableSwitch","model-value":this.commands_data.mute,"onUpdate:modelValue":t[2]||(t[2]=e=>{this.isMute=e})},null,8,["model-value"])])]),this.commands_data.mute.value?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Sa,[this.commands_data.humanize.value?((0,i.wg)(),(0,i.iD)("div",ja,[((0,i.wg)(),(0,i.j4)(p,{key:this.forceRerender,"max-command-object":this.commands_data.maxVelocity,"min-command-object":this.commands_data.minVelocity},null,8,["max-command-object","min-command-object"]))])):((0,i.wg)(),(0,i.iD)("div",xa,[((0,i.wg)(),(0,i.j4)(u,{key:this.forceRerender,"command-object":this.commands_data.maxVelocity},null,8,["command-object"]))]))]))])),description:(0,i.w5)((()=>[Ca,Va,Pa])),_:1}),(0,i.Wm)(m,{"name-of-group":"Notes Range"},{objects:(0,i.w5)((()=>[(0,i._)("div",Ia,[(0,i._)("div",Ra,[ka,(0,i.Wm)(h,{id:"notesRangeSwitch","model-value":this.commands_data.customRange,"onUpdate:modelValue":t[3]||(t[3]=e=>{this.customRange=e,o.forceRerender++})},null,8,["model-value"])])]),this.commands_data.customRange.value?((0,i.wg)(),(0,i.iD)("div",Oa,[((0,i.wg)(),(0,i.j4)(p,{key:this.forceRerender,"max-command-object":this.commands_data.highestNote,"min-command-object":this.commands_data.lowestNote},null,8,["max-command-object","min-command-object"]))])):(0,i.kq)("",!0)])),description:(0,i.w5)((()=>[Ma])),_:1}),(0,i._)("button",{onMouseup:t[4]||(t[4]=(...e)=>s.change_data_loader&&s.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1",style:{width:"70%"}},"Send",40,Ea),(0,i._)("button",{onClick:t[5]||(t[5]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary mb-1",style:{width:"70%"}},"Create Preset"),(0,i.Wm)(_,{repo:"Playtronica/touchme-releases",device:this.device},null,8,["device"]),(0,i.Wm)(v,{name:"Drop Preset Here",onGet_drop:t[6]||(t[6]=e=>s.loadDataFromPreset(e))}),(0,i.Wm)(m,null,{description:(0,i.w5)((()=>[Na,La,Ba])),_:1})],64)}let Ta=new Map(Object.entries({Scale:new le({name:"Scale",number_command:0,default_value:0,max_value:11}),Key:new le({name:"Key",number_command:1,default_value:1,min_value:1,max_value:12}),maxVelocity:new le({name:"maxVelocity",number_command:2,default_value:70,max_value:127}),minVelocity:new le({name:"minVelocity",number_command:3,default_value:50,max_value:127}),highestNote:new le({name:"highestNote",number_command:8,default_value:84,max_value:127}),lowestNote:new le({name:"lowestNote",number_command:7,default_value:48,max_value:127}),customRange:new le({name:"customRange",number_command:6,default_value:0,value:0}),humanize:new le({name:"humanize",number_command:4,default_value:0,value:0}),mute:new le({name:"mute",number_command:5,default_value:0,value:0})}));class Ua extends ue{constructor(){super(Ta),(0,se.Z)(this,"DB_NAME","TouchMeDB"),(0,se.Z)(this,"STORE_NAME","TouchMe_Patches"),(0,se.Z)(this,"VERSION",1)}}var Fa={components:{LoaderComponent:ma,UpdateFirmwareComponent:ea,PatchSelector:Nt,SliderRangeCommand:st,SwitchComponent:Le,FileDropArea:we,SliderCommand:$e,DeviceSelector:Wt,GroupOfCommands:Ce,SelectCommand:ht},props:{id:{type:String,required:!0}},methods:{LoadFirmware:Jt,change_data_loader(){this.device&&(ce(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),2e3),setTimeout(function(){this.device.send([240,11,20,13,0,247]),this.sendDataTest(),ce(100),this.sendData(),this.device.send([240,11,20,13,1,247])}.bind(this),10))},async sendData(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device),ce(100);this.saveData()},async sendDataTest(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device,[20,13]),ce(100);this.saveData()},async saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"touchme-preset.txt",{type:"text/plain;charset=utf-8"});(0,re.p)(a,"touchme-preset.txt")},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],dig_to_nums:{1:"C3",2:"C#3",3:"D3",4:"D#3",5:"E3",6:"F3",7:"F#3",8:"G3",9:"G#3",10:"A3",11:"A#3",12:"B3"},device:null,forceRerender:0,patchRerender:0,isHumanize:!1,isMute:!1,customRange:!1,db:{type:Ua},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Ta)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Ua,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},async mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const Wa=(0,h.Z)(Fa,[["render",Aa]]);var Za=Wa;const za=(0,i._)("h1",{class:"text-center"},"Scala Loader",-1),Ha=(0,i._)("h1",{class:"text-center",style:{color:"red"}}," This page is being developed ",-1),qa=(0,i._)("h2",null,[(0,i.Uk)("Create your own scala file or choose from list on "),(0,i._)("a",{href:"https://isartum.net/leimma"},"Leimma")],-1),$a={class:"row"},Ga={class:"col-9"},Ya={class:"col-3"};function Ka(e,t,a,o,s,l){const d=(0,i.up)("DeviceSelector"),c=(0,i.up)("FileDropArea");return(0,i.wg)(),(0,i.iD)(i.HY,null,[za,Ha,qa,(0,i.Wm)(d,{"regex-name":"",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),(0,i._)("div",$a,[(0,i._)("div",Ga,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.url=e),type:"text",id:"url_input",class:"form-control",placeholder:"Leimma link"},null,512),[[n.nr,this.url]])]),(0,i._)("div",Ya,[(0,i._)("button",{onClick:t[2]||(t[2]=(...e)=>this.loadUrl&&this.loadUrl(...e)),class:"btn btn-primary mb-1",style:{width:"70%"}},"Send")])]),(0,i.Wm)(c,{name:"Drop Scala File Here",onGet_drop:t[3]||(t[3]=e=>this.loadFile(e))})],64)}var Ja={components:{FileDropArea:we,DeviceSelector:Wt},props:{},methods:{loadFile(e){let t=e.split("\n");if(!t[0].includes(".scl"))return;let a=t.lastIndexOf("!"),n=parseInt(t[a-1]),o=t.slice(a+1,a+n+1);this.convertCentsString(o,n)},loadUrl(){if(!this.url.includes("/tuningsystem"))return;let e=this.url.substring(this.url.lastIndexOf("/tuningsystem/")+14),t=e.substring(7,8);if("~"!==t&&"s"!==t)return void console.log("Strange Delimiter");let a=e.split(t);if("s"===t)for(let n=0;n<a.length;n++)a[n]=a[n].substring(4);a=a.slice(1),a.push("2r1"),this.convertCentsString(a,a.length,"r")},convertCentsString(e,t,a="/"){for(let n=0;n<t;n++)if(e[n].includes(a)){let t=e[n].split(a);e[n]=parseInt(1200*Math.log2(parseInt(t[0])/parseInt(t[1])))}else e[n]=parseInt(e[n]);this.sendCents(e)},sendCents(e){if(!this.device)return;let t=[240,11,20,13,1,247];this.device.send(t),console.log(t);let a=[];for(const o of e){a=[240,11,20,13,1];for(let e=0;e<Math.floor(o/127);e++)a.push(127);o%127!==0&&a.push(o%127),a.push(247),this.device.send(a),console.log(a),ce(1e3)}let n=[240,11,20,13,127,247];this.device.send(n),console.log(n)}},data(){return{url:"",device:null}}};const Qa=(0,h.Z)(Ja,[["render",Ka]]);var Xa=Qa;const en=(0,i._)("h1",{class:"text-center"},"Biotron Update Page",-1);function tn(e,t,a,n,o,s){const l=(0,i.up)("DeviceSelector"),d=(0,i.up)("UpdateFirmwareComponent");return(0,i.wg)(),(0,i.iD)(i.HY,null,[en,(0,i.Wm)(l,{style:{display:"none"},"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),(0,i.Wm)(d,{repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])],64)}var an={components:{UpdateFirmwareComponent:ea,DeviceSelector:Wt},data(){return{device:null}},methods:{LoadFirmware:Jt}};const nn=(0,h.Z)(an,[["render",tn]]);var on=nn;const sn=(0,i._)("h1",{class:"text-center"},"Playtron change settings",-1),ln=["disabled"];function dn(e,t,a,n,o,s){const l=(0,i.up)("LoaderComponent"),d=(0,i.up)("DeviceSelector"),c=(0,i.up)("PatchSelector"),r=(0,i.up)("SliderCommand"),m=(0,i.up)("GroupOfCommands");return(0,i.wg)(),(0,i.iD)(i.HY,null,[this.is_loading?((0,i.wg)(),(0,i.j4)(l,{key:o.forceRerender})):(0,i.kq)("",!0),(0,i._)("div",null,[sn,(0,i.Wm)(d,{"regex-name":"",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),((0,i.wg)(),(0,i.j4)(c,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,i.Wm)(m,{"name-of-group":"Filter"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{"command-label":"Filter Last",key:this.forceRerender,"command-object":this.commands_data.filter_filtered_last_dep},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{"command-label":"No Filter Last",key:this.forceRerender,"command-object":this.commands_data.filter_no_filtered_last_dep},null,8,["command-object"])),((0,i.wg)(),(0,i.j4)(r,{"command-label":"No Filter Current",key:this.forceRerender,"command-object":this.commands_data.filter_no_filtered_current_dep},null,8,["command-object"]))])),description:(0,i.w5)((()=>[(0,i.Uk)(" Filter Vals - It is filter's coefficients, which are used to control filter's power. ")])),_:1}),(0,i.Wm)(m,{"name-of-group":"AdcVal"},{objects:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)(r,{"command-label":"Start Val",key:this.forceRerender,"command-object":this.commands_data.start_adc_val},null,8,["command-object"]))])),_:1})]),(0,i._)("button",{onMouseup:t[1]||(t[1]=(...e)=>s.change_data_loader&&s.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1",style:{width:"70%"}},"Send",40,ln)],64)}let cn=(e,t)=>{for(let a=0;a<8;a++)t*=10,e.push(Math.trunc(t)),t-=Math.trunc(t)},rn=new Map(Object.entries({filter_filtered_last_dep:new le({name:"filter_filtered_last_dep",number_command:0,default_value:.9126977,max_value:1,step:1e-8,custom_fold:cn}),filter_no_filtered_current_dep:new le({name:"filter_no_filtered_current_dep",number_command:1,default_value:.05365115,max_value:1,step:1e-8,custom_fold:cn}),filter_no_filtered_last_dep:new le({name:"filter_no_filtered_last_dep",number_command:2,default_value:.03365115,max_value:1,step:1e-8,custom_fold:cn}),start_adc_val:new le({name:"start_adc_val",number_command:3,default_value:400,max_value:4096,custom_fold:(e,t)=>{for(let a of t.toString().split("").map(Number))e.push(a)}})}));class mn extends ue{constructor(){super(rn),(0,se.Z)(this,"DB_NAME","PlaytronDB"),(0,se.Z)(this,"STORE_NAME","Playtron_Patches"),(0,se.Z)(this,"VERSION",2)}}var un={components:{GroupOfCommands:Ce,SliderCommand:$e,LoaderComponent:ma,PatchSelector:Nt,DeviceSelector:Wt},props:{id:{type:String,required:!0}},watch:{},methods:{async change_data_loader(){this.device&&(ce(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),ce(100);let e=[];for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device,[20,13]),ce(100));ce(100),this.device.send([240,11,20,13,126,247])}},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"biotron-preset.txt",{type:"text/plain;charset=utf-8"});(0,re.p)(a,"biotron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)}},data(){return{patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(rn),forceRerender:0,patchRerender:0}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new mn,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const hn=(0,h.Z)(un,[["render",dn]]);var pn=hn;const _n=[{path:"/"},{path:"/biotron",component:pa,props:{id:"BiotronWebMidiId_2"}},{path:"/biotron/update",component:on},{path:"/touchme",component:Za,props:{id:"TouchmeWebMidiId_2"}},{path:"/playtron",component:pn,props:{id:"PlaytronWebMidiId"}},{path:"/scala",component:Xa}],vn=(0,o.p7)({history:(0,o.r5)(),linkActiveClass:"active",routes:_n});var gn=a(7846);(0,n.ri)(_).use(vn).use(gn).mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,i){if(!n){var s=1/0;for(r=0;r<e.length;r++){n=e[r][0],o=e[r][1],i=e[r][2];for(var l=!0,d=0;d<n.length;d++)(!1&i||s>=i)&&Object.keys(a.O).every((function(e){return a.O[e](n[d])}))?n.splice(d--,1):(l=!1,i<s&&(s=i));if(l){e.splice(r--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var r=e.length;r>0&&e[r-1][2]>i;r--)e[r]=e[r-1];e[r]=[n,o,i]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,s=n[0],l=n[1],d=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(d)var r=d(a)}for(t&&t(n);c<s.length;c++)i=s[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(r)},n=self["webpackChunkweb_midi_playtronica"]=self["webpackChunkweb_midi_playtronica"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(9273)}));n=a.O(n)})();
//# sourceMappingURL=app.9bbaa4c8.js.map