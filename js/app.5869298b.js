(function(){"use strict";var e={8446:function(e,t,a){var n=a(9963),o=a(2201),s=a(6252);const i={class:"d-flex justify-content-center"},d={class:"nav nav-pills"},c={class:"nav-item"},l={class:"nav-item"},r={class:"nav-item"},m={class:"wrapper"},h={class:"m-2 content"},u={class:"bottom-panel"};function p(e,t,a,n,o,p){const g=(0,s.up)("router-link"),_=(0,s.up)("router-view"),b=(0,s.up)("SocialLinks");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("header",i,[(0,s._)("ul",d,[(0,s._)("li",c,["/biotron"===this.url?((0,s.wg)(),(0,s.j4)(g,{key:0,to:"/biotron",onClick:this.update,class:"nav-link active"},{default:(0,s.w5)((()=>[(0,s.Uk)("Biotron")])),_:1},8,["onClick"])):((0,s.wg)(),(0,s.j4)(g,{key:1,to:"/biotron",onClick:this.update,class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Biotron")])),_:1},8,["onClick"]))]),(0,s._)("li",l,["/touchme"===this.url?((0,s.wg)(),(0,s.j4)(g,{key:0,onClick:this.update,to:"/touchme",class:"nav-link active"},{default:(0,s.w5)((()=>[(0,s.Uk)("TouchMe")])),_:1},8,["onClick"])):((0,s.wg)(),(0,s.j4)(g,{key:1,to:"/touchme",onClick:this.update,class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("TouchMe")])),_:1},8,["onClick"]))]),(0,s._)("li",r,["/playtron"===this.url?((0,s.wg)(),(0,s.j4)(g,{key:0,onClick:this.update,to:"/playtron",class:"nav-link active"},{default:(0,s.w5)((()=>[(0,s.Uk)("TouchMe")])),_:1},8,["onClick"])):((0,s.wg)(),(0,s.j4)(g,{key:1,to:"/playtron",onClick:this.update,class:"nav-link"},{default:(0,s.w5)((()=>[(0,s.Uk)("Playtron")])),_:1},8,["onClick"]))])])]),(0,s._)("div",m,[(0,s._)("div",h,[(0,s.Wm)(_)]),(0,s._)("footer",u,[(0,s.Wm)(b)])])],64)}var g=a(3577);const _={class:"social-links"},b=["href","title"],v={class:"sr-only"};function f(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",_,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.socialNetworks,(e=>((0,s.wg)(),(0,s.iD)("a",{key:e.name,href:e.url,title:e.name,target:"_blank",rel:"noopener noreferrer",class:"social-link"},[(0,s._)("i",{class:(0,g.C_)(e.iconClass)},null,2),(0,s._)("span",v,(0,g.zw)(e.name),1)],8,b)))),128))])}var y={name:"SocialLinks",data(){return{socialNetworks:[{name:"Facebook",url:"https://www.facebook.com/groups/492176784601023",iconClass:"fab fa-facebook-f"},{name:"Reddit",url:"https://www.reddit.com/r/playtronica/",iconClass:"fab fa-reddit"},{name:"Instagram",url:"https://www.instagram.com/playtronica/",iconClass:"fab fa-instagram"},{name:"YouTube",url:"https://www.youtube.com/channel/UCQbPfbsfg1Qn0rYUodylyZg",iconClass:"fab fa-youtube"},{name:"X",url:"https://x.com/playtronica",iconClass:"fab fa-square-x-twitter"},{name:"TikTok",url:"https://www.tiktok.com/@playtronica",iconClass:"fab fa-tiktok"}]}}},w=a(3744);const C=(0,w.Z)(y,[["render",f],["__scopeId","data-v-1687d1ca"]]);var j=C,D={name:"App",components:{SocialLinks:j},data(){return{url:String,forceRerender:0}},async mounted(){if(console.log("Hello! You`re curious, aren`t you?"),navigator.requestMIDIAccess)try{await navigator.requestMIDIAccess(),console.log("MIDI is supported!")}catch(e){console.error("Could not access MIDI devices:",e),window.alert("You have denied access to MIDI devices.")}else console.error("MIDI is not supported. Sending notification..."),window.alert("Only works on Chrome on desktop computer.")},methods:{update(){this.forceRerender++}}};const I=(0,w.Z)(D,[["render",p]]);var S=I,x=a(8877);const P=e=>((0,s.dD)("data-v-7abb9e8f"),e=e(),(0,s.Cn)(),e),k=P((()=>(0,s._)("h1",{class:"text-center"},"Biotron change settings",-1))),R=P((()=>(0,s._)("p",null,"BPM - how many notes from the plant will be generated per minute",-1))),M=P((()=>(0,s._)("p",null,"Note Off Percent - how many percent of the time the note will sound, where 100 is the full sound before the note changes, 50 is half the time the note is played",-1))),V=P((()=>(0,s._)("p",null,"Light Bpm - once every number of notes from the plant the note from the photoresistor will sound",-1))),O=P((()=>(0,s._)("p",null,"Plant Middle Note - center of notes",-1))),E=P((()=>(0,s._)("p",null,"Sensitivity (fib) - Fibonacci parameter responsible for the note distribution curve",-1))),N=P((()=>(0,s._)("p",null,"Smoothness - the smoothness of the notes played, where 0 is an instant change in notes, 99 is a smooth change (notes change over time)",-1))),L=P((()=>(0,s._)("p",null,"Scale - scale played from the device",-1))),B={class:"row"},T={class:"col"},A={class:"col"},W={key:0},U={key:0},F={key:1},H=P((()=>(0,s._)("p",null,"Plant - responsible for the notes generated by the plant",-1))),z={class:"row"},q={class:"col"},Z={class:"col"},G={key:0,class:"row"},$={key:0},Y={key:1},K=P((()=>(0,s._)("p",null,"Light - responsible for notes generated from the photoresistor",-1))),J=P((()=>(0,s._)("p",null,"Velocity - pressing force",-1))),Q=P((()=>(0,s._)("p",null,"Humanize - Velocity randomization at a controlled interval",-1))),X=P((()=>(0,s._)("p",null,"Mute - disable note generation from the channel",-1))),ee=P((()=>(0,s._)("p",null,"Same Note - notes that are played only when changing notes with a customizable step, where 1 - produces a note if the notes have changed by 1 note, 10 if there has been a shift by 10 notes",-1))),te=P((()=>(0,s._)("p",null,"Light Notes Range - setting the range of notes played from the photoresistor (lower and upper limits are set)",-1))),ae={class:"row"},ne={class:"col"},oe={class:"col"},se=P((()=>(0,s._)("p",null,"Ultra sensitivity - Increases the sensitivity of generation from a plant",-1))),ie=P((()=>(0,s._)("p",null,"Performance mode - Mode for better manual control of the device",-1))),de={class:"buttons_block"},ce=["disabled"],le=P((()=>(0,s._)("p",null,"Send - sending settings to the device",-1))),re=P((()=>(0,s._)("p",null,"Create Preset - saves settings to a file",-1))),me=P((()=>(0,s._)("p",null,"Drop Preset Here - you need to transfer the file there by drag drop, or by clicking on the button, select the settings file.",-1)));function he(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("SliderCommand"),m=(0,s.up)("GroupOfCommands"),h=(0,s.up)("SelectCommand"),u=(0,s.up)("SwitchComponent"),p=(0,s.up)("SliderRangeCommand"),g=(0,s.up)("UpdateFirmwareComponent"),_=(0,s.up)("FileDropArea");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),(0,s._)("div",null,[k,(0,s.Wm)(c,{"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,s.Wm)(m,{"name-of-group":"BPM"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{"command-label":"Plant Bpm",key:this.forceRerender,"command-object":this.commands_data.plantBpm,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(r,{"command-label":"Note Off Percent",key:this.forceRerender,"command-object":this.commands_data.noteOffPercent,"table-values":this.fractions_note_off,onInputChanged:this.sys_ex_changed,"table-values-reversed":""},null,8,["command-object","table-values","onInputChanged"])),((0,s.wg)(),(0,s.j4)(r,{"command-label":"Light Bpm",key:this.forceRerender,"command-object":this.commands_data.lightBpm,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(r,{"command-label":"Root Note",key:this.forceRerender,"command-object":this.commands_data.middle_plant_note,"table-values":this.root_note_id,onInputChanged:this.sys_ex_changed},null,8,["command-object","table-values","onInputChanged"]))])),description:(0,s.w5)((()=>[R,M,V,O])),_:1}),(0,s.Wm)(m,{"name-of-group":"Sensitivity (fib)"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{"command-label":"Note Distance",key:this.forceRerender,"command-object":this.commands_data.noteDistance,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(r,{"command-label":"First Value",key:this.forceRerender,"command-object":this.commands_data.firstValue,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[E])),_:1}),(0,s.Wm)(m,{"name-of-group":"Smoothness"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"command-object":this.commands_data.smoothness,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[N])),_:1}),(0,s.Wm)(m,{"name-of-group":"Scale"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":o.commands_data.scale,onInputChanged:this.sys_ex_changed},null,8,["list-of-variants","command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[L])),_:1}),(0,s.Wm)(m,{"name-of-group":"Velocity"},{objects:(0,s.w5)((()=>[(0,s.Wm)(m,{"name-of-group":"Plant"},{objects:(0,s.w5)((()=>[(0,s._)("div",B,[(0,s._)("div",T,[(0,s.Wm)(u,{id:"randomPlantVelSwitch","command-label":"Humanize","command-object":this.commands_data.randomPlantVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])]),(0,s._)("div",A,[(0,s.Wm)(u,{id:"plantVelDis","command-label":"Mute","command-object":o.commands_data.plant_no_velocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),o.commands_data.plant_no_velocity.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",W,[this.commands_data.randomPlantVelocity.value?((0,s.wg)(),(0,s.iD)("div",F,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"max-command-object":o.commands_data.maxPlantVelocity,"min-command-object":o.commands_data.minPlantVelocity,onInputChanged:this.sys_ex_changed},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",U,[((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.maxPlantVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))]))]))])),description:(0,s.w5)((()=>[H])),_:1}),(0,s.Wm)(m,{"name-of-group":"Light"},{objects:(0,s.w5)((()=>[(0,s._)("div",z,[(0,s._)("div",q,[(0,s.Wm)(u,{id:"randomLightVelSwitch","command-label":"Humanize","command-object":this.commands_data.randomLightVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])]),(0,s._)("div",Z,[(0,s.Wm)(u,{id:"lightVelDis","command-label":"Mute","command-object":o.commands_data.light_no_velocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),o.commands_data.light_no_velocity.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",G,[this.commands_data.randomLightVelocity.value?((0,s.wg)(),(0,s.iD)("div",Y,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"max-command-object":o.commands_data.maxLightVelocity,"min-command-object":o.commands_data.minLightVelocity,onInputChanged:this.sys_ex_changed},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",$,[((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.maxLightVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))]))]))])),description:(0,s.w5)((()=>[K])),_:1})])),description:(0,s.w5)((()=>[J,Q,X])),_:1}),(0,s.Wm)(m,{"name-of-group":"Same Note"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.same_note_plant,"command-label":"Plant",onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"command-object":o.commands_data.same_note_light,"command-label":"Light",onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[ee])),_:1}),(0,s.Wm)(m,{"name-of-group":"Light Notes Range"},{objects:(0,s.w5)((()=>[(0,s.Wm)(u,{id:"light_pitch_mode","command-label":"Pitch Bend","command-object":this.commands_data.light_pitch_mode,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]),this.commands_data.light_pitch_mode.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"command-object":this.commands_data.range_light_note,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[te])),_:1}),(0,s.Wm)(m,{"name-of-group":"Extra"},{objects:(0,s.w5)((()=>[(0,s._)("div",ae,[(0,s._)("div",ne,[((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-label":"Ultra sensitivity","command-object":o.commands_data.randomness,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))]),(0,s._)("div",oe,[((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-label":"Performance mode","command-object":o.commands_data.performance,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])])])),description:(0,s.w5)((()=>[se,ie])),_:1}),(0,s._)("div",de,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1 w-75"},"Send",40,ce),(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary mb-1 w-75"},"Create Preset"),(0,s.Wm)(g,{repo:"Playtronica/biotron-firmware",device:this.device,class:"mb-1 w-75"},null,8,["device"]),(0,s.Wm)(_,{class:"mb-1 w-75",name:"Drop Preset Here",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(m,null,{description:(0,s.w5)((()=>[le,re,me])),_:1})],64)}a(7658);var ue=a(7327);class pe{set_value(e){this.value=e}constructor({name:e=null,number_command:t=0,min_value:a=0,max_value:n=126,step:o=1,sendable:s=!0,custom_fold:i=null}){if((0,ue.Z)(this,"flag_device",[20,13]),(0,ue.Z)(this,"name",void 0),(0,ue.Z)(this,"number_command",void 0),(0,ue.Z)(this,"value",void 0),(0,ue.Z)(this,"min_value",void 0),(0,ue.Z)(this,"max_value",void 0),(0,ue.Z)(this,"step",void 0),(0,ue.Z)(this,"sendable",void 0),(0,ue.Z)(this,"fold_function",void 0),null===t)throw"Number Command is null";this.name=null===e?`Command number ${t}`:e,this.number_command=t,this.value=a,this.min_value=a,this.max_value=n,this.step=o,this.sendable=s,this.fold_function=null===i?(e,t)=>{e.push(t%127)}:i}toString(){return`{"name": "${this.name}", "value": ${this.value}, "params": {\n            "number_command": ${this.number_command},\n            "min_value": ${this.min_value},\n            "max_value": ${this.max_value},\n            "step": ${this.step},\n            "default_value": ${this.default_value}\n        }}`}toShortDict(){return{name:this.name,value:this.value}}check_params(){return!(this.min_value>this.max_value)&&(!(this.value<this.min_value)&&this.value<=this.max_value)}sendToMidi(e,t=this.flag_device){if(!this.sendable)return;let a=[240];this.check_params()&&(a=a.concat(t).concat(this.number_command),this.fold_function(a,this.value),a.push(247),console.log(a),e.send(a))}}function ge(e){e&&(e.send([240,11,127,247]),_e(100),e.send([240,11,20,13,127,247]))}function _e(e){const t=Date.now();let a=null;do{a=Date.now()}while(a-t<e)}var be=a(5702),ve=a(2262);class fe{constructor(e){(0,ue.Z)(this,"DB_NAME","Playtronica_WebMIDI_db"),(0,ue.Z)(this,"STORE_NAME","Biotron_Patches"),(0,ue.Z)(this,"VERSION",7);const t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB;t||console.log("IndexedDB could not be found in this browser."),this.commands=e}async openDB(){return new Promise((e=>{const t=indexedDB.open(this.DB_NAME,this.VERSION);let a=this;t.onerror=function(t){console.error("An error occurred with IndexedDB"),console.error(t),e(!1)},t.onupgradeneeded=function(){const n=t.result;n.objectStoreNames.contains(a.STORE_NAME)&&n.deleteObjectStore(a.STORE_NAME),n.createObjectStore(a.STORE_NAME,{keyPath:"id",autoIncrement:!0}),e(!0)},t.onsuccess=function(){console.log("Database opened successfully"),t.result.close(),e(!1)}}))}createPatch(e,t){const a=indexedDB.open(this.DB_NAME,this.VERSION);let n=this;a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const o=a.result,s=o.transaction(n.STORE_NAME,"readwrite"),i=s.objectStore(n.STORE_NAME);t?i.put({name:t,editable:!0,saved:!0,data:e}):i.put({name:"Unsaved Patch",editable:!0,saved:!1,data:e}),s.oncomplete=function(){o.close()}}}createNoEditablePatch(e,t){const a=indexedDB.open(this.DB_NAME,this.VERSION);let n=this;a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const o=a.result,s=o.transaction(n.STORE_NAME,"readwrite"),i=s.objectStore(n.STORE_NAME);i.put({name:t,editable:!1,saved:!0,data:e}),s.oncomplete=function(){o.close()}}}async getPatch(e){let t=this;return new Promise((a=>{const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,s=o.transaction(t.STORE_NAME,"readonly"),i=s.objectStore(t.STORE_NAME);let d;d=e?i.get(parseInt(e)):i.getAll(),d.onsuccess=function(){a(d.result)},s.oncomplete=function(){o.close()}}}))}async getUnsavedPatch(){let e=await this.getPatch();return e.at(-1).saved?(this.createPatch((0,ve.IU)(this.DEFAULT)),e=await this.getPatch(),e.at(-1).id):e.at(-1).id}deletePatch(e){if(!e)return;let t=this;const a=indexedDB.open(this.DB_NAME,this.VERSION);a.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},a.onupgradeneeded=function(){console.log("Update Page")},a.onsuccess=function(){const n=a.result,o=n.transaction(t.STORE_NAME,"readwrite"),s=o.objectStore(t.STORE_NAME);let i=s.delete(e);i.onsuccess=function(){console.log("Patch deleted")},o.oncomplete=function(){n.close()}}}updatePatch(e,t){if(!e||!t)return;let a=this;const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,s=o.transaction(a.STORE_NAME,"readwrite"),i=s.objectStore(a.STORE_NAME);let d;d=e?i.get(parseInt(e)):i.getAll(),d.onsuccess=function(){d.result.data=t,i.put(d.result)},s.oncomplete=function(){o.close()}}}savePatch(e,t){if(!e||!t)return;let a=this;const n=indexedDB.open(this.DB_NAME,this.VERSION);n.onerror=function(e){console.error("An error occurred with IndexedDB"),console.error(e)},n.onupgradeneeded=function(){console.log("Update Page")},n.onsuccess=function(){const o=n.result,s=o.transaction(a.STORE_NAME,"readwrite"),i=s.objectStore(a.STORE_NAME);let d;d=e?i.get(parseInt(e)):i.getAll(),d.onsuccess=function(){d.result.name=t,d.result.saved=!0,i.put(d.result)},s.oncomplete=function(){o.close()}}}}let ye=new Map(Object.entries({plantBpm:new pe({name:"plantBpm",number_command:0,max_value:1e3,sendable:!0,custom_fold:(e,t)=>{for(let a=0;a<Math.floor(t/127);a++)e.push(127);e.push(t%127)}}),lightBpm:new pe({name:"lightBpm",number_command:9,max_value:30}),noteOffPercent:new pe({name:"noteOffPercent",number_command:12,max_value:100}),noteDistance:new pe({name:"noteDistance",number_command:1,max_value:100}),firstValue:new pe({name:"firstValue",number_command:2,max_value:100}),smoothness:new pe({name:"smoothness",number_command:3,max_value:99}),scale:new pe({name:"scale",number_command:4}),minPlantVelocity:new pe({name:"minPlantVelocity",number_command:15}),maxPlantVelocity:new pe({name:"maxPlantVelocity",number_command:5}),minLightVelocity:new pe({name:"minLightVelocity",number_command:17}),maxLightVelocity:new pe({name:"maxLightVelocity",number_command:6}),randomness:new pe({name:"randomness",number_command:10}),same_note_plant:new pe({name:"same_note_plant",number_command:11,max_value:10}),same_note_light:new pe({name:"same_note_light",number_command:24,max_value:10}),range_light_note:new pe({name:"range_light_note",number_command:13,max_value:36}),light_pitch_mode:new pe({name:"light_pitch_mode",number_command:19,sendable:!0}),plant_no_velocity:new pe({name:"plant_no_velocity",number_command:22}),light_no_velocity:new pe({name:"light_no_velocity",number_command:23}),randomPlantVelocity:new pe({name:"randomPlantVelocity",number_command:16}),randomLightVelocity:new pe({name:"randomLightVelocity",number_command:18}),performance:new pe({name:"performance",number_command:21}),middle_plant_note:new pe({name:"middle_plant_note",number_command:25,min_value:60,max_value:72}),plant_midi_channel:new pe({name:"plant_midi_channel",number_command:[127,0],max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}}),light_midi_channel:new pe({name:"light_midi_channel",number_command:[127,1],max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}})}));const we={plantBpm:404,lightBpm:8,noteOffPercent:1,noteDistance:50,firstValue:10,smoothness:0,scale:3,minPlantVelocity:0,maxPlantVelocity:97,minLightVelocity:0,maxLightVelocity:68,randomness:!0,same_note_plant:0,same_note_light:0,range_light_note:12,light_pitch_mode:0,plant_no_velocity:0,light_no_velocity:0,randomPlantVelocity:!0,randomLightVelocity:!0,performance:0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2},Ce={plantBpm:404,lightBpm:2,noteOffPercent:2,noteDistance:50,firstValue:10,smoothness:0,scale:6,minPlantVelocity:8,maxPlantVelocity:97,minLightVelocity:0,maxLightVelocity:54,randomness:!1,same_note_plant:1,same_note_light:0,range_light_note:18,light_pitch_mode:!1,plant_no_velocity:0,light_no_velocity:!0,randomPlantVelocity:!0,randomLightVelocity:!0,performance:!0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2},je={plantBpm:404,lightBpm:2,noteOffPercent:1,noteDistance:50,firstValue:10,smoothness:0,scale:5,minPlantVelocity:44,maxPlantVelocity:97,minLightVelocity:0,maxLightVelocity:54,randomness:!1,same_note_plant:0,same_note_light:0,range_light_note:18,light_pitch_mode:!1,plant_no_velocity:0,light_no_velocity:0,randomPlantVelocity:!0,randomLightVelocity:!0,performance:!0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2},De={plantBpm:462,lightBpm:4,noteOffPercent:4,noteDistance:50,firstValue:10,smoothness:0,scale:4,minPlantVelocity:8,maxPlantVelocity:98,minLightVelocity:74,maxLightVelocity:75,randomness:0,same_note_plant:1,same_note_light:0,range_light_note:12,light_pitch_mode:0,plant_no_velocity:0,light_no_velocity:!0,randomPlantVelocity:!0,randomLightVelocity:0,performance:!0,middle_plant_note:60,plant_midi_channel:1,light_midi_channel:2};class Ie extends fe{constructor(){super(ye),(0,ue.Z)(this,"DB_NAME","BiotronDB"),(0,ue.Z)(this,"STORE_NAME","Biotron_Patches"),(0,ue.Z)(this,"VERSION",8),this.openDB().then((e=>{e&&(this.createNoEditablePatch(De,"Mixolyd (Default)"),this.createNoEditablePatch(we,"Fast role"),this.createNoEditablePatch(Ce,"The Performer mode"),this.createNoEditablePatch(je,"In Discussion"))}))}}function Se(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",{class:"fileDropArea",onClick:t[1]||(t[1]=(...e)=>this.dropAreaClick&&this.dropAreaClick(...e)),onDragover:t[2]||(t[2]=e=>e.preventDefault()),onDrop:t[3]||(t[3]=e=>i.dropAreaDrop(e))},[(0,s._)("input",{type:"file",id:"load_preset",style:{display:"none"},onChange:t[0]||(t[0]=e=>i.loadPresetChanged(e))},null,32),(0,s._)("p",null,(0,g.zw)(this.name),1)],32)}var xe={methods:{dropAreaClick(){document.getElementById("load_preset").click()},dropAreaDrop(e){e.preventDefault();let t=e.dataTransfer.files[0],a=new FileReader,n=this;a.onload=function(e){n.$emit("get_drop",e.target.result)},"text/plain"!==t.type&&".scl"!==t.name.substring(t.name.lastIndexOf("."))||a.readAsText(t)},loadPresetChanged(e){let t=e.srcElement.files[0],a=new FileReader,n=this;a.onload=function(e){n.$emit("get_drop",e.target.result)},"text/plain"===t.type&&(a.readAsText(t),document.getElementById("load_preset").value="")}},props:{name:{type:String,default:"Drop preset here"}}};const Pe=(0,w.Z)(xe,[["render",Se],["__scopeId","data-v-b6299ce2"]]);var ke=Pe;const Re={class:"settings_elem"},Me={key:0},Ve={key:1,class:"description_elem"};function Oe(e,t,a,n,o,i){const d=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Re,[a.nameOfGroup?((0,s.wg)(),(0,s.iD)("h2",Me,[(0,s._)("label",null,[(0,s.Uk)((0,g.zw)(this.nameOfGroup)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(d,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),(0,s.WI)(e.$slots,"objects",{},void 0,!0),this.$slots.description?((0,s.wg)(),(0,s.iD)("div",Ve,[(0,s.WI)(e.$slots,"description",{},void 0,!0)])):(0,s.kq)("",!0)])}const Ee=["title"];function Ne(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)("div",{class:"fas fa-info-circle",style:{color:"#0d6efd"},"data-bs-toggle":"tooltip","data-bs-placement":"right","data-bs-html":"true",title:a.text,disabled:""},null,8,Ee)}var Le={props:{text:{type:String,default:"IS NOT IMPLEMENTED"}},mounted(){new x.u(document.body,{selector:"[data-bs-toggle='tooltip']"})}};const Be=(0,w.Z)(Le,[["render",Ne]]);var Te=Be,Ae={name:"GroupOfCommands",components:{HintComponent:Te},props:{nameOfGroup:{default:"",type:String},description:{require:!1,type:String}},data(){return{}}};const We=(0,w.Z)(Ae,[["render",Oe],["__scopeId","data-v-040818dc"]]);var Ue=We;const Fe=e=>((0,s.dD)("data-v-270abf48"),e=e(),(0,s.Cn)(),e),He={class:"flex-row"},ze={class:"switch"},qe=["checked"],Ze=Fe((()=>(0,s._)("span",{class:"slider round"},null,-1)));function Ge(e,t,a,n,o,i){const d=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",He,[(0,s._)("div",null,[(0,s._)("label",null,[(0,s.Uk)((0,g.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(d,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)])]),(0,s._)("div",null,[(0,s._)("label",ze,[(0,s._)("input",{id:"checkbox_input",type:"checkbox",checked:a.commandObject.value,onClick:t[0]||(t[0]=e=>a.commandObject.set_value(e.target.checked)),onChange:t[1]||(t[1]=(...e)=>this.changed&&this.changed(...e))},null,40,qe),Ze])])])}var $e={name:"SwitchComponent",components:{HintComponent:Te},props:{commandObject:{type:pe},commandLabel:{type:String},description:{type:String,required:!1}},emits:["InputChanged"],methods:{changed(){this.$emit("InputChanged",this.commandObject)}}};const Ye=(0,w.Z)($e,[["render",Ge],["__scopeId","data-v-270abf48"]]);var Ke=Ye;const Je={class:"row m-2"},Qe={key:0},Xe=["value"],et={key:1},tt=["min","max"],at=["min","max","step"];function nt(e,t,a,o,i,d){const c=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Je,[(0,s._)("label",null,[(0,s.Uk)((0,g.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),this.tableValues?((0,s.wg)(),(0,s.iD)("div",Qe,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.rawValue=e),id:"scale",class:"form-control",onChange:t[1]||(t[1]=(...e)=>this.changed&&this.changed(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.tableTranslate,((e,t)=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,g.zw)(this.tableValues[parseInt(e)]),9,Xe)))),128))],544),[[n.bM,this.rawValue]])])):((0,s.wg)(),(0,s.iD)("div",et,[(0,s.wy)((0,s._)("input",{type:"number",id:"value_input",class:"form-control",style:{"padding-left":"1vw"},"onUpdate:modelValue":t[2]||(t[2]=e=>this.rawValue=e),min:this.minValue,max:this.maxValue,onChange:t[3]||(t[3]=e=>this.changed(e))},null,40,tt),[[n.nr,this.rawValue]])])),this.slider_active?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:2,type:"range",id:"range_input",class:"settings_input","onUpdate:modelValue":t[4]||(t[4]=e=>this.rawValue=e),min:this.minValue,max:this.maxValue,step:this.commandObject.step,onChange:t[5]||(t[5]=e=>this.changed(e))},null,40,at)),[[n.nr,this.rawValue]]):(0,s.kq)("",!0)])}var ot={components:{HintComponent:Te},props:{commandLabel:{default:"",type:String},commandObject:{required:!0,type:pe},tableValues:{required:!1,type:Object},tableValuesReversed:{type:Boolean},slider_active:{type:Boolean,default:!0},description:{type:String,required:!1}},emits:["InputChanged"],data(){return{rawValue:-1,maxValue:0,minValue:0,tableTranslate:null}},methods:{checkLimit(){this.rawValue>this.maxValue&&(this.rawValue=this.maxValue),this.rawValue<this.minValue&&(this.rawValue=this.minValue)},changed(e){this.checkLimit(),void 0!==this.tableValues?this.commandObject.set_value(parseInt(this.tableTranslate[parseInt(e.target.value)])):this.commandObject.set_value(parseInt(e.target.value)),this.$emit("InputChanged",this.commandObject)}},created(){if(void 0!==this.tableValues){this.minValue=0;let e=(0,ve.IU)(this.tableValues);this.maxValue=Object.keys(e).length-1,this.tableTranslate=Object.keys(e),this.tableValuesReversed&&(this.tableTranslate=this.tableTranslate.reverse());for(let t=0;t<this.tableTranslate.length;t++)parseInt(this.tableTranslate[t])===this.commandObject.value&&(this.rawValue=t);-1===this.rawValue&&(this.rawValue=0)}else this.rawValue=this.commandObject.value,this.maxValue=this.commandObject.max_value,this.minValue=this.commandObject.min_value}};const st=(0,w.Z)(ot,[["render",nt],["__scopeId","data-v-5c170bb9"]]);var it=st;const dt={class:"row m-2"},ct={class:"row",style:{"margin-bottom":"10px"}},lt={class:"col"},rt=["min","max"],mt={class:"col"},ht=["min","max"],ut={class:"row"};function pt(e,t,a,o,i,d){const c=(0,s.up)("HintComponent"),l=(0,s.up)("Slider");return(0,s.wg)(),(0,s.iD)("div",dt,[(0,s._)("label",null,[(0,s.Uk)((0,g.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),(0,s._)("div",ct,[(0,s._)("div",lt,[(0,s.wy)((0,s._)("input",{type:"number",id:"value_input_min",class:"form-control",onChange:t[0]||(t[0]=(...e)=>this.changed&&this.changed(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>this.values[0]=e),min:this.minCommandObject.min_value,max:this.minCommandObject.max_value},null,40,rt),[[n.nr,this.values[0]]])]),(0,s.Uk)(" - "),(0,s._)("div",mt,[(0,s.wy)((0,s._)("input",{type:"number",id:"value_input_max",class:"form-control",onChange:t[2]||(t[2]=(...e)=>this.changed&&this.changed(...e)),"onUpdate:modelValue":t[3]||(t[3]=e=>this.values[1]=e),min:this.minCommandObject.min_value,max:this.maxCommandObject.max_value},null,40,ht),[[n.nr,this.values[1]]])])]),(0,s._)("div",ut,[(0,s.Wm)(l,{modelValue:i.values,"onUpdate:modelValue":t[4]||(t[4]=e=>i.values=e),class:"slider-blue",tooltips:!1,max:this.maxCommandObject.max_value,min:this.minCommandObject.min_value,step:this.minCommandObject.step,lazy:!1,onChange:this.changed},null,8,["modelValue","max","min","step","onChange"])])])}var gt=a(1297),_t={components:{HintComponent:Te,Slider:gt.Z},emits:["input-changed"],props:{commandLabel:{default:"",type:String},minCommandObject:{required:!0,type:pe},maxCommandObject:{required:!0,type:pe},description:{type:String,required:!1}},data(){return{minValue:0,maxValue:0,values:[0,0]}},methods:{changed(){this.minCommandObject.set_value(this.values[0]),this.maxCommandObject.set_value(this.values[1]),this.$emit("input-changed",this.minCommandObject),_e(1),this.$emit("input-changed",this.maxCommandObject)}},created(){this.minValue=this.minCommandObject.value,this.maxValue=this.maxCommandObject.value,this.values=[this.minCommandObject.value,this.maxCommandObject.value],this.minValue>this.maxValue&&(this.minValue=this.maxValue)}};const bt=(0,w.Z)(_t,[["render",pt],["__scopeId","data-v-5017f510"]]);var vt=bt;const ft={class:"row m-2"},yt=["value"];function wt(e,t,a,o,i,d){const c=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",ft,[(0,s._)("label",null,[(0,s.Uk)((0,g.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.Value=e),id:"scale",class:"form-control",onChange:t[1]||(t[1]=(...e)=>d.changed&&d.changed(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.listOfVariants,((e,t)=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t},(0,g.zw)(e),9,yt)))),128))],544),[[n.bM,this.Value]])])}var Ct={components:{HintComponent:Te},emits:["InputChanged"],props:{commandLabel:{default:"",type:String},listOfVariants:{default:{}},commandObject:{required:!0,type:pe},description:{type:String,required:!1}},data(){return{Value:0}},methods:{changed(){this.$emit("InputChanged",this.commandObject)}},watch:{Value(){this.commandObject.set_value(this.Value)}},mounted(){this.Value=this.commandObject.value}};const jt=(0,w.Z)(Ct,[["render",wt]]);var Dt=jt;const It={class:"mb-3 m-0 w-100"},St={class:"d-flex"},xt={class:"form-floating flex-grow-1 me-2"},Pt=["value"],kt={for:"device"},Rt=["data-bs-target"],Mt={class:"modal fade",id:"saveModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Vt={class:"modal-dialog"},Ot={class:"modal-content"},Et=(0,s._)("div",{class:"modal-header"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},"Save Patch"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cancel"})],-1),Nt={class:"modal-body"},Lt={class:"mb-3"},Bt=(0,s._)("label",{for:"recipient-name",class:"col-form-label"},"Patch Name",-1),Tt={class:"modal-footer"},At=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1),Wt={class:"modal fade",id:"deleteModel",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ut={class:"modal-dialog"},Ft={class:"modal-content"},Ht=(0,s.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Delete Patch</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancel"></button></div><div class="modal-body"><div class="mb-3"> Do you really want to delete this patch? </div></div>',2),zt={class:"modal-footer"},qt=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1);function Zt(e,t,a,o,i,d){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",It,[(0,s._)("div",St,[(0,s._)("div",xt,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.id=e),class:"form-control",onChange:t[1]||(t[1]=(...e)=>this.patchChanged&&this.patchChanged(...e))},[(0,s.Uk)("--\x3e "),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.patches,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id},(0,g.zw)(e.name),9,Pt)))),128))],544),[[n.bM,this.id]]),(0,s._)("label",kt,(0,g.zw)(this.text_label),1)]),(0,s._)("button",{class:(0,g.C_)(["btn",{"btn-outline-primary":"Save"===this.button_state,"btn-outline-danger":"Delete"===this.button_state}]),type:"button","data-bs-toggle":"modal",onClick:t[2]||(t[2]=(...e)=>this.modelOpen&&this.modelOpen(...e)),"data-bs-target":"Save"===this.button_state?"#saveModal":"#deleteModel",style:(0,g.j5)({display:i.active_button_enabled?"block":"none"})},(0,g.zw)(this.button_state),15,Rt)])]),(0,s._)("div",Mt,[(0,s._)("div",Vt,[(0,s._)("div",Ot,[Et,(0,s._)("div",Nt,[(0,s._)("div",Lt,[Bt,(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{type:"text",class:"form-control",id:"patchName","onUpdate:modelValue":t[3]||(t[3]=e=>this.patchName=e),key:this.forceRerender,autocomplete:"off","data-autofocus":""})),[[n.nr,this.patchName]])])]),(0,s._)("div",Tt,[At,(0,s._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[4]||(t[4]=(...e)=>this.savePatch&&this.savePatch(...e))},"Save")])])])]),(0,s._)("div",Wt,[(0,s._)("div",Ut,[(0,s._)("div",Ft,[Ht,(0,s._)("div",zt,[qt,(0,s._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...e)=>this.deletePatch&&this.deletePatch(...e))},"Delete")])])])])],64)}var Gt={props:{patches:{type:Array},page_id:{type:String,required:!0},text_label:{default:"Presets",type:String}},name:"PatchSelector",data(){return{id:0,active_button_enabled:!0,button_state:"Save",patchName:"",forceRerender:0}},watch:{},methods:{patchChanged(){if(console.log(),localStorage.setItem(this.page_id,this.id),!this.patches)return;let e;for(let t of this.patches)if(this.id===t.id){e=t;break}e&&(this.active_button_enabled=e.editable,this.button_state=e.saved?"Delete":"Save",document.dispatchEvent(new CustomEvent("PatchChanged")))},savePatch(){document.dispatchEvent(new CustomEvent("PatchSave",{detail:this.patchName}))},deletePatch(){document.dispatchEvent(new CustomEvent("PatchDelete"))},modelOpen(){this.patchName=""}},mounted(){if(this.id=parseInt(localStorage.getItem(this.page_id)),!this.patches)return;let e;for(let t of this.patches)if(this.id===t.id){e=t;break}e&&(this.active_button_enabled=e.editable,this.button_state=e.saved?"Delete":"Save",document.addEventListener("shown.bs.modal",(()=>{"Save"===this.button_state&&document.getElementById("patchName").focus()})))}};const $t=(0,w.Z)(Gt,[["render",Zt]]);var Yt=$t;const Kt={class:"form-floating mb-3"},Jt=["value"],Qt={for:"device"};function Xt(e,t,a,o,i,d){return(0,s.wg)(),(0,s.iD)("div",Kt,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.currentMidiNum=e),class:"form-control"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.midiOut,((e,a)=>((0,s.wg)(),(0,s.iD)("option",{key:a,value:a,onChange:t[0]||(t[0]=(...e)=>this.deviceChanged&&this.deviceChanged(...e))},(0,g.zw)(e.name)+" "+(0,g.zw)(this.versions[a]),41,Jt)))),128))],512),[[n.bM,i.currentMidiNum]]),(0,s._)("label",Qt,(0,g.zw)(this.text_label),1)])}var ea={props:{regexName:{default:".*",type:String},checkVersionsFlag:{default:!1,type:Boolean},text_label:{default:"Select device",type:String}},name:"DeviceSelector",data(){return{midiIn:{},midiOut:{},versions:{},currentMidiNum:0,updateTimeout:null}},methods:{midiReady(e){e.onstatechange=e=>{this.initDevices(e.target)},this.initDevices(e)},initDevices(e){this.midiIn={},this.midiOut={},this.versions={};const t=e.inputs.values();for(let o=t.next();o&&!o.done;o=t.next())o.value.name.match(this.regexName)&&(this.midiIn[o.id]=o.value),o.value.onmidimessage=e=>this.handleMidiMessage(e);let a=0;const n=e.outputs.values();for(let o=n.next();o&&!o.done;o=n.next())o.value.name.match(this.regexName)&&(this.midiOut[a]=o.value,o.value.send([]),_e(100),a++);if(this.deviceChanged(),this.checkVersionsFlag)for(const[o,s]of Object.entries(this.midiOut))setTimeout((()=>{s.send([240,20,13,126,o,247]),_e(100)}),3e3)},handleMidiMessage(e){const[t,a,n,o,s,i,d,c]=e.data;240===t&&247===c&&11===a&&126===n&&8===e.data.length&&(this.versions[o]=`v${s}.${i}.${d}`)},deviceChanged(){this.$emit("device_changed",this.midiOut[this.currentMidiNum])}},mounted(){navigator.requestMIDIAccess({sysex:!0}).then((e=>this.midiReady(e)),(e=>console.log("Something went wrong",e)))}};const ta=(0,w.Z)(ea,[["render",Xt]]);var aa=ta;const na={class:"modal fade",id:"UpdateConf",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},oa={class:"modal-dialog modal-dialog-centered"},sa={class:"modal-content"},ia=(0,s.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Update Firmware</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><p> After clicking on &quot;Update&quot;, you will get a file with the .uf2 extension and the device will switch to boot mode. The device will be displayed as removable media (like a USB flash drive). You should transfer the resulting .uf2 file to the removable media that appeared. </p><h6 style="color:red;">ATTENTION</h6><p>The device won&#39;t work until you move the file.</p></div>',2),da={class:"modal-footer"},ca=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function la(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("button",{"data-bs-toggle":"modal","data-bs-target":"#UpdateConf",class:(0,g.C_)(["btn btn-primary",e.$attrs.class])},(0,g.zw)(a.text),3),(0,s._)("div",na,[(0,s._)("div",oa,[(0,s._)("div",sa,[ia,(0,s._)("div",da,[ca,(0,s._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=e=>i.LoadFirmware(this.repo,this.device))}," Update")])])])])],64)}function ra(e,t){fetch(`https://api.github.com/repos/${e}/releases/latest`,{headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"}}).then((e=>e.json())).then((e=>{console.log(e),window.location.replace(e.assets[0]["browser_download_url"])})),ge(t)}var ma={methods:{LoadFirmware:ra},props:{repo:{type:String},text:{type:String,default:"Update Firmware"},device:Object}};const ha=(0,w.Z)(ma,[["render",la]]);var ua=ha;const pa=e=>((0,s.dD)("data-v-ce1ea73a"),e=e(),(0,s.Cn)(),e),ga={id:"loader_div",style:{position:"fixed","z-index":"10",width:"100%",height:"100%","background-color":"rgba(59,54,54,0.4)",top:"0",left:"0"}},_a={class:"container text-center",style:{transform:"translate(0, 50vh)"}},ba={class:"row justify-content-center"},va=pa((()=>(0,s._)("h1",{style:{color:"#0d6efd","font-weight":"bold","text-shadow":"0px 0px 6px #fff"}}," Loading ",-1)));function fa(e,t,a,o,i,d){return(0,s.wg)(),(0,s.iD)("div",ga,[(0,s._)("div",_a,[(0,s._)("div",ba,[va,(0,s.wy)((0,s._)("div",{class:"lds-ring",style:(0,g.j5)({width:`${a.size}px`,height:`${a.size}px`,padding:"0px"})},[(0,s._)("div",{style:(0,g.j5)([i.spinnerStyle,d.animDiv1])},null,4),(0,s._)("div",{style:(0,g.j5)([i.spinnerStyle,d.animDiv2])},null,4),(0,s._)("div",{style:(0,g.j5)([i.spinnerStyle,d.animDiv3])},null,4),(0,s._)("div",{style:(0,g.j5)([i.spinnerStyle])},null,4)],4),[[n.F8,a.loading]])])])])}function ya(e){const t=new RegExp(/^\d*\.?\d+(s|ms)$/);return t.test(e)}function wa(e,t,a){const n={},o=t.match(/^\d*\.?\d+/)[0],s=t.match(/s|(ms)$/)[0],i=Math.round(1e3*o*a)/1e3;return n[e]=i+s,n}var Ca={name:"RingLoader",props:{loading:{type:Boolean,default:!0},size:{type:Number,default:55},color:{type:String,default:"#3083fa"},duration:{type:String,default:"1.2s",validator:ya}},data(){return{spinnerStyle:{borderWidth:.1*this.size+"px",borderColor:`${this.color} transparent transparent transparent`,animationDuration:this.duration}}},computed:{animDiv1(){return wa("animationDelay",this.duration,-.375)},animDiv2(){return wa("animationDelay",this.duration,-.25)},animDiv3(){return wa("animationDelay",this.duration,-.125)}}};const ja=(0,w.Z)(Ca,[["render",fa],["__scopeId","data-v-ce1ea73a"]]);var Da=ja,Ia={components:{LoaderComponent:Da,UpdateFirmwareComponent:ua,DeviceSelector:aa,PatchSelector:Yt,SelectCommand:Dt,SliderRangeCommand:vt,SliderCommand:it,SwitchComponent:Ke,GroupOfCommands:Ue,FileDropArea:ke},props:{id:{type:String,required:!0},test:{type:Boolean,default:!1}},methods:{async change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData(),_e(100),this.sendDataDeprecated()}.bind(this),10))},async sendDataDeprecated(){if(this.device){this.device.send([240,11,16,127,247]);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device,[11]),_e(100));this.device.send([240,11,126,247]),_e(100),this.commands_data.plantBpm.sendToMidi(this.device,[11])}},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),_e(100);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),_e(100));_e(100),this.device.send([240,11,20,13,126,247]),_e(100),this.commands_data.plantBpm.sendToMidi(this.device)}},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"biotron-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"biotron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(){await this.patchChanged(),this.forceRerender++,this.patchRerender++}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],root_note_id:{60:"C4",61:"C#4",62:"D4",63:"D#4",64:"E4",65:"F4",66:"F#4",67:"G4",68:"G#4",69:"A4",70:"A#4",71:"B4",72:"C5"},fractions_note_off:{64:"1/64",48:"1/48",32:"1/32",24:"1/24",16:"1/16",12:"1/12",8:"1/8",6:"1/6",4:"1/4",2:"1/2",1:"1"},device:null,forceRerender:0,patchRerender:0,db:{type:Ie},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(ye)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Ie,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const Sa=(0,w.Z)(Ia,[["render",he],["__scopeId","data-v-7abb9e8f"]]);var xa=Sa;const Pa=e=>((0,s.dD)("data-v-5fecffc7"),e=e(),(0,s.Cn)(),e),ka=Pa((()=>(0,s._)("h1",{class:"text-center"},"TouchMe change settings",-1))),Ra=Pa((()=>(0,s._)("p",null,"Scale - scale played from the device",-1))),Ma=Pa((()=>(0,s._)("p",null,"Key - Start Note in default range (Disabled when custom range is active)",-1))),Va={class:"row"},Oa={class:"col"},Ea={class:"col"},Na={key:0},La={key:0},Ba={key:1},Ta=Pa((()=>(0,s._)("p",null,"Velocity - pressing force",-1))),Aa=Pa((()=>(0,s._)("p",null,"Humanize - Velocity randomization at a controlled interval",-1))),Wa=Pa((()=>(0,s._)("p",null,"Mute - disable note generation from the channel",-1))),Ua={class:"row"},Fa={class:"col"},Ha={key:0},za=Pa((()=>(0,s._)("p",null,"Notes Range - Range of playable notes",-1))),qa={class:"buttons_block"},Za=["disabled"],Ga=Pa((()=>(0,s._)("p",null,"Send - sending settings to the device",-1))),$a=Pa((()=>(0,s._)("p",null,"Create Preset - saves settings to a file",-1))),Ya=Pa((()=>(0,s._)("p",null,"Drop Preset Here - you need to transfer the file there by drag drop, or by clicking on the button, select the settings file.",-1)));function Ka(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("SelectCommand"),m=(0,s.up)("GroupOfCommands"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("SwitchComponent"),p=(0,s.up)("SliderRangeCommand"),g=(0,s.up)("UpdateFirmwareComponent"),_=(0,s.up)("FileDropArea");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),ka,(0,s.Wm)(c,{"regex-name":"TouchMe",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),"check-versions-flag":""}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,s.Wm)(m,{"name-of-group":"Scale"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":this.commands_data.Scale,onInputChanged:this.sys_ex_changed},null,8,["list-of-variants","command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[Ra])),_:1}),(0,s.Wm)(m,{"name-of-group":"Key"},(0,s.Nv)({description:(0,s.w5)((()=>[Ma])),_:2},[this.commands_data.customRange.value?void 0:{name:"objects",fn:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{"command-label":"",key:this.forceRerender,"command-object":this.commands_data.Key,"table-values":this.dig_to_nums,onInputChanged:this.sys_ex_changed},null,8,["command-object","table-values","onInputChanged"]))])),key:"0"}]),1024),(0,s.Wm)(m,{"name-of-group":"Velocity"},{objects:(0,s.w5)((()=>[(0,s._)("div",Va,[(0,s._)("div",Oa,[(0,s.Wm)(u,{id:"humanizeSwitch","command-label":"Humanize","command-object":this.commands_data.humanize,"onUpdate:modelValue":t[1]||(t[1]=e=>{this.isHumanize=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])]),(0,s._)("div",Ea,[(0,s.Wm)(u,{id:"velocityDisableSwitch","command-label":"Mute","command-object":this.commands_data.mute,"onUpdate:modelValue":t[2]||(t[2]=e=>{this.isMute=e}),onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),this.commands_data.mute.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Na,[this.commands_data.humanize.value?((0,s.wg)(),(0,s.iD)("div",Ba,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"max-command-object":this.commands_data.maxVelocity,"min-command-object":this.commands_data.minVelocity,onInputChanged:this.sys_ex_changed},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",La,[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-object":this.commands_data.maxVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))]))]))])),description:(0,s.w5)((()=>[Ta,Aa,Wa])),_:1}),(0,s.Wm)(m,{"name-of-group":"Notes Range"},{objects:(0,s.w5)((()=>[(0,s._)("div",Ua,[(0,s._)("div",Fa,[(0,s.Wm)(u,{id:"notesRangeSwitch","command-label":"Custom Range","command-object":this.commands_data.customRange,"onUpdate:modelValue":t[3]||(t[3]=e=>{this.customRange=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),this.commands_data.customRange.value?((0,s.wg)(),(0,s.iD)("div",Ha,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"max-command-object":this.commands_data.highestNote,"min-command-object":this.commands_data.lowestNote,onInputChanged:this.sys_ex_changed},null,8,["max-command-object","min-command-object","onInputChanged"]))])):(0,s.kq)("",!0)])),description:(0,s.w5)((()=>[za])),_:1}),(0,s.Wm)(m,{"name-of-group":"Channel"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{"command-label":"",key:this.forceRerender,"command-object":this.commands_data.channel,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),_:1}),(0,s._)("div",qa,[(0,s._)("button",{onMouseup:t[4]||(t[4]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1 w-75"},"Send",40,Za),(0,s._)("button",{onClick:t[5]||(t[5]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary mb-1 w-75"},"Create Preset"),(0,s.Wm)(g,{repo:"Playtronica/touchme-releases",device:this.device,class:"mb-1 w-75"},null,8,["device"]),(0,s.Wm)(_,{class:"mb-1 w-75",name:"Drop Preset Here",onGet_drop:t[6]||(t[6]=e=>i.loadDataFromPreset(e))})]),(0,s.Wm)(m,null,{description:(0,s.w5)((()=>[Ga,$a,Ya])),_:1})],64)}let Ja=new Map(Object.entries({Scale:new pe({name:"Scale",number_command:0,max_value:11}),Key:new pe({name:"Key",number_command:1,min_value:1,max_value:12}),maxVelocity:new pe({name:"maxVelocity",number_command:2,max_value:127}),minVelocity:new pe({name:"minVelocity",number_command:3,max_value:127}),highestNote:new pe({name:"highestNote",number_command:8,max_value:127}),lowestNote:new pe({name:"lowestNote",number_command:7,max_value:127}),customRange:new pe({name:"customRange",number_command:6}),humanize:new pe({name:"humanize",number_command:4}),mute:new pe({name:"mute",number_command:5,default_value:0,value:0}),channel:new pe({name:"channel",number_command:127,max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}})}));const Qa={Scale:0,Key:8,maxVelocity:70,minVelocity:50,highestNote:84,lowestNote:48,customRange:0,humanize:0,mute:0,channel:1};class Xa extends fe{constructor(){super(Ja),(0,ue.Z)(this,"DB_NAME","TouchMeDB"),(0,ue.Z)(this,"STORE_NAME","TouchMe_Patches"),(0,ue.Z)(this,"VERSION",3),this.openDB().then((e=>{e&&this.createNoEditablePatch(Qa,"Default")}))}}const en=(0,s._)("h1",{class:"text-center"},"TouchMe change settings",-1),tn=(0,s._)("p",null,"Scale - scale played from the device",-1),an=(0,s._)("p",null,"Key - Start Note in default range (Disabled when custom range is active)",-1),nn={class:"row"},on={class:"col"},sn=(0,s._)("label",{for:"humanizeSwitch"},"Humanize",-1),dn={class:"col"},cn=(0,s._)("label",{for:"velocityDisableSwitch"},"Mute",-1),ln={key:0},rn={key:0},mn={key:1},hn=(0,s._)("p",null,"Velocity - pressing force",-1),un=(0,s._)("p",null,"Humanize - Velocity randomization at a controlled interval",-1),pn=(0,s._)("p",null,"Mute - disable note generation from the channel",-1),gn={class:"row"},_n={class:"col"},bn=(0,s._)("label",{for:"notesRangeSwitch"},"Custom Range",-1),vn={key:0},fn=(0,s._)("p",null,"Notes Range - Range of playable notes",-1),yn=["disabled"],wn=(0,s._)("p",null,"Send - sending settings to the device",-1),Cn=(0,s._)("p",null,"Create Preset - saves settings to a file",-1),jn=(0,s._)("p",null,"Drop Preset Here - you need to transfer the file there by drag drop, or by clicking on the button, select the settings file.",-1);function Dn(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("SelectCommand"),m=(0,s.up)("GroupOfCommands"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("SwitchComponent"),p=(0,s.up)("SliderRangeCommand"),g=(0,s.up)("UpdateFirmwareComponent"),_=(0,s.up)("FileDropArea");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),en,(0,s.Wm)(c,{"regex-name":"TouchMe",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,s.Wm)(m,{"name-of-group":"Scale"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":this.commands_data.Scale,onInputChanged:this.sys_ex_changed},null,8,["list-of-variants","command-object","onInputChanged"]))])),description:(0,s.w5)((()=>[tn])),_:1}),(0,s.Wm)(m,{"name-of-group":"Key"},(0,s.Nv)({description:(0,s.w5)((()=>[an])),_:2},[this.commands_data.customRange.value?void 0:{name:"objects",fn:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{"command-label":"",key:this.forceRerender,"command-object":this.commands_data.Key,"table-values":this.dig_to_nums,onInputChanged:this.sys_ex_changed},null,8,["command-object","table-values","onInputChanged"]))])),key:"0"}]),1024),(0,s.Wm)(m,{"name-of-group":"Velocity"},{objects:(0,s.w5)((()=>[(0,s._)("div",nn,[(0,s._)("div",on,[sn,(0,s.Wm)(u,{id:"humanizeSwitch","command-object":this.commands_data.humanize,"onUpdate:modelValue":t[1]||(t[1]=e=>{this.isHumanize=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])]),(0,s._)("div",dn,[cn,(0,s.Wm)(u,{id:"velocityDisableSwitch","command-object":this.commands_data.mute,"onUpdate:modelValue":t[2]||(t[2]=e=>{this.isMute=e}),onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),this.commands_data.mute.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",ln,[this.commands_data.humanize.value?((0,s.wg)(),(0,s.iD)("div",mn,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"max-command-object":this.commands_data.maxVelocity,"min-command-object":this.commands_data.minVelocity,onInputChanged:this.sys_ex_changed},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",rn,[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-object":this.commands_data.maxVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))]))]))])),description:(0,s.w5)((()=>[hn,un,pn])),_:1}),(0,s.Wm)(m,{"name-of-group":"Notes Range"},{objects:(0,s.w5)((()=>[(0,s._)("div",gn,[(0,s._)("div",_n,[bn,(0,s.Wm)(u,{id:"notesRangeSwitch","command-object":this.commands_data.customRange,"onUpdate:modelValue":t[3]||(t[3]=e=>{this.customRange=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),this.commands_data.customRange.value?((0,s.wg)(),(0,s.iD)("div",vn,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"max-command-object":this.commands_data.highestNote,"min-command-object":this.commands_data.lowestNote,onInputChanged:this.sys_ex_changed},null,8,["max-command-object","min-command-object","onInputChanged"]))])):(0,s.kq)("",!0)])),description:(0,s.w5)((()=>[fn])),_:1}),(0,s._)("button",{onMouseup:t[4]||(t[4]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1",style:{width:"70%"}},"Send",40,yn),(0,s._)("button",{onClick:t[5]||(t[5]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary mb-1",style:{width:"70%"}},"Create Preset"),(0,s.Wm)(g,{repo:"Playtronica/touchme-releases",device:this.device},null,8,["device"]),(0,s.Wm)(_,{name:"Drop Preset Here",onGet_drop:t[6]||(t[6]=e=>i.loadDataFromPreset(e))}),(0,s.Wm)(m,null,{description:(0,s.w5)((()=>[wn,Cn,jn])),_:1})],64)}var In={components:{LoaderComponent:Da,UpdateFirmwareComponent:ua,PatchSelector:Yt,SliderRangeCommand:vt,SwitchComponent:Ke,FileDropArea:ke,SliderCommand:it,DeviceSelector:aa,GroupOfCommands:Ue,SelectCommand:Dt},props:{id:{type:String,required:!0}},methods:{change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),2e3),setTimeout(function(){this.device.send([240,11,20,13,0,247]),this.sendDataTest(),_e(100),this.sendData(),this.device.send([240,11,20,13,1,247])}.bind(this),10))},async sendData(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device),_e(100);await this.saveData()},async sendDataTest(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device,[11]),_e(100);this.saveData()},async saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"touchme-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"touchme-preset.txt")},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),await this.saveData()},async sys_ex_changed(){await this.patchChanged(),this.forceRerender++,this.patchRerender++}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],dig_to_nums:{1:"C3",2:"C#3",3:"D3",4:"D#3",5:"E3",6:"F3",7:"F#3",8:"G3",9:"G#3",10:"A3",11:"A#3",12:"B3"},device:null,forceRerender:0,patchRerender:0,isHumanize:!1,isMute:!1,customRange:!1,db:{type:Xa},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Ja)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Xa,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},async mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const Sn=(0,w.Z)(In,[["render",Dn]]);var xn=Sn,Pn={name:xn,components:{LoaderComponent:Da,UpdateFirmwareComponent:ua,PatchSelector:Yt,SliderRangeCommand:vt,SwitchComponent:Ke,FileDropArea:ke,SliderCommand:it,DeviceSelector:aa,GroupOfCommands:Ue,SelectCommand:Dt},props:{id:{type:String,required:!0}},methods:{change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),2e3),setTimeout(function(){this.device.send([240,11,20,13,0,247]),this.sendData(),this.device.send([240,11,20,13,1,247])}.bind(this),10))},async sendData(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device),_e(100);await this.saveData()},async saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))console.log(t),console.log(this.commands_data),console.log(this.commands_data[t]),this.commands_data[t].set_value(a);this.forceRerender++},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"touchme-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"touchme-preset.txt")},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],dig_to_nums:{1:"C3",2:"C#3",3:"D3",4:"D#3",5:"E3",6:"F3",7:"F#3",8:"G3",9:"G#3",10:"A3",11:"A#3",12:"B3"},device:null,forceRerender:0,patchRerender:0,isHumanize:!1,isMute:!1,customRange:!1,db:{type:Xa},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Ja)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Xa,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},async mounted(){document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const kn=(0,w.Z)(Pn,[["render",Ka],["__scopeId","data-v-5fecffc7"]]);var Rn=kn;const Mn=(0,s._)("h1",{class:"text-center"},"Scala Loader",-1),Vn=(0,s._)("h1",{class:"text-center",style:{color:"red"}}," This page is being developed ",-1),On=(0,s._)("h2",null,[(0,s.Uk)("Create your own scala file or choose from list on "),(0,s._)("a",{href:"https://isartum.net/leimma"},"Leimma")],-1),En={class:"row"},Nn={class:"col-9"},Ln={class:"col-3"};function Bn(e,t,a,o,i,d){const c=(0,s.up)("DeviceSelector"),l=(0,s.up)("FileDropArea");return(0,s.wg)(),(0,s.iD)(s.HY,null,[Mn,Vn,On,(0,s.Wm)(c,{"regex-name":"",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),(0,s._)("div",En,[(0,s._)("div",Nn,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.url=e),type:"text",id:"url_input",class:"form-control",placeholder:"Leimma link"},null,512),[[n.nr,this.url]])]),(0,s._)("div",Ln,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.loadUrl&&this.loadUrl(...e)),class:"btn btn-primary mb-1",style:{width:"70%"}},"Send")])]),(0,s.Wm)(l,{name:"Drop Scala File Here",onGet_drop:t[3]||(t[3]=e=>this.loadFile(e))})],64)}var Tn={components:{FileDropArea:ke,DeviceSelector:aa},props:{},methods:{loadFile(e){let t=e.split("\n");if(!t[0].includes(".scl"))return;let a=t.lastIndexOf("!"),n=parseInt(t[a-1]),o=t.slice(a+1,a+n+1);this.convertCentsString(o,n)},loadUrl(){if(!this.url.includes("/tuningsystem"))return;let e=this.url.substring(this.url.lastIndexOf("/tuningsystem/")+14),t=e.substring(7,8);if("~"!==t&&"s"!==t)return void console.log("Strange Delimiter");let a=e.split(t);if("s"===t)for(let n=0;n<a.length;n++)a[n]=a[n].substring(4);a=a.slice(1),a.push("2r1"),this.convertCentsString(a,a.length,"r")},convertCentsString(e,t,a="/"){for(let n=0;n<t;n++)if(e[n].includes(a)){let t=e[n].split(a);e[n]=parseInt(1200*Math.log2(parseInt(t[0])/parseInt(t[1])))}else e[n]=parseInt(e[n]);this.sendCents(e)},sendCents(e){if(!this.device)return;let t=[240,11,20,13,1,247];this.device.send(t),console.log(t);let a=[];for(const o of e){a=[240,11,20,13,1];for(let e=0;e<Math.floor(o/127);e++)a.push(127);o%127!==0&&a.push(o%127),a.push(247),this.device.send(a),console.log(a),_e(1e3)}let n=[240,11,20,13,127,247];this.device.send(n),console.log(n)}},data(){return{url:"",device:null}}};const An=(0,w.Z)(Tn,[["render",Bn]]);var Wn=An;const Un=(0,s._)("h1",{class:"text-center"},"Biotron Update Page",-1);function Fn(e,t,a,n,o,i){const d=(0,s.up)("DeviceSelector"),c=(0,s.up)("UpdateFirmwareComponent");return(0,s.wg)(),(0,s.iD)(s.HY,null,[Un,(0,s.Wm)(d,{style:{display:"none"},"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),(0,s.Wm)(c,{repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])],64)}var Hn={components:{UpdateFirmwareComponent:ua,DeviceSelector:aa},data(){return{device:null}},methods:{LoadFirmware:ra}};const zn=(0,w.Z)(Hn,[["render",Fn]]);var qn=zn;const Zn=e=>((0,s.dD)("data-v-26623a7c"),e=e(),(0,s.Cn)(),e),Gn=Zn((()=>(0,s._)("h1",{class:"text-center"},"Playtron change settings",-1))),$n={class:"buttons_block"},Yn=["disabled"],Kn=Zn((()=>(0,s._)("p",null,"Send - sending settings to the device",-1))),Jn=Zn((()=>(0,s._)("p",null,"Create Preset - saves settings to a file",-1))),Qn=Zn((()=>(0,s._)("p",null,"Drop Preset Here - you need to transfer the file there by drag drop, or by clicking on the button, select the settings file.",-1)));function Xn(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("SliderCommand"),m=(0,s.up)("GroupOfCommands"),h=(0,s.up)("UpdateFirmwareComponent"),u=(0,s.up)("FileDropArea");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),(0,s._)("div",null,[Gn,(0,s.Wm)(c,{"regex-name":"Playtron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),"check-versions-flag":""}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"]))]),(0,s.Wm)(m,{"name-of-group":"Notes For Pad",class:"row justify-content-center m-1"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)("div",{class:"grid-container center",key:this.forceRerender},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.num_to_pad,((e,t)=>((0,s.wg)(),(0,s.j4)(r,{"command-label":e,key:t,"command-object":this.find_sys_ex("Note",this.num_to_pad[t]),slider_active:!1,onInputChanged:this.sys_ex_changed},null,8,["command-label","command-object","onInputChanged"])))),128))]))])),_:1}),(0,s.Wm)(m,{"name-of-group":"Channel"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(r,{"command-label":"",key:this.forceRerender,"command-object":this.commands_data.channel,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),_:1}),(0,s._)("div",$n,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary mb-1 w-75"},"Send",40,Yn),(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary mb-1 w-75"},"Create Preset"),(0,s.Wm)(h,{repo:"Playtronica/playtron-releases",device:this.device,class:"mb-1 w-75"},null,8,["device"]),(0,s.Wm)(u,{class:"mb-1 w-75",name:"Drop Preset Here",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})]),(0,s.Wm)(m,null,{description:(0,s.w5)((()=>[Kn,Jn,Qn])),_:1})],64)}const eo=[{id:0,name:"C3",note:60},{id:1,name:"C#3",note:61},{id:2,name:"D3",note:62},{id:3,name:"D#3",note:63},{id:4,name:"E3",note:64},{id:5,name:"F3",note:65},{id:6,name:"F#3",note:66},{id:7,name:"G3",note:67},{id:8,name:"G#3",note:68},{id:9,name:"A3",note:69},{id:10,name:"A#3",note:70},{id:11,name:"B3",note:71},{id:12,name:"C4",note:72},{id:13,name:"C#4",note:73},{id:14,name:"D4",note:74},{id:15,name:"D#4",note:75}];let to=new Map([...Object.entries({channel:new pe({name:"channel",number_command:127,max_value:16,min_value:1,custom_fold:(e,t)=>{e.push(t-1)}})}),...new Map(eo.map((e=>[`Note_${e.name}`,new pe({name:`Note_${e.name}`,number_command:[0,e.id]})])))]);const ao={...Object.fromEntries(eo.map((e=>[`Note_${e.name}`,e.note]))),channel:1};class no extends fe{constructor(){super(to),(0,ue.Z)(this,"DB_NAME","PlaytronDB"),(0,ue.Z)(this,"STORE_NAME","Playtron_Patches"),(0,ue.Z)(this,"VERSION",5),this.openDB().then((e=>{e&&this.createNoEditablePatch(ao,"Default")}))}}var oo={components:{UpdateFirmwareComponent:ua,FileDropArea:ke,SliderCommand:it,GroupOfCommands:Ue,LoaderComponent:Da,PatchSelector:Yt,DeviceSelector:aa},computed:{},props:{id:{type:String,required:!0}},data(){return{device:null,patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(to),forceRerender:0,patchRerender:0,num_to_pad:{36:"C3",37:"C#3",38:"D3",39:"D#3",40:"E3",41:"F3",42:"F#3",43:"G3",44:"G#3",45:"A3",46:"A#3",47:"B3",48:"C4",49:"C#4",50:"D4",51:"D#4"},chosen_pad:36}},methods:{find_sys_ex(e,t){return this.commands_data[`${e}_${t}`]},async change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),_e(100);let e=[];for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),_e(100));_e(100),this.device.send([240,11,20,13,126,247])}},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"playtron-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"playtron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new no,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const so=(0,w.Z)(oo,[["render",Xn],["__scopeId","data-v-26623a7c"]]);var io=so;const co=(0,s._)("h1",{class:"text-center"},"Scales change settings",-1),lo={class:"row gx-1 mb-5"},ro={class:"col"},mo=["disabled"],ho={class:"col"},uo={class:"col"},po={class:"col"};function go(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("RgbColorCommand"),p=(0,s.up)("SelectCommand"),g=(0,s.up)("GroupOfCommands"),_=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),co,(0,s.Wm)(c,{"regex-name":"Scales",onDevice_changed:t[0]||(t[0]=e=>{this.device=e})}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,s._)("div",lo,[(0,s._)("div",ro,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"SEND",40,mo)]),(0,s._)("div",ho,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"SAVE")]),(0,s._)("div",uo,[(0,s.Wm)(r,{class:"w-100 h-100",text:"FIRMWARE UPDATE",repo:"Playtronica/scales-firmware",device:this.device,disabled:""},null,8,["device"])]),(0,s._)("div",po,[(0,s.Wm)(m,{name:"UPLOAD",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s._)("div",null,[(0,s.Wm)(_,{name_of_collapse:"Scales settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{"command-label":"BPM",key:this.forceRerender,"command-object":this.commands_data.bpm,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(h,{"command-label":"Sensitivity",key:this.forceRerender,"command-object":this.commands_data.sensitivity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":"Undercover color",key:this.forceRerender,"command-object":this.commands_data.undercover_color,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(p,{"command-label":" Scale",key:this.forceRerender,"list-of-variants":this.scales,"command-object":o.commands_data.scale,onInputChanged:this.sys_ex_changed},null,8,["list-of-variants","command-object","onInputChanged"]))])),_:1})])),_:1})])],64)}const _o=["href","aria-controls"],bo=(0,s._)("hr",null,null,-1),vo=["id"],fo=["id"];function yo(e,t,a,n,o,i){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{class:"toggle-label","data-bs-toggle":"collapse",href:"#"+o.collapseId,role:"button","aria-expanded":"false","aria-controls":this.collapseId,ref:"collapse_header"},[(0,s._)("h1",null,[(0,s.Uk)((0,g.zw)(a.name_of_collapse)+" ",1),(0,s._)("span",null,(0,g.zw)(o.is_open?"-":"+"),1)]),bo],8,_o),a.open_by_default?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"collapse mt-2 show",id:this.collapseId,ref:"collapse_object"},[(0,s.WI)(e.$slots,"objects")],8,fo)):((0,s.wg)(),(0,s.iD)("div",{key:0,class:"collapse mt-2",id:this.collapseId,ref:"collapse_object"},[(0,s.WI)(e.$slots,"objects")],8,vo))],64)}var wo={name:"BootstrapCollapse",props:{name_of_collapse:{type:String,required:!0},open_by_default:{type:Boolean,default:!1}},data(){return{is_open:this.open_by_default,collapseId:"collapse-"+Math.random().toString(36).substring(2,10)}},mounted(){this.$refs.collapse_object.addEventListener("show.bs.collapse",(()=>{this.is_open=!0})),this.$refs.collapse_object.addEventListener("hide.bs.collapse",(()=>{this.is_open=!1}))}};const Co=(0,w.Z)(wo,[["render",yo]]);var jo=Co;function Do(e,t){return(e-e%t)/t}let Io=new Map(Object.entries({bpm:new pe({name:"bpm",number_command:0,max_value:1e3,min_value:1,custom_fold:(e,t)=>{while(t>127)e.push(t%127),t=Do(t,127);e.push(t)}}),sensitivity:new pe({name:"sensitivity",number_command:1,max_value:63500,min_value:1,custom_fold:(e,t)=>{while(t>127)e.push(t%127),t=Do(t,127);e.push(t)}}),undercover_color:new pe({name:"undercover_color",number_command:2,max_value:16777215,min_value:0,custom_fold:(e,t)=>{e.push(parseInt((t>>16&255)/2)),e.push(parseInt((t>>8&255)/2)),e.push(parseInt((255&t)/2))}}),scale:new pe({name:"scale",number_command:4})}));const So={bpm:120,sensitivity:1e4,undercover_color:0,scale:0};class xo extends fe{constructor(){super(Io),(0,ue.Z)(this,"DB_NAME","ScaleDB"),(0,ue.Z)(this,"STORE_NAME","Scale_Patches"),(0,ue.Z)(this,"VERSION",3),this.openDB().then((e=>{e&&this.createNoEditablePatch(So,"Default")}))}}const Po={class:"row m-2"};function ko(e,t,a,o,i,d){const c=(0,s.up)("HintComponent");return(0,s.wg)(),(0,s.iD)("div",Po,[(0,s._)("label",null,[(0,s.Uk)((0,g.zw)(this.commandLabel)+" ",1),this.description?((0,s.wg)(),(0,s.j4)(c,{key:0,text:this.description},null,8,["text"])):(0,s.kq)("",!0)]),(0,s.wy)((0,s._)("input",{type:"color","onUpdate:modelValue":t[0]||(t[0]=e=>this.rawValue=e),onChange:t[1]||(t[1]=(...e)=>d.changed&&d.changed(...e))},null,544),[[n.nr,this.rawValue]])])}var Ro={name:"RgbColorCommand",components:{HintComponent:Te},props:{commandLabel:{default:"",type:String},commandObject:{required:!0,type:pe},description:{type:String,required:!1}},emits:["InputChanged"],data(){return{rawValue:"#000000"}},methods:{changed(e){this.commandObject.set_value(parseInt(e.target.value.replace("#",""),16)),this.$emit("InputChanged",this.commandObject)}},created(){this.rawValue="#"+this.commandObject.value.toString(16).padStart(6,"0")}};const Mo=(0,w.Z)(Ro,[["render",ko]]);var Vo=Mo,Oo={components:{SelectCommand:Dt,RgbColorCommand:Vo,SliderCommand:it,BootstrapCollapse:jo,LoaderComponent:Da,UpdateFirmwareComponent:ua,DeviceSelector:aa,PatchSelector:Yt,GroupOfCommands:Ue,FileDropArea:ke},props:{id:{type:String,required:!0},test:{type:Boolean,default:!1}},computed:{},methods:{async change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData(),_e(100),this.sendDataDeprecated()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),_e(100);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),_e(100));_e(100),this.device.send([240,11,20,13,126,247]),_e(100),this.commands_data.plantBpm.sendToMidi(this.device)}},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"scales-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"scales-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{page_is_inited:!1,device:null,forceRerender:0,patchRerender:0,db:{type:xo},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Io),scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"]}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new xo,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++,this.page_is_inited=!0},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const Eo=(0,w.Z)(Oo,[["render",go]]);var No=Eo;const Lo=(0,s._)("h1",{class:"text-center"},"Biotron change settings",-1),Bo={class:"row gx-1 mb-5"},To={class:"col"},Ao=["disabled"],Wo={class:"col"},Uo={class:"col"},Fo={class:"col"},Ho={class:"row"},zo={class:"row"},qo={class:"col"},Zo={key:0},Go={key:0},$o={key:1},Yo={class:"row"},Ko={class:"col"},Jo={class:"col"},Qo={class:"row"},Xo={class:"col"},es={class:"col"},ts={class:"col"},as={key:0,class:"row"},ns={key:0},os={key:1};function ss(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SwitchComponent"),u=(0,s.up)("SliderCommand"),p=(0,s.up)("SelectCommand"),g=(0,s.up)("GroupOfCommands"),_=(0,s.up)("BootstrapCollapse"),b=(0,s.up)("SliderRangeCommand");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),Lo,(0,s.Wm)(c,{"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),"check-versions-flag":""}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id},null,8,["patches","page_id"])),(0,s._)("div",Bo,[(0,s._)("div",To,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"SEND",40,Ao)]),(0,s._)("div",Wo,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"SAVE")]),(0,s._)("div",Uo,[(0,s.Wm)(r,{class:"w-100 h-100",text:"FIRMWARE UPDATE",repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])]),(0,s._)("div",Fo,[(0,s.Wm)(m,{name:"UPLOAD",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s._)("div",null,[(0,s.Wm)(_,{name_of_collapse:"PLANT SENSOR",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[(0,s._)("div",Ho,[(0,s.Wm)(h,{id:"plantVelDis","command-label":" MUTE",description:"Turns off notes coming off plant sensor.","command-object":o.commands_data.plant_no_velocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])]),((0,s.wg)(),(0,s.j4)(u,{"command-label":" The Beat",key:this.forceRerender,"command-object":this.commands_data.plantBpm,description:"Set tempo of plant notes, plants BPM.",onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":" Note Hold",key:this.forceRerender,"command-object":this.commands_data.noteOffPercent,"table-values":this.fractions_note_off,description:"How long a note plays before stopping (100 = full length, 50 = half, 0 = very short).",onInputChanged:this.sys_ex_changed,"table-values-reversed":""},null,8,["command-object","table-values","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":" Home Note",key:this.forceRerender,"command-object":this.commands_data.middle_plant_note,"table-values":this.root_note_id,description:"The main note everything starts from and returns to.",onInputChanged:this.sys_ex_changed},null,8,["command-object","table-values","onInputChanged"])),((0,s.wg)(),(0,s.j4)(p,{"command-label":" Scale",key:this.forceRerender,"list-of-variants":this.scales,"command-object":o.commands_data.scale,onInputChanged:this.sys_ex_changed,description:"A set of notes that shape the melody and feel of the music. Choose a scale to define the sound of your composition."},null,8,["list-of-variants","command-object","onInputChanged"]))])),_:1})])),_:1})]),(0,s._)("div",null,[(0,s.Wm)(_,{name_of_collapse:"MORE FUN"},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,{"name-of-group":"Plant Midi Channel"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(u,{"command-label":" MIDI channel",description:"Pick a midi channel that the plant would be on",key:this.forceRerender,"command-object":this.commands_data.plant_midi_channel,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),_:1}),(0,s.Wm)(g,{"name-of-group":"NOTE VELOCITY"},{objects:(0,s.w5)((()=>[(0,s._)("div",zo,[(0,s._)("div",qo,[(0,s.Wm)(h,{id:"randomPlantVelSwitch","command-label":"Humanize",description:"Adds natural variations to note velocity, making the music sound less robotic and more like a real person playing an instrument.","command-object":this.commands_data.randomPlantVelocity,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])])]),o.commands_data.plant_no_velocity.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Zo,[this.commands_data.randomPlantVelocity.value?((0,s.wg)(),(0,s.iD)("div",$o,[((0,s.wg)(),(0,s.j4)(b,{key:this.forceRerender,"max-command-object":o.commands_data.maxPlantVelocity,"min-command-object":o.commands_data.minPlantVelocity,onInputChanged:this.sys_ex_changed,"command-label":" Note velocity",description:"Intensity range of of notes (volume, expression)"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",Go,[((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.maxPlantVelocity,onInputChanged:this.sys_ex_changed,"command-label":" Note velocity",description:"Intensity range of of notes (volume, expression)."},null,8,["command-object","onInputChanged"]))]))]))])),_:1}),(0,s.Wm)(g,{"name-of-group":"SENSITIVITY"},{objects:(0,s.w5)((()=>[(0,s._)("div",Yo,[(0,s._)("div",Ko,[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-label":" Ultra sensitivity","command-object":o.commands_data.randomness,onInputChanged:this.sys_ex_changed,description:"Makes the plant more responsive."},null,8,["command-object","onInputChanged"]))]),(0,s._)("div",Jo,[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-label":" Manual control","command-object":o.commands_data.performance,onInputChanged:this.sys_ex_changed,description:"Plant only reacts to human interaction, doesnt play by itself."},null,8,["command-object","onInputChanged"]))])]),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.same_note_plant,"command-label":" Note Repeat",onInputChanged:this.sys_ex_changed,description:"Move near the plant to change notes (1 = small moves change notes, 10 = big moves needed). "},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":" Wake-Up",key:this.forceRerender,"command-object":this.commands_data.firstValue,onInputChanged:this.sys_ex_changed,description:"A little change that wakes up the first note."},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":" Step Size",key:this.forceRerender,"command-object":this.commands_data.noteDistance,onInputChanged:this.sys_ex_changed,description:"How big a change is needed to go to the next note."},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":" Delay",key:this.forceRerender,"command-object":this.commands_data.smoothness,onInputChanged:this.sys_ex_changed,description:"How quickly device reacts to change"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})]),(0,s._)("div",null,[(0,s.Wm)(_,{name_of_collapse:"LIGHT SENSOR"},{objects:(0,s.w5)((()=>[(0,s.Wm)(g,null,{objects:(0,s.w5)((()=>[(0,s._)("div",Qo,[(0,s._)("div",Xo,[(0,s.Wm)(h,{id:"lightVelDis","command-label":"Mute","command-object":o.commands_data.light_no_velocity,onInputChanged:this.sys_ex_changed,description:"Turns off notes coming off light sensor"},null,8,["command-object","onInputChanged"])]),(0,s._)("div",es,[(0,s.Wm)(h,{id:"randomLightVelSwitch","command-label":"Humanize","command-object":this.commands_data.randomLightVelocity,onInputChanged:this.sys_ex_changed,description:"Adds natural variations to note velocity, making the music sound less robotic and more like a real person playing an instrument."},null,8,["command-object","onInputChanged"])]),(0,s._)("div",ts,[(0,s.Wm)(h,{id:"light_pitch_mode","command-label":" Pitch Bend","command-object":this.commands_data.light_pitch_mode,onInputChanged:this.sys_ex_changed,description:"Same as pitch bend wheel on your keyboard  makes sound wobbly"},null,8,["command-object","onInputChanged"])])]),((0,s.wg)(),(0,s.j4)(u,{"command-label":" MIDI channel",description:"Pick a midi channel that the light would be on",key:this.forceRerender,"command-object":this.commands_data.light_midi_channel,onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{"command-label":" The Beat",key:this.forceRerender,"command-object":this.commands_data.lightBpm,onInputChanged:this.sys_ex_changed,description:"Set tempo of light sensor notes BPM"},null,8,["command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.same_note_light,"command-label":"Note Repeat",onInputChanged:this.sys_ex_changed,description:"Change the light to change notes (1 = small moves change notes, 10 = big moves needed). "},null,8,["command-object","onInputChanged"])),o.commands_data.light_no_velocity.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",as,[this.commands_data.randomLightVelocity.value?((0,s.wg)(),(0,s.iD)("div",os,[((0,s.wg)(),(0,s.j4)(b,{key:this.forceRerender,"max-command-object":o.commands_data.maxLightVelocity,"min-command-object":o.commands_data.minLightVelocity,onInputChanged:this.sys_ex_changed,"command-label":" Note velocity",description:"Intensity range of of notes (volume, expression)"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",ns,[((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":o.commands_data.maxLightVelocity,onInputChanged:this.sys_ex_changed,name:o.commands_data.maxLightVelocity.value,"command-label":" Note velocity",description:"Intensity range of of notes (volume, expression)"},null,8,["command-object","onInputChanged","name"]))]))])),this.commands_data.light_pitch_mode.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"command-object":this.commands_data.range_light_note,onInputChanged:this.sys_ex_changed,"command-label":" Range",description:"How many notes are played relative to root note"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})])],64)}var is={components:{BootstrapCollapse:jo,LoaderComponent:Da,UpdateFirmwareComponent:ua,DeviceSelector:aa,PatchSelector:Yt,SelectCommand:Dt,SliderRangeCommand:vt,SliderCommand:it,SwitchComponent:Ke,GroupOfCommands:Ue,FileDropArea:ke},props:{id:{type:String,required:!0},test:{type:Boolean,default:!1}},computed:{},methods:{async change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData(),_e(100),this.sendDataDeprecated()}.bind(this),10))},async sendDataDeprecated(){if(this.device){this.device.send([240,11,16,127,247]);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device,[11]),_e(100));this.device.send([240,11,126,247]),_e(100),this.commands_data.plantBpm.sendToMidi(this.device,[11])}},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),_e(100);let e=[];e.push("plantBpm");for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),_e(100));_e(100),this.device.send([240,11,20,13,126,247]),_e(100),this.commands_data.plantBpm.sendToMidi(this.device)}},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"biotron-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"biotron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{page_is_inited:!1,scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],root_note_id:{60:"C4",61:"C#4",62:"D4",63:"D#4",64:"E4",65:"F4",66:"F#4",67:"G4",68:"G#4",69:"A4",70:"A#4",71:"B4",72:"C5"},fractions_note_off:{64:"1/64",48:"1/48",32:"1/32",24:"1/24",16:"1/16",12:"1/12",8:"1/8",6:"1/6",4:"1/4",2:"1/2",1:"1"},device:null,forceRerender:0,patchRerender:0,db:{type:Ie},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(ye)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Ie,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++,this.page_is_inited=!0},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const ds=(0,w.Z)(is,[["render",ss]]);var cs=ds;const ls=e=>((0,s.dD)("data-v-36ff5b45"),e=e(),(0,s.Cn)(),e),rs=ls((()=>(0,s._)("h1",{class:"text-center"},"TouchMe change settings",-1))),ms={class:"row gx-1 mb-5"},hs={class:"col"},us=["disabled"],ps={class:"col"},gs={class:"col"},_s={class:"col"},bs={class:"row"},vs={class:"col"},fs={class:"col"},ys={class:"col"},ws={key:0},Cs={key:0},js={key:1},Ds={key:1};function Is(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SwitchComponent"),u=(0,s.up)("SelectCommand"),p=(0,s.up)("SliderCommand"),g=(0,s.up)("SliderRangeCommand"),_=(0,s.up)("GroupOfCommands"),b=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),rs,(0,s.Wm)(c,{"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:" Select Device","check-versions-flag":""}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:" Preset"},null,8,["patches","page_id"])),(0,s._)("div",ms,[(0,s._)("div",hs,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"},"SEND",40,us)]),(0,s._)("div",ps,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"},"SAVE")]),(0,s._)("div",gs,[(0,s.Wm)(r,{class:"w-100 h-100",text:"FIRMWARE UPDATE",repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])]),(0,s._)("div",_s,[(0,s.Wm)(m,{name:"UPLOAD",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(b,{name_of_collapse:"TouchMe settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(_,null,{objects:(0,s.w5)((()=>[(0,s._)("div",bs,[(0,s._)("div",vs,[(0,s.Wm)(h,{id:"humanizeSwitch","command-label":" Humanize","command-object":this.commands_data.humanize,"onUpdate:modelValue":t[4]||(t[4]=e=>{this.isHumanize=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed,description:"Humanize adds a natural feel to your music by slightly varying the timing and volume\n                   of each notejust like a live performer would. Instead of every note sounding perfectly the same\n                    and perfectly on the beat, small random shifts make your performance feel more expressive and organic."},null,8,["command-object","onInputChanged"])]),(0,s._)("div",fs,[(0,s.Wm)(h,{id:"velocityDisableSwitch","command-label":" Mute","command-object":this.commands_data.mute,"onUpdate:modelValue":t[5]||(t[5]=e=>{this.isMute=e}),onInputChanged:this.sys_ex_changed,description:"Disable note generation from the channel"},null,8,["command-object","onInputChanged"])]),(0,s._)("div",ys,[(0,s.Wm)(h,{id:"notesRangeSwitch","command-label":"Custom Range","command-object":this.commands_data.customRange,"onUpdate:modelValue":t[6]||(t[6]=e=>{this.customRange=e,o.forceRerender++}),onInputChanged:this.sys_ex_changed,description:"Toggle Custom Range (?) to set your own low and high notesperfect for\n                  focusing on just the notes you love. Limits the playable notes between your chosen\n                  minimum and maximum, so every touch stays within your musical zone!"},null,8,["command-object","onInputChanged"])])]),((0,s.wg)(),(0,s.j4)(u,{key:this.forceRerender,"list-of-variants":this.scales,"command-object":this.commands_data.Scale,onInputChanged:this.sys_ex_changed,"command-label":" Scale Selection",description:"Choose the musical mood you want.\n               Whether its a happy major scale or a mysterious minor scale, this lets you pick the pattern of notes TouchMe will play."},null,8,["list-of-variants","command-object","onInputChanged"])),((0,s.wg)(),(0,s.j4)(p,{"command-label":" Root Note",key:this.forceRerender,"command-object":this.commands_data.Key,"table-values":this.dig_to_nums,onInputChanged:this.sys_ex_changed,description:"This is your starting notelike picking the key on a piano. All other notes follow from here based on the scale you chose."},null,8,["command-object","table-values","onInputChanged"])),this.commands_data.mute.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",ws,[this.commands_data.humanize.value?((0,s.wg)(),(0,s.iD)("div",js,[((0,s.wg)(),(0,s.j4)(g,{key:this.forceRerender,"max-command-object":this.commands_data.maxVelocity,"min-command-object":this.commands_data.minVelocity,onInputChanged:this.sys_ex_changed,"command-label":" Volume (MIDI Velocity)",description:"Controls how loud or soft each note sounds based on MIDI velocity.\n                                   Think of velocity like how hard you hit a piano key: a gentle tap creates a quiet tone,\n                                    while a strong press produces a louder, more vibrant sound. Adjust this to match your playing style!"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):((0,s.wg)(),(0,s.iD)("div",Cs,[((0,s.wg)(),(0,s.j4)(p,{key:this.forceRerender,"command-object":this.commands_data.maxVelocity,onInputChanged:this.sys_ex_changed,"command-label":" Volume (MIDI Velocity)",description:"Controls how loud or soft each note sounds based on MIDI velocity.\n                                   Think of velocity like how hard you hit a piano key: a gentle tap creates a quiet tone,\n                                    while a strong press produces a louder, more vibrant sound. Adjust this to match your playing style!"},null,8,["command-object","onInputChanged"]))]))])),this.commands_data.customRange.value?((0,s.wg)(),(0,s.iD)("div",Ds,[((0,s.wg)(),(0,s.j4)(g,{key:this.forceRerender,"max-command-object":this.commands_data.highestNote,"min-command-object":this.commands_data.lowestNote,onInputChanged:this.sys_ex_changed,"command-label":" Notes Range",description:"Toggle Custom Range (?) to set your own low and high notesperfect for\n                                 focusing on just the notes you love. Limits the playable notes between your chosen\n                                  minimum and maximum, so every touch stays within your musical zone!"},null,8,["max-command-object","min-command-object","onInputChanged"]))])):(0,s.kq)("",!0),((0,s.wg)(),(0,s.j4)(p,{"command-label":" MIDI Channel Selection",key:this.forceRerender,"command-object":this.commands_data.channel,onInputChanged:this.sys_ex_changed,description:"Choose a MIDI Channel (116) to decide which virtual instrument or track TouchMe sends its notes to.\n               Routes your performance to the right placepick channel 1 for your piano plugin, channel 10 for drums,\n               or any other channel for special effects!"},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})],64)}var Ss={name:"TouchMePageUpdated",components:{BootstrapCollapse:jo,LoaderComponent:Da,UpdateFirmwareComponent:ua,PatchSelector:Yt,SliderRangeCommand:vt,SwitchComponent:Ke,FileDropArea:ke,SliderCommand:it,DeviceSelector:aa,GroupOfCommands:Ue,SelectCommand:Dt},props:{id:{type:String,required:!0}},methods:{change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),2e3),setTimeout(function(){this.device.send([240,11,20,13,0,247]),this.sendData(),this.device.send([240,11,20,13,1,247])}.bind(this),10))},async sendData(){for(let e in this.commands_data)this.commands_data[e].sendToMidi(this.device),_e(100);await this.saveData()},async saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))console.log(t),console.log(this.commands_data),console.log(this.commands_data[t]),this.commands_data[t].set_value(a);this.forceRerender++},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"touchme-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"touchme-preset.txt")},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},data(){return{scales:["Major","Minor","Chrom","Dorian","Mixolydian","Lydian","Wholetone","Minblues","Majblues","Minpen","Majpen","Diminished"],dig_to_nums:{1:"C3",2:"C#3",3:"D3",4:"D#3",5:"E3",6:"F3",7:"F#3",8:"G3",9:"G#3",10:"A3",11:"A#3",12:"B3"},device:null,forceRerender:0,patchRerender:0,isHumanize:!1,isMute:!1,customRange:!1,db:{type:Xa},patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(Ja)}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new Xa,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},async mounted(){document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const xs=(0,w.Z)(Ss,[["render",Is],["__scopeId","data-v-36ff5b45"]]);var Ps=xs;const ks=e=>((0,s.dD)("data-v-1ba5537d"),e=e(),(0,s.Cn)(),e),Rs=ks((()=>(0,s._)("h1",{class:"text-center"},"Playtron change settings",-1))),Ms={class:"row gx-1 mb-5"},Vs={class:"col"},Os=["disabled"],Es={class:"col"},Ns={class:"col"},Ls={class:"col"};function Bs(e,t,a,n,o,i){const d=(0,s.up)("LoaderComponent"),c=(0,s.up)("DeviceSelector"),l=(0,s.up)("PatchSelector"),r=(0,s.up)("UpdateFirmwareComponent"),m=(0,s.up)("FileDropArea"),h=(0,s.up)("SliderCommand"),u=(0,s.up)("GroupOfCommands"),p=(0,s.up)("BootstrapCollapse");return(0,s.wg)(),(0,s.iD)(s.HY,null,[this.is_loading?((0,s.wg)(),(0,s.j4)(d,{key:o.forceRerender})):(0,s.kq)("",!0),Rs,(0,s.Wm)(c,{"regex-name":"Biotron",onDevice_changed:t[0]||(t[0]=e=>{this.device=e}),text_label:" Select Device","check-versions-flag":""}),((0,s.wg)(),(0,s.j4)(l,{patches:this.patches,key:this.forceRerender+this.patchRerender,page_id:this.id,text_label:" Preset"},null,8,["patches","page_id"])),(0,s._)("div",Ms,[(0,s._)("div",Vs,[(0,s._)("button",{onMouseup:t[1]||(t[1]=(...e)=>i.change_data_loader&&i.change_data_loader(...e)),disabled:!this.device,class:"btn btn-primary w-100 h-100"}," Send Settings",40,Os)]),(0,s._)("div",Es,[(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>this.createPreset&&this.createPreset(...e)),class:"btn btn-primary w-100 h-100"}," Save Preset")]),(0,s._)("div",Ns,[(0,s.Wm)(r,{class:"w-100 h-100",text:" Update Firmware",repo:"Playtronica/biotron-firmware",device:this.device},null,8,["device"])]),(0,s._)("div",Ls,[(0,s.Wm)(m,{name:" Load Preset",onGet_drop:t[3]||(t[3]=e=>i.loadDataFromPreset(e))})])]),(0,s.Wm)(p,{name_of_collapse:" Playtron Settings",open_by_default:""},{objects:(0,s.w5)((()=>[(0,s.Wm)(u,{"name-of-group":" Notes for Pad",class:"row justify-content-center m-1",description:"Click any box in the grid to assign a new MIDI note to that pad. Mix and match high and low notes to build your perfect layout!"},{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)("div",{class:"grid-container center",key:this.forceRerender},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.num_to_pad,((e,t)=>((0,s.wg)(),(0,s.j4)(h,{"command-label":e,key:t,"command-object":this.find_sys_ex("Note",this.num_to_pad[t]),slider_active:!1,onInputChanged:this.sys_ex_changed},null,8,["command-label","command-object","onInputChanged"])))),128))]))])),_:1}),(0,s.Wm)(u,null,{objects:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(h,{key:this.forceRerender,"command-object":this.commands_data.channel,"command-label":" MIDI Channel",description:"Slide to choose channels <br>116.<br>\n                What it does: Routes your pads to the correct instrument trackchannel 1 for piano, 10 for drums, and so on!",onInputChanged:this.sys_ex_changed},null,8,["command-object","onInputChanged"]))])),_:1})])),_:1})],64)}var Ts={components:{BootstrapCollapse:jo,UpdateFirmwareComponent:ua,FileDropArea:ke,SliderCommand:it,GroupOfCommands:Ue,LoaderComponent:Da,PatchSelector:Yt,DeviceSelector:aa},computed:{},props:{id:{type:String,required:!0}},data(){return{device:null,patches:[],patch_id:0,is_loading:!1,commands_data:Object.fromEntries(to),forceRerender:0,patchRerender:0,num_to_pad:{36:"C3",37:"C#3",38:"D3",39:"D#3",40:"E3",41:"F3",42:"F#3",43:"G3",44:"G#3",45:"A3",46:"A#3",47:"B3",48:"C4",49:"C#4",50:"D4",51:"D#4"},chosen_pad:36}},methods:{find_sys_ex(e,t){return this.commands_data[`${e}_${t}`]},async change_data_loader(){this.device&&(_e(100),this.is_loading=!0,this.forceRerender++,setTimeout(function(){this.is_loading=!1,this.forceRerender++}.bind(this),3e3),setTimeout(function(){this.sendData()}.bind(this),10))},async sendData(){if(this.device){this.device.send([240,11,20,13,126,247]),_e(100);let e=[];for(let t in this.commands_data)e.includes(t)||(this.commands_data[t].sendToMidi(this.device),_e(100));_e(100),this.device.send([240,11,20,13,126,247])}},async loadData(){let e=await this.db.getPatch(localStorage.getItem(this.id));e||(localStorage.setItem(this.id,1),e=await this.db.getPatch(localStorage.getItem(this.id)));for(const[t,a]of Object.entries(e.data))this.commands_data[t].set_value(a);this.forceRerender++},createPreset(){let e=[];for(let n in this.commands_data)e.push(this.commands_data[n].toShortDict());let t={commands:e},a=new File([JSON.stringify(t)],"playtron-preset.txt",{type:"text/plain;charset=utf-8"});(0,be.p)(a,"playtron-preset.txt")},async loadDataFromPreset(e){await this.patchChanged();for(let t of JSON.parse(e).commands)this.commands_data[t.name].set_value(t.value);this.saveData(),this.forceRerender++},async patchChanged(){let e=parseInt(localStorage.getItem(this.id));this.patches.find((t=>t.id===e)).saved&&(e=await this.db.getUnsavedPatch(),this.patches=await this.db.getPatch(),localStorage.setItem(this.id,e)),this.saveData()},saveData(){let e={};for(let t of Object.values(this.commands_data))e[t.name]=t.value;this.db.updatePatch(localStorage.getItem(this.id),e)},async sys_ex_changed(e){await this.patchChanged(),this.device&&await e.sendToMidi(this.device),this.forceRerender++,this.patchRerender++}},async created(){localStorage.getItem(this.id)||localStorage.setItem(this.id,"1"),this.db=new no,await this.db.openDB(),this.patches=await this.db.getPatch(),this.patch_id=parseInt(localStorage.getItem(this.id)),await this.loadData(),this.forceRerender++},mounted(){document.addEventListener("keyup",(e=>{"Enter"!==e.code||this.is_loading||this.change_data_loader()})),document.addEventListener("InputChanged",(async()=>{await this.patchChanged(),this.patchRerender++})),document.addEventListener("PatchChanged",(async()=>{await this.loadData(),this.forceRerender++})),document.addEventListener("PatchSave",(async e=>{this.db.savePatch(localStorage.getItem(this.id),e.detail),this.patches=await this.db.getPatch(),this.patchRerender++})),document.addEventListener("PatchDelete",(async()=>{this.db.deletePatch(parseInt(localStorage.getItem(this.id))),localStorage.setItem(this.id,"1"),this.patches=await this.db.getPatch(),await this.loadData(),this.forceRerender++}))}};const As=(0,w.Z)(Ts,[["render",Bs],["__scopeId","data-v-1ba5537d"]]);var Ws=As;const Us=[{path:"/"},{path:"/biotron",component:xa,props:{id:"BiotronWebMidiId_2"}},{path:"/biotron_updated",component:cs,props:{id:"BiotronWebMidiId_2"}},{path:"/biotron/update",component:qn},{path:"/touchme",component:Rn,props:{id:"TouchmeWebMidiId_2"}},{path:"/touchme_updated",component:Ps,props:{id:"TouchmeWebMidiId_2"}},{path:"/playtron",component:io,props:{id:"PlaytronWebMidiId"}},{path:"/playtron_updated",component:Ws,props:{id:"PlaytronWebMidiId"}},{path:"/scales",component:No,props:{id:"ScalesWebMidiId_1"}},{path:"/scala",component:Wn}],Fs=(0,o.p7)({history:(0,o.r5)(),linkActiveClass:"active",routes:Us});var Hs=a(7846);(0,n.ri)(S).use(Fs).use(Hs).mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,s){if(!n){var i=1/0;for(r=0;r<e.length;r++){n=e[r][0],o=e[r][1],s=e[r][2];for(var d=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(d=!1,s<i&&(i=s));if(d){e.splice(r--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var r=e.length;r>0&&e[r-1][2]>s;r--)e[r]=e[r-1];e[r]=[n,o,s]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,i=n[0],d=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(o in d)a.o(d,o)&&(a.m[o]=d[o]);if(c)var r=c(a)}for(t&&t(n);l<i.length;l++)s=i[l],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(r)},n=self["webpackChunkweb_midi_playtronica"]=self["webpackChunkweb_midi_playtronica"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(8446)}));n=a.O(n)})();
//# sourceMappingURL=app.5869298b.js.map